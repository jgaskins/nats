{"repository_name":"nats","body":"# NATS\n\nNATS is a message broker for distributed systems.\n\n## Installation\n\n1. Add the dependency to your `shard.yml`:\n\n   ```yaml\n   dependencies:\n     nats:\n       github: jgaskins/nats\n   ```\n\n2. Run `shards install`\n\n## Usage\n\nYou can use NATS in a publish/subscribe or request/reply paradigm.\n\n### Publish/Subscribe\n\nFor publish/subscribe, let's consider the following class to be shared, representing an event that will be published by one service and picked up by another:\n\n```crystal\nrequire \"uuid\"\nrequire \"json\"\nrequire \"uuid/json\"\n\nstruct UserRegisteredEvent\n  include JSON::Serializable\n\n  getter id : UUID\n  getter email : String\n  getter name : String\n\n  def initialize(@id, @email, @name)\n  end\nend\n```\n\nIn one service, we can subscribe to a subject that will be sent all of the events pertaining to a user registering:\n\n```crystal\nrequire \"nats\"\n\nnats = NATS::Client.new(URI.parse(ENV[\"NATS_URL\"]))\n\n# Subscribe to all messages on \"customers.registration\" with an optional queue\n# group. A message will only be delivered to a single client in a given queue\n# group.\nnats.subscribe \"customers.registration\", queue_group: \"cart-service\" do |msg|\n  new_user = UserRegisteredEvent.from_json(msg.body_io)\n\n  # This message represents that a new customer has registered, presumably sent\n  # by our identity/authentication/user service. We create a record for this\n  # customer in our own database so we don't always need to request the info\n  # from that service.\n  UserQuery.new.create_from_message(new_user)\nend\n\n# Accept wildcard messages. This would match:\n# - orders.commercial.fulfilled\n# - orders.individual.fulfilled\nnats.subscribe \"orders.*.shipped\", queue_group: \"cart-service\" do |msg|\n  # ...\nend\n\n# Since the subscribe blocks above do not block execution, we need to keep the\n# main fiber from exiting. In a real-world app, you might trap a TERM/INT signal\n# to allow the app to close the connection gracefully.\nsleep\n```\n\nAnd then to publish on those topics:\n\n```crystal\nrequire \"nats\"\n\nnats = NATS::Client.new(URI.parse(ENV[\"NATS_URL\"]))\n\n# We can publish a message with a given subject. In this example, we'll\n# publish a message saying Jolene has registered.\nnats.publish \"customers.registration\", UserRegisteredEvent.new(\n  id: UUID.random,\n  name: \"Jolene\",\n  email: \"jolene@gonnatakeyourman.com\",\n)\n\nnats.close\n```\n\n### Request/Reply\n\nLet's consider an orders service that we may want to send requests to.\n\n```crystal\nrequire \"uuid\"\nrequire \"json\"\nrequire \"uuid/json\"\nrequire \"db\"\n\nmodule Orders\n  struct Get\n    include JSON::Serializable\n\n    getter id : UUID\n\n    def initialize(@id)\n    end\n  end\nend\n\nstruct Order\n  include DB::Serializable\n  include JSON::Serializable\n\n  getter id : UUID\n  getter address : String\n  getter city : String\n  getter state : String\n  getter postal_code : String\nend\n```\n\n#### Define the request handler\n\n```crystal\nrequire \"nats\"\n\nnats = NATS::Client.new(URI.parse(ENV[\"NATS_URL\"]))\n\n# Subscribe to the subject that the request will be sent to\nnats.subscribe \"orders.get\", do |msg|\n  request = Orders::Get.from_json(msg.body_io)\n\n  order = OrderQuery.new.with_id(request.id)\n\n  nats.reply msg, order.to_json\nend\n```\n\n#### Sending the request\n\n```crystal\nrequire \"nats\"\n\nnats = NATS::Client.new(URI.parse(ENV[\"NATS_URL\"]))\n\n# Send the request to the subject it is expected to be received on:\norder = nats.request \"orders.get\",\n  message: Orders::Get.new(order_id).to_json,\n  timeout: 5.seconds # A timeout must be specified\n\npp order\n```\n\n## Development\n\nTODO: Write development instructions here\n\n## Contributing\n\n1. Fork it (<https://github.com/jgaskins/nats/fork>)\n2. Create your feature branch (`git checkout -b my-new-feature`)\n3. Commit your changes (`git commit -am 'Add some feature'`)\n4. Push to the branch (`git push origin my-new-feature`)\n5. Create a new Pull Request\n\n## Contributors\n\n- [Jamie Gaskins](https://github.com/jgaskins) - creator and maintainer\n","program":{"html_id":"nats/toplevel","path":"toplevel.html","kind":"module","full_name":"Top Level Namespace","name":"Top Level Namespace","abstract":false,"locations":[],"repository_name":"nats","program":true,"enum":false,"alias":false,"const":false,"types":[{"html_id":"nats/NATS","path":"NATS.html","kind":"module","full_name":"NATS","name":"NATS","abstract":false,"locations":[{"filename":"src/error.cr","line_number":1,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/error.cr#L1"},{"filename":"src/jetstream.cr","line_number":6,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream.cr#L6"},{"filename":"src/kv.cr","line_number":7,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L7"},{"filename":"src/message.cr","line_number":1,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/message.cr#L1"},{"filename":"src/nats.cr","line_number":35,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L35"},{"filename":"src/nkeys.cr","line_number":7,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nkeys.cr#L7"},{"filename":"src/nuid.cr","line_number":1,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nuid.cr#L1"},{"filename":"src/objects.cr","line_number":7,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L7"},{"filename":"src/services.cr","line_number":4,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L4"},{"filename":"src/version.cr","line_number":1,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/version.cr#L1"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"constants":[{"id":"LOG","name":"LOG","value":"::Log.for(self)"},{"id":"VERSION","name":"VERSION","value":"\"1.4.1\""}],"doc":"NATS is a pub/sub message bus.\n\n```\nrequire \"nats\"\n\n# Connect to a NATS server running on localhost\nnats = NATS::Client.new\n\n# Connect to a single remote NATS server\nnats = NATS::Client.new(URI.parse(ENV[\"NATS_URL\"]))\n\n# Connect to a NATS cluster, specified by the NATS_URLS environment variable\n# as a comma-separated list of URLs\nservers = ENV[\"NATS_URLS\"]\n  .split(',')\n  .map { |url| URI.parse(url) }\nnats = NATS::Client.new(servers: %w[\n  nats://nats-1\n  nats://nats-2\n  nats://nats-3\n])\n```","summary":"<p>NATS is a pub/sub message bus.</p>","types":[{"html_id":"nats/NATS/Client","path":"NATS/Client.html","kind":"class","full_name":"NATS::Client","name":"Client","abstract":false,"superclass":{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream.cr","line_number":13,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream.cr#L13"},{"filename":"src/kv.cr","line_number":719,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L719"},{"filename":"src/nats.cr","line_number":88,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L88"},{"filename":"src/objects.cr","line_number":370,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L370"},{"filename":"src/services.cr","line_number":373,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L373"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"constants":[{"id":"DEFAULT_PING_INTERVAL","name":"DEFAULT_PING_INTERVAL","value":"2.minutes"},{"id":"DEFAULT_PING_THRESHOLD","name":"DEFAULT_PING_THRESHOLD","value":"2"}],"namespace":{"html_id":"nats/NATS","kind":"module","full_name":"NATS","name":"NATS"},"doc":"Instantiating a `NATS::Client` makes a connection to one of the given NATS\nservers.","summary":"<p>Instantiating a <code><a href=\"../NATS/Client.html\">NATS::Client</a></code> makes a connection to one of the given NATS servers.</p>","constructors":[{"html_id":"new(uri:URI,ping_interval=DEFAULT_PING_INTERVAL,max_pings_out=DEFAULT_PING_THRESHOLD,nkeys_file:String|Nil=nil,user_credentials:String|Nil=nil)-class-method","name":"new","doc":"Connect to a single NATS server at the given URI\n\n```\nnats = NATS::Client.new(URI.parse(\"nats://nats.example.com\"))\n```","summary":"<p>Connect to a single NATS server at the given URI</p>","abstract":false,"args":[{"name":"uri","external_name":"uri","restriction":"URI"},{"name":"ping_interval","default_value":"DEFAULT_PING_INTERVAL","external_name":"ping_interval","restriction":""},{"name":"max_pings_out","default_value":"DEFAULT_PING_THRESHOLD","external_name":"max_pings_out","restriction":""},{"name":"nkeys_file","default_value":"nil","external_name":"nkeys_file","restriction":"String | ::Nil"},{"name":"user_credentials","default_value":"nil","external_name":"user_credentials","restriction":"String | ::Nil"}],"args_string":"(uri : URI, ping_interval = DEFAULT_PING_INTERVAL, max_pings_out = DEFAULT_PING_THRESHOLD, nkeys_file : String | Nil = nil, user_credentials : String | Nil = nil)","args_html":"(uri : URI, ping_interval = <span class=\"t\">DEFAULT_PING_INTERVAL</span>, max_pings_out = <span class=\"t\">DEFAULT_PING_THRESHOLD</span>, nkeys_file : String | Nil = <span class=\"n\">nil</span>, user_credentials : String | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/nats.cr","line_number":161,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L161"},"def":{"name":"new","args":[{"name":"uri","external_name":"uri","restriction":"URI"},{"name":"ping_interval","default_value":"DEFAULT_PING_INTERVAL","external_name":"ping_interval","restriction":""},{"name":"max_pings_out","default_value":"DEFAULT_PING_THRESHOLD","external_name":"max_pings_out","restriction":""},{"name":"nkeys_file","default_value":"nil","external_name":"nkeys_file","restriction":"String | ::Nil"},{"name":"user_credentials","default_value":"nil","external_name":"user_credentials","restriction":"String | ::Nil"}],"visibility":"Public","body":"new([uri], ping_interval: ping_interval, max_pings_out: max_pings_out, nkeys_file: nkeys_file, user_credentials: user_credentials)"},"external_var":false},{"html_id":"new(servers:Array(URI),ping_interval:Time::Span=DEFAULT_PING_INTERVAL,max_pings_out:Int32=DEFAULT_PING_THRESHOLD,nkeys_file:String|Nil=nil,user_credentials:String|Nil=nil)-class-method","name":"new","doc":"Connect to a NATS cluster at the given URIs\n\n```\nnats = NATS::Client.new([\n  URI.parse(\"nats://nats-1.example.com\"),\n  URI.parse(\"nats://nats-2.example.com\"),\n  URI.parse(\"nats://nats-3.example.com\"),\n])\n```","summary":"<p>Connect to a NATS cluster at the given URIs</p>","abstract":false,"args":[{"name":"servers","external_name":"servers","restriction":"Array(URI)"},{"name":"ping_interval","default_value":"DEFAULT_PING_INTERVAL","external_name":"ping_interval","restriction":"Time::Span"},{"name":"max_pings_out","default_value":"DEFAULT_PING_THRESHOLD","external_name":"max_pings_out","restriction":"::Int32"},{"name":"nkeys_file","default_value":"nil","external_name":"nkeys_file","restriction":"String | ::Nil"},{"name":"user_credentials","default_value":"nil","external_name":"user_credentials","restriction":"String | ::Nil"}],"args_string":"(servers : Array(URI), ping_interval : Time::Span = DEFAULT_PING_INTERVAL, max_pings_out : Int32 = DEFAULT_PING_THRESHOLD, nkeys_file : String | Nil = nil, user_credentials : String | Nil = nil)","args_html":"(servers : Array(URI), ping_interval : Time::Span = <span class=\"t\">DEFAULT_PING_INTERVAL</span>, max_pings_out : Int32 = <span class=\"t\">DEFAULT_PING_THRESHOLD</span>, nkeys_file : String | Nil = <span class=\"n\">nil</span>, user_credentials : String | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/nats.cr","line_number":180,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L180"},"def":{"name":"new","args":[{"name":"servers","external_name":"servers","restriction":"Array(URI)"},{"name":"ping_interval","default_value":"DEFAULT_PING_INTERVAL","external_name":"ping_interval","restriction":"Time::Span"},{"name":"max_pings_out","default_value":"DEFAULT_PING_THRESHOLD","external_name":"max_pings_out","restriction":"::Int32"},{"name":"nkeys_file","default_value":"nil","external_name":"nkeys_file","restriction":"String | ::Nil"},{"name":"user_credentials","default_value":"nil","external_name":"user_credentials","restriction":"String | ::Nil"}],"visibility":"Public","body":"_ = allocate\n_.initialize(servers, ping_interval, max_pings_out, nkeys_file, user_credentials)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false},{"html_id":"new(*,ping_interval=DEFAULT_PING_INTERVAL,max_pings_out=DEFAULT_PING_THRESHOLD,nkeys_file:String|Nil=nil,user_credentials:String|Nil=nil)-class-method","name":"new","abstract":false,"args":[{"name":"","external_name":"","restriction":""},{"name":"ping_interval","default_value":"DEFAULT_PING_INTERVAL","external_name":"ping_interval","restriction":""},{"name":"max_pings_out","default_value":"DEFAULT_PING_THRESHOLD","external_name":"max_pings_out","restriction":""},{"name":"nkeys_file","default_value":"nil","external_name":"nkeys_file","restriction":"String | ::Nil"},{"name":"user_credentials","default_value":"nil","external_name":"user_credentials","restriction":"String | ::Nil"}],"args_string":"(*, ping_interval = DEFAULT_PING_INTERVAL, max_pings_out = DEFAULT_PING_THRESHOLD, nkeys_file : String | Nil = nil, user_credentials : String | Nil = nil)","args_html":"(*, ping_interval = <span class=\"t\">DEFAULT_PING_INTERVAL</span>, max_pings_out = <span class=\"t\">DEFAULT_PING_THRESHOLD</span>, nkeys_file : String | Nil = <span class=\"n\">nil</span>, user_credentials : String | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/nats.cr","line_number":137,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L137"},"def":{"name":"new","args":[{"name":"","external_name":"","restriction":""},{"name":"ping_interval","default_value":"DEFAULT_PING_INTERVAL","external_name":"ping_interval","restriction":""},{"name":"max_pings_out","default_value":"DEFAULT_PING_THRESHOLD","external_name":"max_pings_out","restriction":""},{"name":"nkeys_file","default_value":"nil","external_name":"nkeys_file","restriction":"String | ::Nil"},{"name":"user_credentials","default_value":"nil","external_name":"user_credentials","restriction":"String | ::Nil"}],"splat_index":0,"visibility":"Public","body":"new(servers: ((ENV.fetch(\"NATS_SERVERS\", \"nats:///\")).split(',')).map do |url|\n  URI.parse(url)\nend, ping_interval: ping_interval, max_pings_out: max_pings_out, nkeys_file: nkeys_file, user_credentials: user_credentials)"},"external_var":false}],"instance_methods":[{"html_id":"close:Nil-instance-method","name":"close","doc":"Close this NATS connection. This should be done explicitly before exiting\nthe program so that the NATS server can remove any subscriptions that were\nassociated with this client.","summary":"<p>Close this NATS connection.</p>","abstract":false,"location":{"filename":"src/nats.cr","line_number":782,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L782"},"def":{"name":"close","return_type":"Nil","visibility":"Public","body":"begin\n  if @state.closed?\n    return\n  end\n  LOG.trace do\n    \"Flushing/draining before closing...\"\n  end\n  flush\n  drain\nrescue IO::Error\nensure\n  @state = :closed\n  begin\n    @socket.close\n  rescue\n    nil\n  end\n  LOG.trace do\n    \"Connection closed\"\n  end\nend"},"external_var":false},{"html_id":"drain-instance-method","name":"drain","abstract":false,"location":{"filename":"src/nats.cr","line_number":555,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L555"},"def":{"name":"drain","visibility":"Public","body":"flush\n\n\n\nsubscriptions = @subscriptions.values\n\n\n@subscriptions.each do |sid, _|\n  unsubscribe(sid)\nend\nflush\n\n\n\nsubscriptions.each(&.drain)\n"},"external_var":false},{"html_id":"flush(timeout=2.seconds)-instance-method","name":"flush","doc":"Flush the client's output buffer over the wire","summary":"<p>Flush the client's output buffer over the wire</p>","abstract":false,"args":[{"name":"timeout","default_value":"2.seconds","external_name":"timeout","restriction":""}],"args_string":"(timeout = 2.seconds)","args_html":"(timeout = <span class=\"n\">2</span>.seconds)","location":{"filename":"src/nats.cr","line_number":572,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L572"},"def":{"name":"flush","args":[{"name":"timeout","default_value":"2.seconds","external_name":"timeout","restriction":""}],"visibility":"Public","body":"channel = Channel(Nil).new(1)\nping(channel)\nLOG.trace do\n  \"Flushing buffer...\"\nend\nflush!\n\nFiber.yield\n\nselect\nwhen channel.receive\nwhen timeout(timeout)\n  raise(Error.new(\"Flush did not complete within duration: #{timeout}\"))\nend\n"},"external_var":false},{"html_id":"flush!-instance-method","name":"flush!","abstract":false,"location":{"filename":"src/nats.cr","line_number":587,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L587"},"def":{"name":"flush!","visibility":"Public","body":"@out.synchronize do\n  @socket.flush\n  @data_waiting = false\nend"},"external_var":false},{"html_id":"jetstream-instance-method","name":"jetstream","doc":"Returns a `NATS::JetStream::Client` that uses this client's connection to\nthe NATS server.","summary":"<p>Returns a <code><a href=\"../NATS/JetStream/Client.html\">NATS::JetStream::Client</a></code> that uses this client's connection to the NATS server.</p>","abstract":false,"location":{"filename":"src/jetstream.cr","line_number":16,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream.cr#L16"},"def":{"name":"jetstream","visibility":"Public","body":"@jetstream || (@jetstream = JetStream::Client.new(self))"},"external_var":false},{"html_id":"kv-instance-method","name":"kv","doc":"Returns a `NATS::KV::Client` that uses this client's connection to\nthe NATS server.","summary":"<p>Returns a <code><a href=\"../NATS/KV/Client.html\">NATS::KV::Client</a></code> that uses this client's connection to the NATS server.</p>\n<p><span class=\"flag lime\">EXPERIMENTAL</span>  NATS KV support is experimental and subject to change as NATS support for it changes</p>","abstract":false,"location":{"filename":"src/kv.cr","line_number":723,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L723"},"def":{"name":"kv","visibility":"Public","body":"@kv || (@kv = KV::Client.new(self))"},"external_var":false},{"html_id":"nuid:NATS::NUID-instance-method","name":"nuid","abstract":false,"location":{"filename":"src/nats.cr","line_number":130,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L130"},"def":{"name":"nuid","visibility":"Public","body":"@nuid"},"external_var":false},{"html_id":"objects:Objects::Client-instance-method","name":"objects","abstract":false,"location":{"filename":"src/objects.cr","line_number":371,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L371"},"def":{"name":"objects","return_type":"Objects::Client","visibility":"Public","body":"if (__temp_172 = @objects).nil?\n  @objects = (Objects::Client.new(self))\nelse\n  __temp_172\nend"},"external_var":false},{"html_id":"on_disconnect(&on_disconnect)-instance-method","name":"on_disconnect","doc":"Execute the given block whenever this client is disconnected from the NATS\nserver.\n\n```\nnats = NATS::Client.new\nnats.on_disconnect { Datadog.metrics.increment \"nats.disconnect\" }\n```","summary":"<p>Execute the given block whenever this client is disconnected from the NATS server.</p>","abstract":false,"location":{"filename":"src/nats.cr","line_number":817,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L817"},"def":{"name":"on_disconnect","yields":0,"block_arity":0,"block_arg":{"name":"on_disconnect","external_name":"on_disconnect","restriction":""},"visibility":"Public","body":"@on_disconnect = on_disconnect\nself\n"},"external_var":false},{"html_id":"on_error(&on_error:Exception->Nil)-instance-method","name":"on_error","doc":"Execute the given block whenever an exception is raised inside this NATS\nclient.\n\n```\nnats = NATS::Client.new\nnats.on_error { |error| Honeybadger.notify error }\n```","summary":"<p>Execute the given block whenever an exception is raised inside this NATS client.</p>","abstract":false,"location":{"filename":"src/nats.cr","line_number":804,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L804"},"def":{"name":"on_error","yields":1,"block_arity":1,"block_arg":{"name":"on_error","external_name":"on_error","restriction":"(Exception -> Nil)"},"visibility":"Public","body":"@on_error = on_error\nself\n"},"external_var":false},{"html_id":"on_ping(&on_ping)-instance-method","name":"on_ping","doc":"Execute the given block whenever this client pings the server.\n\n```\nnats = NATS::Client.new\nnats.on_ping { Datadog.metrics.increment \"nats.ping\" }\n```","summary":"<p>Execute the given block whenever this client pings the server.</p>","abstract":false,"location":{"filename":"src/nats.cr","line_number":842,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L842"},"def":{"name":"on_ping","yields":0,"block_arity":0,"block_arg":{"name":"on_ping","external_name":"on_ping","restriction":""},"visibility":"Public","body":"@on_ping = on_ping\nself\n"},"external_var":false},{"html_id":"on_pong(&on_pong)-instance-method","name":"on_pong","doc":"Execute the given block whenever this client receives a pong reply from\nthe server.\n\n```\nnats = NATS::Client.new\nnats.on_pong { Datadog.metrics.increment \"nats.pong\" }\n```","summary":"<p>Execute the given block whenever this client receives a pong reply from the server.</p>","abstract":false,"location":{"filename":"src/nats.cr","line_number":855,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L855"},"def":{"name":"on_pong","yields":0,"block_arity":0,"block_arg":{"name":"on_pong","external_name":"on_pong","restriction":""},"visibility":"Public","body":"@on_pong = on_pong\nself\n"},"external_var":false},{"html_id":"on_reconnect(&on_reconnect)-instance-method","name":"on_reconnect","doc":"Execute the given block whenever this client is reconnected to the NATS\nserver.\n\n```\nnats = NATS::Client.new\nnats.on_reconnect { Datadog.metrics.increment \"nats.reconnect\" }\n```","summary":"<p>Execute the given block whenever this client is reconnected to the NATS server.</p>","abstract":false,"location":{"filename":"src/nats.cr","line_number":830,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L830"},"def":{"name":"on_reconnect","yields":0,"block_arity":0,"block_arg":{"name":"on_reconnect","external_name":"on_reconnect","restriction":""},"visibility":"Public","body":"@on_reconnect = on_reconnect\nself\n"},"external_var":false},{"html_id":"ping(channel=Channel(Nil).new(1))-instance-method","name":"ping","abstract":false,"args":[{"name":"channel","default_value":"Channel(Nil).new(1)","external_name":"channel","restriction":""}],"args_string":"(channel = Channel(Nil).new(1))","args_html":"(channel = <span class=\"t\">Channel</span>(<span class=\"t\">Nil</span>).new(<span class=\"n\">1</span>))","location":{"filename":"src/nats.cr","line_number":594,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L594"},"def":{"name":"ping","args":[{"name":"channel","default_value":"Channel(Nil).new(1)","external_name":"channel","restriction":""}],"visibility":"Public","body":"LOG.trace do\n  \"Sending PING\"\nend\nwrite do\n  @io << \"PING\\r\\n\"\n  @ping_count.add(1)\n  @pings.send(channel)\nend\n@on_ping.call\n"},"external_var":false},{"html_id":"publish(subject:String,message:Data=Bytes.empty,reply_to:String|Nil=nil,headers:Message::Headers|Nil=nil):Nil-instance-method","name":"publish","doc":"Publish the given message body (either `Bytes` for binary data or `String` for text) on the given NATS subject, optionally supplying a `reply_to` subject (if expecting a reply or to notify the receiver where to send updates) and any `headers`.\n\n```\n# Send an empty message to a subject\nnats.publish \"hello\"\n\n# Serialize an object to a subject\nnats.publish \"orders.#{order.id}\", order.to_json\n\n# Tell a recipient where to send results. For example, to stream results\n# to a given subject:\nreply_subject = \"replies.orders.list.customer.123\"\norders = [] of Order\nnats.subscribe reply_subject do |msg|\n  case result = (Order | Complete).from_json(String.new(msg.body))\n  in Order\n    orders << result\n  in Complete\n    nats.unsubscribe reply_subject\n  end\nend\nnats.publish \"orders.list.customer.123\", reply_to: reply_subject\n\n# Publish a message to NATS JetStream with a message-deduplication header\n# for idempotency:\nnats.jetstream.subscribe consumer_subject, queue_group: \"my-service\" do |msg|\n  # ...\nend\nnats.publish orders_subject, order.to_json, headers: NATS::Message::Headers{\n  # Deduplicate using the equivalent of a cache key\n  \"Nats-Msg-Id\" => \"order-submitted-#{order.id}-#{order.updated_at.to_json}\",\n}\n```","summary":"<p>Publish the given message body (either <code>Bytes</code> for binary data or <code>String</code> for text) on the given NATS subject, optionally supplying a <code>reply_to</code> subject (if expecting a reply or to notify the receiver where to send updates) and any <code>headers</code>.</p>","abstract":false,"args":[{"name":"subject","external_name":"subject","restriction":"String"},{"name":"message","default_value":"Bytes.empty","external_name":"message","restriction":"Data"},{"name":"reply_to","default_value":"nil","external_name":"reply_to","restriction":"String | ::Nil"},{"name":"headers","default_value":"nil","external_name":"headers","restriction":"Message::Headers | ::Nil"}],"args_string":"(subject : String, message : Data = Bytes.empty, reply_to : String | Nil = nil, headers : Message::Headers | Nil = nil) : Nil","args_html":"(subject : String, message : <a href=\"../NATS/Client/Data.html\">Data</a> = <span class=\"t\">Bytes</span>.empty, reply_to : String | Nil = <span class=\"n\">nil</span>, headers : <a href=\"../NATS/Message/Headers.html\">Message::Headers</a> | Nil = <span class=\"n\">nil</span>) : Nil","location":{"filename":"src/nats.cr","line_number":512,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L512"},"def":{"name":"publish","args":[{"name":"subject","external_name":"subject","restriction":"String"},{"name":"message","default_value":"Bytes.empty","external_name":"message","restriction":"Data"},{"name":"reply_to","default_value":"nil","external_name":"reply_to","restriction":"String | ::Nil"},{"name":"headers","default_value":"nil","external_name":"headers","restriction":"Message::Headers | ::Nil"}],"return_type":"Nil","visibility":"Public","body":"if subject.includes?(' ')\n  raise(ArgumentError.new(\"Cannot publish to a subject that contains a space\"))\nend\nif message.bytesize > @server_info.max_payload\n  raise(Error.new(\"Attempted to publish message of size #{message.bytesize}. Cannot publish messages larger than #{@server_info.max_payload}.\"))\nend\n\nLOG.debug do\n  \"Publishing #{message.bytesize} bytes to #{subject.inspect}, reply_to: #{reply_to.inspect}, headers: #{headers.inspect}\"\nend\nwrite do\n  if headers\n    @io << \"HPUB \"\n  else\n    @io << \"PUB \"\n  end\n\n  @io << subject\n  if reply_to\n    (@io << ' ') << reply_to\n  end\n\n  if headers\n    nats_header_preamble = \"NATS/1.0\\r\\n\"\n    initial_header_length = nats_header_preamble.bytesize + 2\n    header_length = headers.reduce(initial_header_length) do |bytes, __temp_142|\n      key, value = __temp_142\n      bytes = bytes + ((key.bytesize + value.bytesize) + 4)\n    end\n    (@io << ' ') << header_length\n    ((@io << ' ') << (header_length + message.bytesize)) << \"\\r\\n\"\n    @io << nats_header_preamble\n    headers.each do |key, value|\n      (((@io << key) << \": \") << value) << \"\\r\\n\"\n    end\n    @io << \"\\r\\n\"\n  else\n    ((@io << ' ') << message.bytesize) << \"\\r\\n\"\n  end\n\n  @io.write(message.to_slice)\n  @io << \"\\r\\n\"\nend\n"},"external_var":false},{"html_id":"reply(msg:Message,body:Data=\"\",headers:Headers|Nil=nil,*,flush=true):Nil-instance-method","name":"reply","doc":"Send the given `body` to the `msg`'s `reply_to` subject, often used in a\nrequest/reply messaging model.\n\n```\nnats.subscribe \"orders.*\", queue_group: \"orders-service\" do |msg|\n  _, id = msg.subject.split('.') # Similar to HTTP path routing\n\n  if order = OrderQuery.new.find_by(id: id)\n    nats.reply msg, {order: order}.to_json\n  else\n    nats.reply msg, {error: \"No order with that id found\"}.to_json\n  end\nend\n```","summary":"<p>Send the given <code>body</code> to the <code>msg</code>'s <code>reply_to</code> subject, often used in a request/reply messaging model.</p>","abstract":false,"args":[{"name":"msg","external_name":"msg","restriction":"Message"},{"name":"body","default_value":"\"\"","external_name":"body","restriction":"Data"},{"name":"headers","default_value":"nil","external_name":"headers","restriction":"Headers | ::Nil"},{"name":"","external_name":"","restriction":""},{"name":"flush","default_value":"true","external_name":"flush","restriction":""}],"args_string":"(msg : Message, body : Data = \"\", headers : Headers | Nil = nil, *, flush = true) : Nil","args_html":"(msg : <a href=\"../NATS/Message.html\">Message</a>, body : <a href=\"../NATS/Client/Data.html\">Data</a> = <span class=\"s\">&quot;&quot;</span>, headers : <a href=\"../NATS/Headers.html\">Headers</a> | Nil = <span class=\"n\">nil</span>, *, flush = <span class=\"n\">true</span>) : Nil","location":{"filename":"src/nats.cr","line_number":470,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L470"},"def":{"name":"reply","args":[{"name":"msg","external_name":"msg","restriction":"Message"},{"name":"body","default_value":"\"\"","external_name":"body","restriction":"Data"},{"name":"headers","default_value":"nil","external_name":"headers","restriction":"Headers | ::Nil"},{"name":"","external_name":"","restriction":""},{"name":"flush","default_value":"true","external_name":"flush","restriction":""}],"splat_index":3,"return_type":"Nil","visibility":"Public","body":"if subject = msg.reply_to\n  publish(subject, body, headers: headers)\n  if flush\n    flush!\n  end\nelse\n  raise(NotAReply.new(\"Cannot reply to a message that has no return address\", msg))\nend"},"external_var":false},{"html_id":"request(subject:String,message:Data=\"\",timeout:Time::Span=2.seconds,headers:Headers|Nil=nil,*,flush=true):Message|Nil-instance-method","name":"request","doc":"Make a synchronous request to subscribers of the given `subject`, waiting\nup to `timeout` for a response from any of the subscribers. The first\nmessage to come back will be returned. If no messages comes back before\nthe `timeout` elapses, `nil` is returned.\n\n```\nif order_response = nats.request(\"orders.info.#{order_id}\")\n  response << Order.from_json(String.new(order_response.body))\nelse\n  response.status = :service_unavailable\nend\n```","summary":"<p>Make a synchronous request to subscribers of the given <code>subject</code>, waiting up to <code>timeout</code> for a response from any of the subscribers.</p>","abstract":false,"args":[{"name":"subject","external_name":"subject","restriction":"String"},{"name":"message","default_value":"\"\"","external_name":"message","restriction":"Data"},{"name":"timeout","default_value":"2.seconds","external_name":"timeout","restriction":"Time::Span"},{"name":"headers","default_value":"nil","external_name":"headers","restriction":"Headers | ::Nil"},{"name":"","external_name":"","restriction":""},{"name":"flush","default_value":"true","external_name":"flush","restriction":""}],"args_string":"(subject : String, message : Data = \"\", timeout : Time::Span = 2.seconds, headers : Headers | Nil = nil, *, flush = true) : Message | Nil","args_html":"(subject : String, message : <a href=\"../NATS/Client/Data.html\">Data</a> = <span class=\"s\">&quot;&quot;</span>, timeout : Time::Span = <span class=\"n\">2</span>.seconds, headers : <a href=\"../NATS/Headers.html\">Headers</a> | Nil = <span class=\"n\">nil</span>, *, flush = <span class=\"n\">true</span>) : <a href=\"../NATS/Message.html\">Message</a> | Nil","location":{"filename":"src/nats.cr","line_number":403,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L403"},"def":{"name":"request","args":[{"name":"subject","external_name":"subject","restriction":"String"},{"name":"message","default_value":"\"\"","external_name":"message","restriction":"Data"},{"name":"timeout","default_value":"2.seconds","external_name":"timeout","restriction":"Time::Span"},{"name":"headers","default_value":"nil","external_name":"headers","restriction":"Headers | ::Nil"},{"name":"","external_name":"","restriction":""},{"name":"flush","default_value":"true","external_name":"flush","restriction":""}],"splat_index":4,"return_type":"Message | ::Nil","visibility":"Public","body":"channel = Channel(Message).new(1)\ninbox = @nuid.next\nkey = \"#{@inbox_prefix}.#{inbox}\"\n@inbox_handlers[key] = ->(msg : Message) do\n  if channel.closed?\n  else\n    channel.send(msg)\n  end\nend\npublish(subject, message, reply_to: key, headers: headers)\n\n\n\n\n\n\nif flush\n  flush!\nend\n\nbegin\n  select\n  when msg = channel.receive?\n    if msg\n      if msg.body.empty? && (msg.headers.try(&.[]?(\"Status\")) == \"503\")\n      else\n        msg\n      end\n    end\n  when timeout(timeout)\n    channel.close\n    nil\n  end\nensure\n  @inbox_handlers.delete(key)\nend\n"},"external_var":false},{"html_id":"request(subject:String,message:Data=\"\",timeout=2.seconds,&block:Message->):Nil-instance-method","name":"request","doc":"Make an asynchronous request to subscribers of the given `subject`, not\nwaiting for a response. The first message to come back will be passed to\nthe block.","summary":"<p>Make an asynchronous request to subscribers of the given <code>subject</code>, not waiting for a response.</p>","abstract":false,"args":[{"name":"subject","external_name":"subject","restriction":"String"},{"name":"message","default_value":"\"\"","external_name":"message","restriction":"Data"},{"name":"timeout","default_value":"2.seconds","external_name":"timeout","restriction":""}],"args_string":"(subject : String, message : Data = \"\", timeout = 2.seconds, &block : Message -> ) : Nil","args_html":"(subject : String, message : <a href=\"../NATS/Client/Data.html\">Data</a> = <span class=\"s\">&quot;&quot;</span>, timeout = <span class=\"n\">2</span>.seconds, &block : <a href=\"../NATS/Message.html\">Message</a> -> ) : Nil","location":{"filename":"src/nats.cr","line_number":439,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L439"},"def":{"name":"request","args":[{"name":"subject","external_name":"subject","restriction":"String"},{"name":"message","default_value":"\"\"","external_name":"message","restriction":"Data"},{"name":"timeout","default_value":"2.seconds","external_name":"timeout","restriction":""}],"yields":1,"block_arity":1,"block_arg":{"name":"block","external_name":"block","restriction":"(Message ->)"},"return_type":"Nil","visibility":"Public","body":"inbox = @nuid.next\nkey = \"#{@inbox_prefix}.#{inbox}\"\n@inbox_handlers[key] = ->(msg : Message) do\n  block.call(msg)\n  @inbox_handlers.delete(key)\nend\npublish(subject, message, reply_to: key)\nspawn(remove_key(key, after: timeout))\n"},"external_var":false},{"html_id":"server_info:ServerInfo-instance-method","name":"server_info","abstract":false,"location":{"filename":"src/nats.cr","line_number":134,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L134"},"def":{"name":"server_info","return_type":"ServerInfo","visibility":"Public","body":"@server_info"},"external_var":false},{"html_id":"services:Services-instance-method","name":"services","abstract":false,"location":{"filename":"src/services.cr","line_number":374,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L374"},"def":{"name":"services","return_type":"Services","visibility":"Public","body":"if (__temp_173 = @services).nil?\n  @services = (Services.new(self))\nelse\n  __temp_173\nend"},"external_var":false},{"html_id":"state:State-instance-method","name":"state","doc":"The current state of the connection","summary":"<p>The current state of the connection</p>","abstract":false,"location":{"filename":"src/nats.cr","line_number":133,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L133"},"def":{"name":"state","return_type":"State","visibility":"Public","body":"@state"},"external_var":false},{"html_id":"subscribe(subject:String,queue_group:String|Nil=nil,sid=@current_sid.add(1),max_in_flight=64000,*,concurrency=1,&block:Message,Subscription->):Subscription-instance-method","name":"subscribe","doc":"Subscribe to the given `subject`, optionally with a `queue_group` (so that\neach message is delivered to this application once instead of once for\neach instance of the application), executing the given block for each\nmessage.\n\n```\nrequire \"nats\"\n\nnats = NATS::Client.new\nnats.subscribe \"orders.created\" do |msg|\n  order = Order.from_json(String.new(msg.body))\n\n  # ...\nend\n```","summary":"<p>Subscribe to the given <code>subject</code>, optionally with a <code>queue_group</code> (so that each message is delivered to this application once instead of once for each instance of the application), executing the given block for each message.</p>","abstract":false,"args":[{"name":"subject","external_name":"subject","restriction":"String"},{"name":"queue_group","default_value":"nil","external_name":"queue_group","restriction":"String | ::Nil"},{"name":"sid","default_value":"@current_sid.add(1)","external_name":"sid","restriction":""},{"name":"max_in_flight","default_value":"64000","external_name":"max_in_flight","restriction":""},{"name":"","external_name":"","restriction":""},{"name":"concurrency","default_value":"1","external_name":"concurrency","restriction":""}],"args_string":"(subject : String, queue_group : String | Nil = nil, sid = @current_sid.add(1), max_in_flight = 64000, *, concurrency = 1, &block : Message, Subscription -> ) : Subscription","args_html":"(subject : String, queue_group : String | Nil = <span class=\"n\">nil</span>, sid = @current_sid.add(<span class=\"n\">1</span>), max_in_flight = <span class=\"n\">64000</span>, *, concurrency = <span class=\"n\">1</span>, &block : <a href=\"../NATS/Message.html\">Message</a>, <a href=\"../NATS/Subscription.html\">Subscription</a> -> ) : <a href=\"../NATS/Subscription.html\">Subscription</a>","location":{"filename":"src/nats.cr","line_number":324,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L324"},"def":{"name":"subscribe","args":[{"name":"subject","external_name":"subject","restriction":"String"},{"name":"queue_group","default_value":"nil","external_name":"queue_group","restriction":"String | ::Nil"},{"name":"sid","default_value":"@current_sid.add(1)","external_name":"sid","restriction":""},{"name":"max_in_flight","default_value":"64000","external_name":"max_in_flight","restriction":""},{"name":"","external_name":"","restriction":""},{"name":"concurrency","default_value":"1","external_name":"concurrency","restriction":""}],"splat_index":4,"yields":2,"block_arity":2,"block_arg":{"name":"block","external_name":"block","restriction":"(Message, Subscription ->)"},"return_type":"Subscription","visibility":"Public","body":"LOG.trace do\n  \"Subscribing to #{subject.inspect}, queue_group: #{queue_group.inspect}, sid: #{sid}\"\nend\nwrite do\n  ((@io << \"SUB \") << subject) << ' '\n  if queue_group\n    (@io << queue_group) << ' '\n  end\n  (@io << sid) << \"\\r\\n\"\nend\n\n@subscriptions[sid] = (Subscription.new(subject, sid, queue_group, self, max_in_flight: max_in_flight, concurrency: concurrency, &block)).tap(&.start)\n"},"external_var":false},{"html_id":"unsubscribe(subscription:Subscription,max_messages:Int):Nil-instance-method","name":"unsubscribe","doc":"Unsubscribe from the given subscription after the specified number of messages has been received.","summary":"<p>Unsubscribe from the given subscription after the specified number of messages has been received.</p>","abstract":false,"args":[{"name":"subscription","external_name":"subscription","restriction":"Subscription"},{"name":"max_messages","external_name":"max_messages","restriction":"Int"}],"args_string":"(subscription : Subscription, max_messages : Int) : Nil","args_html":"(subscription : <a href=\"../NATS/Subscription.html\">Subscription</a>, max_messages : Int) : Nil","location":{"filename":"src/nats.cr","line_number":371,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L371"},"def":{"name":"unsubscribe","args":[{"name":"subscription","external_name":"subscription","restriction":"Subscription"},{"name":"max_messages","external_name":"max_messages","restriction":"Int"}],"return_type":"Nil","visibility":"Public","body":"unsubscribe(subscription.sid, max_messages)"},"external_var":false},{"html_id":"unsubscribe(subscription:Subscription):Nil-instance-method","name":"unsubscribe","doc":"Unsubscribe from the given subscription\n\n```\nnats = NATS::Client.new\n\nnew_orders = [] of NATS::Message\nsubscription = nats.subscribe \"orders.created.*\" do |msg|\n  messages << msg\nend\n\nspawn do\n  sleep 10.seconds\n  nats.unsubscribe subscription\nend\n```","summary":"<p>Unsubscribe from the given subscription</p>","abstract":false,"args":[{"name":"subscription","external_name":"subscription","restriction":"Subscription"}],"args_string":"(subscription : Subscription) : Nil","args_html":"(subscription : <a href=\"../NATS/Subscription.html\">Subscription</a>) : Nil","location":{"filename":"src/nats.cr","line_number":366,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L366"},"def":{"name":"unsubscribe","args":[{"name":"subscription","external_name":"subscription","restriction":"Subscription"}],"return_type":"Nil","visibility":"Public","body":"unsubscribe(subscription.sid)"},"external_var":false}],"types":[{"html_id":"nats/NATS/Client/ClientClosed","path":"NATS/Client/ClientClosed.html","kind":"class","full_name":"NATS::Client::ClientClosed","name":"ClientClosed","abstract":false,"superclass":{"html_id":"nats/NATS/Error","kind":"class","full_name":"NATS::Error","name":"Error"},"ancestors":[{"html_id":"nats/NATS/Error","kind":"class","full_name":"NATS::Error","name":"Error"},{"html_id":"nats/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/nats.cr","line_number":919,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L919"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/Client","kind":"class","full_name":"NATS::Client","name":"Client"},"doc":"Raised when an attempt is made to communicate with the NATS server using\na client instance that has been explicitly closed.","summary":"<p>Raised when an attempt is made to communicate with the NATS server using a client instance that has been explicitly closed.</p>"},{"html_id":"nats/NATS/Client/Data","path":"NATS/Client/Data.html","kind":"alias","full_name":"NATS::Client::Data","name":"Data","abstract":false,"locations":[{"filename":"src/nats.cr","line_number":89,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L89"}],"repository_name":"nats","program":false,"enum":false,"alias":true,"aliased":"(Slice(UInt8) | String)","aliased_html":"Slice(UInt8) | String","const":false,"namespace":{"html_id":"nats/NATS/Client","kind":"class","full_name":"NATS::Client","name":"Client"}},{"html_id":"nats/NATS/Client/State","path":"NATS/Client/State.html","kind":"enum","full_name":"NATS::Client::State","name":"State","abstract":false,"ancestors":[{"html_id":"nats/Enum","kind":"struct","full_name":"Enum","name":"Enum"},{"html_id":"nats/Comparable","kind":"module","full_name":"Comparable","name":"Comparable"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/nats.cr","line_number":97,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L97"}],"repository_name":"nats","program":false,"enum":true,"alias":false,"const":false,"constants":[{"id":"Connecting","name":"Connecting","value":"0","doc":"The connection is currently awaiting a completed NATS connection. We\ncould be awaiting TCP, TLS, NATS protocol handshake, synchronization,\netc. Ideally, a client doesn't spend more than a few milliseconds in\nthis state.","summary":"<p>The connection is currently awaiting a completed NATS connection.</p>"},{"id":"Connected","name":"Connected","value":"1","doc":"A successful NATS connection has been made.","summary":"<p>A successful NATS connection has been made.</p>"},{"id":"Disconnected","name":"Disconnected","value":"2","doc":"The client has been disconnected and is either currently executing its\ndisconnect handler or is waiting on the reconnect backoff period.","summary":"<p>The client has been disconnected and is either currently executing its disconnect handler or is waiting on the reconnect backoff period.</p>"},{"id":"Reconnecting","name":"Reconnecting","value":"3","doc":"The disconnect handler has been invoked, the backoff period has elapsed\nand the client is currenty attempting to reconnect to the NATS server.","summary":"<p>The disconnect handler has been invoked, the backoff period has elapsed and the client is currenty attempting to reconnect to the NATS server.</p>"},{"id":"Closed","name":"Closed","value":"4","doc":"The client has been explicitly closed with `NATS::Client#close`.","summary":"<p>The client has been explicitly closed with <code><a href=\"../../NATS/Client.html#close%3ANil-instance-method\">NATS::Client#close</a></code>.</p>"}],"namespace":{"html_id":"nats/NATS/Client","kind":"class","full_name":"NATS::Client","name":"Client"},"doc":"The current state of the client's connection","summary":"<p>The current state of the client's connection</p>","instance_methods":[{"html_id":"closed?-instance-method","name":"closed?","doc":"Returns `true` if this enum value equals `Closed`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../NATS/Client/State.html#Closed\">Closed</a></code></p>","abstract":false,"location":{"filename":"src/nats.cr","line_number":116,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L116"},"def":{"name":"closed?","visibility":"Public","body":"self == Closed"},"external_var":false},{"html_id":"connected?-instance-method","name":"connected?","doc":"Returns `true` if this enum value equals `Connected`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../NATS/Client/State.html#Connected\">Connected</a></code></p>","abstract":false,"location":{"filename":"src/nats.cr","line_number":105,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L105"},"def":{"name":"connected?","visibility":"Public","body":"self == Connected"},"external_var":false},{"html_id":"connecting?-instance-method","name":"connecting?","doc":"Returns `true` if this enum value equals `Connecting`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../NATS/Client/State.html#Connecting\">Connecting</a></code></p>","abstract":false,"location":{"filename":"src/nats.cr","line_number":102,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L102"},"def":{"name":"connecting?","visibility":"Public","body":"self == Connecting"},"external_var":false},{"html_id":"disconnected?-instance-method","name":"disconnected?","doc":"Returns `true` if this enum value equals `Disconnected`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../NATS/Client/State.html#Disconnected\">Disconnected</a></code></p>","abstract":false,"location":{"filename":"src/nats.cr","line_number":109,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L109"},"def":{"name":"disconnected?","visibility":"Public","body":"self == Disconnected"},"external_var":false},{"html_id":"reconnecting?-instance-method","name":"reconnecting?","doc":"Returns `true` if this enum value equals `Reconnecting`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../NATS/Client/State.html#Reconnecting\">Reconnecting</a></code></p>","abstract":false,"location":{"filename":"src/nats.cr","line_number":113,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L113"},"def":{"name":"reconnecting?","visibility":"Public","body":"self == Reconnecting"},"external_var":false}]}]},{"html_id":"nats/NATS/Data","path":"NATS/Data.html","kind":"alias","full_name":"NATS::Data","name":"Data","abstract":false,"locations":[{"filename":"src/nats.cr","line_number":37,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L37"}],"repository_name":"nats","program":false,"enum":false,"alias":true,"aliased":"(Slice(UInt8) | String)","aliased_html":"Slice(UInt8) | String","const":false,"namespace":{"html_id":"nats/NATS","kind":"module","full_name":"NATS","name":"NATS"}},{"html_id":"nats/NATS/Error","path":"NATS/Error.html","kind":"class","full_name":"NATS::Error","name":"Error","abstract":false,"superclass":{"html_id":"nats/Exception","kind":"class","full_name":"Exception","name":"Exception"},"ancestors":[{"html_id":"nats/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/error.cr","line_number":3,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/error.cr#L3"},{"filename":"src/nats.cr","line_number":40,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L40"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"subclasses":[{"html_id":"nats/NATS/Client/ClientClosed","kind":"class","full_name":"NATS::Client::ClientClosed","name":"ClientClosed"},{"html_id":"nats/NATS/JetStream/Error","kind":"class","full_name":"NATS::JetStream::Error","name":"Error"},{"html_id":"nats/NATS/JetStream/PullSubscription/InternalError","kind":"class","full_name":"NATS::JetStream::PullSubscription::InternalError","name":"InternalError"},{"html_id":"nats/NATS/KV/Error","kind":"class","full_name":"NATS::KV::Error","name":"Error"},{"html_id":"nats/NATS/NKeys/Error","kind":"class","full_name":"NATS::NKeys::Error","name":"Error"},{"html_id":"nats/NATS/NotAReply","kind":"class","full_name":"NATS::NotAReply","name":"NotAReply"},{"html_id":"nats/NATS/Objects/Error","kind":"class","full_name":"NATS::Objects::Error","name":"Error"},{"html_id":"nats/NATS/ServerNotRespondingToPings","kind":"class","full_name":"NATS::ServerNotRespondingToPings","name":"ServerNotRespondingToPings"},{"html_id":"nats/NATS/UnknownCommand","kind":"class","full_name":"NATS::UnknownCommand","name":"UnknownCommand"}],"namespace":{"html_id":"nats/NATS","kind":"module","full_name":"NATS","name":"NATS"},"doc":"Generic error","summary":"<p>Generic error</p>"},{"html_id":"nats/NATS/Headers","path":"NATS/Headers.html","kind":"alias","full_name":"NATS::Headers","name":"Headers","abstract":false,"locations":[{"filename":"src/nats.cr","line_number":36,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L36"}],"repository_name":"nats","program":false,"enum":false,"alias":true,"aliased":"Hash(String, String)","aliased_html":"Hash(String, String)","const":false,"namespace":{"html_id":"nats/NATS","kind":"module","full_name":"NATS","name":"NATS"}},{"html_id":"nats/NATS/JetStream","path":"NATS/JetStream.html","kind":"module","full_name":"NATS::JetStream","name":"JetStream","abstract":false,"locations":[{"filename":"src/jetstream.cr","line_number":10,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream.cr#L10"},{"filename":"src/jetstream/api_error.cr","line_number":3,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/api_error.cr#L3"},{"filename":"src/jetstream/client.cr","line_number":8,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/client.cr#L8"},{"filename":"src/jetstream/cluster_info.cr","line_number":4,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/cluster_info.cr#L4"},{"filename":"src/jetstream/consumer.cr","line_number":5,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer.cr#L5"},{"filename":"src/jetstream/consumer_config.cr","line_number":3,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L3"},{"filename":"src/jetstream/consumer_list_response.cr","line_number":4,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_list_response.cr#L4"},{"filename":"src/jetstream/consumers.cr","line_number":6,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumers.cr#L6"},{"filename":"src/jetstream/entity.cr","line_number":1,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/entity.cr#L1"},{"filename":"src/jetstream/error.cr","line_number":3,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/error.cr#L3"},{"filename":"src/jetstream/error_response.cr","line_number":4,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/error_response.cr#L4"},{"filename":"src/jetstream/errors.cr","line_number":3,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/errors.cr#L3"},{"filename":"src/jetstream/external_stream.cr","line_number":4,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/external_stream.cr#L4"},{"filename":"src/jetstream/message.cr","line_number":3,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/message.cr#L3"},{"filename":"src/jetstream/nak_backoff.cr","line_number":1,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/nak_backoff.cr#L1"},{"filename":"src/jetstream/nanoseconds_converter.cr","line_number":3,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/nanoseconds_converter.cr#L3"},{"filename":"src/jetstream/peer_info.cr","line_number":4,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/peer_info.cr#L4"},{"filename":"src/jetstream/pub_ack.cr","line_number":4,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/pub_ack.cr#L4"},{"filename":"src/jetstream/pull_subscription.cr","line_number":5,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/pull_subscription.cr#L5"},{"filename":"src/jetstream/stream.cr","line_number":7,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream.cr#L7"},{"filename":"src/jetstream/stream_config.cr","line_number":4,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L4"},{"filename":"src/jetstream/stream_get_msg_response.cr","line_number":5,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_get_msg_response.cr#L5"},{"filename":"src/jetstream/stream_list_response.cr","line_number":7,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_list_response.cr#L7"},{"filename":"src/jetstream/stream_source.cr","line_number":4,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_source.cr#L4"},{"filename":"src/jetstream/stream_source_info.cr","line_number":6,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_source_info.cr#L6"},{"filename":"src/jetstream/stream_state.cr","line_number":3,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_state.cr#L3"},{"filename":"src/jetstream/streams.cr","line_number":10,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/streams.cr#L10"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS","kind":"module","full_name":"NATS","name":"NATS"},"doc":"NATS JetStream provides at-least-once delivery guarantees with the\npossibility of exactly-once for some use cases, allowing NATS to be used for\nscenarios where 100% delivery of messages and events is required.","summary":"<p>NATS JetStream provides at-least-once delivery guarantees with the possibility of exactly-once for some use cases, allowing NATS to be used for scenarios where 100% delivery of messages and events is required.</p>","macros":[{"html_id":"deprecate_api_v1(name)-macro","name":"deprecate_api_v1","abstract":false,"args":[{"name":"name","external_name":"name","restriction":""}],"args_string":"(name)","args_html":"(name)","location":{"filename":"src/jetstream/entity.cr","line_number":6,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/entity.cr#L6"},"def":{"name":"deprecate_api_v1","args":[{"name":"name","external_name":"name","restriction":""}],"visibility":"Public","body":"    module ::NATS::JetStream::API::V1\n      @[Deprecated(\"The API::V1 namespace was unnecessary, use NATS::JetStream::\n{{ name }}\n instead\")]\n      alias \n{{ name }}\n = JetStream::\n{{ name }}\n\n    \nend\n  \n"}}],"types":[{"html_id":"nats/NATS/JetStream/API","path":"NATS/JetStream/API.html","kind":"module","full_name":"NATS::JetStream::API","name":"API","abstract":false,"locations":[{"filename":"src/jetstream/external_stream.cr","line_number":15,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/external_stream.cr#L15"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"},"types":[{"html_id":"nats/NATS/JetStream/API/V1","path":"NATS/JetStream/API/V1.html","kind":"module","full_name":"NATS::JetStream::API::V1","name":"V1","abstract":false,"locations":[{"filename":"src/jetstream/api_error.cr","line_number":10,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/api_error.cr#L10"},{"filename":"src/jetstream/cluster_info.cr","line_number":11,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/cluster_info.cr#L11"},{"filename":"src/jetstream/consumer.cr","line_number":50,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer.cr#L50"},{"filename":"src/jetstream/consumer_config.cr","line_number":162,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L162"},{"filename":"src/jetstream/consumer_list_response.cr","line_number":18,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_list_response.cr#L18"},{"filename":"src/jetstream/consumers.cr","line_number":110,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumers.cr#L110"},{"filename":"src/jetstream/error_response.cr","line_number":19,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/error_response.cr#L19"},{"filename":"src/jetstream/external_stream.cr","line_number":15,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/external_stream.cr#L15"},{"filename":"src/jetstream/nanoseconds_converter.cr","line_number":14,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/nanoseconds_converter.cr#L14"},{"filename":"src/jetstream/peer_info.cr","line_number":14,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/peer_info.cr#L14"},{"filename":"src/jetstream/pub_ack.cr","line_number":13,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/pub_ack.cr#L13"},{"filename":"src/jetstream/stream.cr","line_number":17,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream.cr#L17"},{"filename":"src/jetstream/stream_config.cr","line_number":149,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L149"},{"filename":"src/jetstream/stream_get_msg_response.cr","line_number":77,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_get_msg_response.cr#L77"},{"filename":"src/jetstream/stream_list_response.cr","line_number":45,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_list_response.cr#L45"},{"filename":"src/jetstream/stream_source.cr","line_number":22,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_source.cr#L22"},{"filename":"src/jetstream/stream_source_info.cr","line_number":20,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_source_info.cr#L20"},{"filename":"src/jetstream/stream_state.cr","line_number":14,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_state.cr#L14"},{"filename":"src/jetstream/streams.cr","line_number":205,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/streams.cr#L205"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream/API","kind":"module","full_name":"NATS::JetStream::API","name":"API"},"types":[{"html_id":"nats/NATS/JetStream/API/V1/APIError","path":"NATS/JetStream/API/V1/APIError.html","kind":"alias","full_name":"NATS::JetStream::API::V1::APIError","name":"APIError","abstract":false,"locations":[{"filename":"src/jetstream/api_error.cr","line_number":10,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/api_error.cr#L10"}],"repository_name":"nats","program":false,"enum":false,"alias":true,"aliased":"NATS::JetStream::APIError","aliased_html":"<a href=\"../../../../NATS/JetStream/APIError.html\">NATS::JetStream::APIError</a>","const":false,"namespace":{"html_id":"nats/NATS/JetStream/API/V1","kind":"module","full_name":"NATS::JetStream::API::V1","name":"V1"}},{"html_id":"nats/NATS/JetStream/API/V1/ClusterInfo","path":"NATS/JetStream/API/V1/ClusterInfo.html","kind":"alias","full_name":"NATS::JetStream::API::V1::ClusterInfo","name":"ClusterInfo","abstract":false,"locations":[{"filename":"src/jetstream/cluster_info.cr","line_number":11,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/cluster_info.cr#L11"}],"repository_name":"nats","program":false,"enum":false,"alias":true,"aliased":"NATS::JetStream::ClusterInfo","aliased_html":"<a href=\"../../../../NATS/JetStream/ClusterInfo.html\">NATS::JetStream::ClusterInfo</a>","const":false,"namespace":{"html_id":"nats/NATS/JetStream/API/V1","kind":"module","full_name":"NATS::JetStream::API::V1","name":"V1"}},{"html_id":"nats/NATS/JetStream/API/V1/Consumer","path":"NATS/JetStream/API/V1/Consumer.html","kind":"alias","full_name":"NATS::JetStream::API::V1::Consumer","name":"Consumer","abstract":false,"locations":[{"filename":"src/jetstream/consumer.cr","line_number":50,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer.cr#L50"}],"repository_name":"nats","program":false,"enum":false,"alias":true,"aliased":"NATS::JetStream::Consumer","aliased_html":"<a href=\"../../../../NATS/JetStream/Consumer.html\">NATS::JetStream::Consumer</a>","const":false,"namespace":{"html_id":"nats/NATS/JetStream/API/V1","kind":"module","full_name":"NATS::JetStream::API::V1","name":"V1"}},{"html_id":"nats/NATS/JetStream/API/V1/ConsumerConfig","path":"NATS/JetStream/API/V1/ConsumerConfig.html","kind":"alias","full_name":"NATS::JetStream::API::V1::ConsumerConfig","name":"ConsumerConfig","abstract":false,"locations":[{"filename":"src/jetstream/consumer_config.cr","line_number":162,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L162"}],"repository_name":"nats","program":false,"enum":false,"alias":true,"aliased":"NATS::JetStream::ConsumerConfig","aliased_html":"<a href=\"../../../../NATS/JetStream/ConsumerConfig.html\">NATS::JetStream::ConsumerConfig</a>","const":false,"namespace":{"html_id":"nats/NATS/JetStream/API/V1","kind":"module","full_name":"NATS::JetStream::API::V1","name":"V1"}},{"html_id":"nats/NATS/JetStream/API/V1/ConsumerListResponse","path":"NATS/JetStream/API/V1/ConsumerListResponse.html","kind":"alias","full_name":"NATS::JetStream::API::V1::ConsumerListResponse","name":"ConsumerListResponse","abstract":false,"locations":[{"filename":"src/jetstream/consumer_list_response.cr","line_number":18,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_list_response.cr#L18"}],"repository_name":"nats","program":false,"enum":false,"alias":true,"aliased":"NATS::JetStream::ConsumerListResponse","aliased_html":"<a href=\"../../../../NATS/JetStream/ConsumerListResponse.html\">NATS::JetStream::ConsumerListResponse</a>","const":false,"namespace":{"html_id":"nats/NATS/JetStream/API/V1","kind":"module","full_name":"NATS::JetStream::API::V1","name":"V1"}},{"html_id":"nats/NATS/JetStream/API/V1/Consumers","path":"NATS/JetStream/API/V1/Consumers.html","kind":"alias","full_name":"NATS::JetStream::API::V1::Consumers","name":"Consumers","abstract":false,"locations":[{"filename":"src/jetstream/consumers.cr","line_number":110,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumers.cr#L110"}],"repository_name":"nats","program":false,"enum":false,"alias":true,"aliased":"NATS::JetStream::Consumers","aliased_html":"<a href=\"../../../../NATS/JetStream/Consumers.html\">NATS::JetStream::Consumers</a>","const":false,"namespace":{"html_id":"nats/NATS/JetStream/API/V1","kind":"module","full_name":"NATS::JetStream::API::V1","name":"V1"}},{"html_id":"nats/NATS/JetStream/API/V1/ErrorResponse","path":"NATS/JetStream/API/V1/ErrorResponse.html","kind":"alias","full_name":"NATS::JetStream::API::V1::ErrorResponse","name":"ErrorResponse","abstract":false,"locations":[{"filename":"src/jetstream/error_response.cr","line_number":19,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/error_response.cr#L19"}],"repository_name":"nats","program":false,"enum":false,"alias":true,"aliased":"NATS::JetStream::ErrorResponse","aliased_html":"<a href=\"../../../../NATS/JetStream/ErrorResponse.html\">NATS::JetStream::ErrorResponse</a>","const":false,"namespace":{"html_id":"nats/NATS/JetStream/API/V1","kind":"module","full_name":"NATS::JetStream::API::V1","name":"V1"}},{"html_id":"nats/NATS/JetStream/API/V1/ExternalStream","path":"NATS/JetStream/API/V1/ExternalStream.html","kind":"alias","full_name":"NATS::JetStream::API::V1::ExternalStream","name":"ExternalStream","abstract":false,"locations":[{"filename":"src/jetstream/external_stream.cr","line_number":15,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/external_stream.cr#L15"}],"repository_name":"nats","program":false,"enum":false,"alias":true,"aliased":"NATS::JetStream::ExternalStream","aliased_html":"<a href=\"../../../../NATS/JetStream/ExternalStream.html\">NATS::JetStream::ExternalStream</a>","const":false,"namespace":{"html_id":"nats/NATS/JetStream/API/V1","kind":"module","full_name":"NATS::JetStream::API::V1","name":"V1"}},{"html_id":"nats/NATS/JetStream/API/V1/NanosecondsConverter","path":"NATS/JetStream/API/V1/NanosecondsConverter.html","kind":"alias","full_name":"NATS::JetStream::API::V1::NanosecondsConverter","name":"NanosecondsConverter","abstract":false,"locations":[{"filename":"src/jetstream/nanoseconds_converter.cr","line_number":14,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/nanoseconds_converter.cr#L14"}],"repository_name":"nats","program":false,"enum":false,"alias":true,"aliased":"NATS::JetStream::NanosecondsConverter","aliased_html":"<a href=\"../../../../NATS/JetStream/NanosecondsConverter.html\">NATS::JetStream::NanosecondsConverter</a>","const":false,"namespace":{"html_id":"nats/NATS/JetStream/API/V1","kind":"module","full_name":"NATS::JetStream::API::V1","name":"V1"}},{"html_id":"nats/NATS/JetStream/API/V1/PeerInfo","path":"NATS/JetStream/API/V1/PeerInfo.html","kind":"alias","full_name":"NATS::JetStream::API::V1::PeerInfo","name":"PeerInfo","abstract":false,"locations":[{"filename":"src/jetstream/peer_info.cr","line_number":14,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/peer_info.cr#L14"}],"repository_name":"nats","program":false,"enum":false,"alias":true,"aliased":"NATS::JetStream::PeerInfo","aliased_html":"<a href=\"../../../../NATS/JetStream/PeerInfo.html\">NATS::JetStream::PeerInfo</a>","const":false,"namespace":{"html_id":"nats/NATS/JetStream/API/V1","kind":"module","full_name":"NATS::JetStream::API::V1","name":"V1"}},{"html_id":"nats/NATS/JetStream/API/V1/PubAck","path":"NATS/JetStream/API/V1/PubAck.html","kind":"alias","full_name":"NATS::JetStream::API::V1::PubAck","name":"PubAck","abstract":false,"locations":[{"filename":"src/jetstream/pub_ack.cr","line_number":13,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/pub_ack.cr#L13"}],"repository_name":"nats","program":false,"enum":false,"alias":true,"aliased":"NATS::JetStream::PubAck","aliased_html":"<a href=\"../../../../NATS/JetStream/PubAck.html\">NATS::JetStream::PubAck</a>","const":false,"namespace":{"html_id":"nats/NATS/JetStream/API/V1","kind":"module","full_name":"NATS::JetStream::API::V1","name":"V1"}},{"html_id":"nats/NATS/JetStream/API/V1/Stream","path":"NATS/JetStream/API/V1/Stream.html","kind":"alias","full_name":"NATS::JetStream::API::V1::Stream","name":"Stream","abstract":false,"locations":[{"filename":"src/jetstream/stream.cr","line_number":17,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream.cr#L17"}],"repository_name":"nats","program":false,"enum":false,"alias":true,"aliased":"NATS::JetStream::Stream","aliased_html":"<a href=\"../../../../NATS/JetStream/Stream.html\">NATS::JetStream::Stream</a>","const":false,"namespace":{"html_id":"nats/NATS/JetStream/API/V1","kind":"module","full_name":"NATS::JetStream::API::V1","name":"V1"}},{"html_id":"nats/NATS/JetStream/API/V1/StreamConfig","path":"NATS/JetStream/API/V1/StreamConfig.html","kind":"alias","full_name":"NATS::JetStream::API::V1::StreamConfig","name":"StreamConfig","abstract":false,"locations":[{"filename":"src/jetstream/stream_config.cr","line_number":149,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L149"}],"repository_name":"nats","program":false,"enum":false,"alias":true,"aliased":"NATS::JetStream::StreamConfig","aliased_html":"<a href=\"../../../../NATS/JetStream/StreamConfig.html\">NATS::JetStream::StreamConfig</a>","const":false,"namespace":{"html_id":"nats/NATS/JetStream/API/V1","kind":"module","full_name":"NATS::JetStream::API::V1","name":"V1"}},{"html_id":"nats/NATS/JetStream/API/V1/StreamGetMsgResponse","path":"NATS/JetStream/API/V1/StreamGetMsgResponse.html","kind":"alias","full_name":"NATS::JetStream::API::V1::StreamGetMsgResponse","name":"StreamGetMsgResponse","abstract":false,"locations":[{"filename":"src/jetstream/stream_get_msg_response.cr","line_number":77,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_get_msg_response.cr#L77"}],"repository_name":"nats","program":false,"enum":false,"alias":true,"aliased":"NATS::JetStream::StreamGetMsgResponse","aliased_html":"<a href=\"../../../../NATS/JetStream/StreamGetMsgResponse.html\">NATS::JetStream::StreamGetMsgResponse</a>","const":false,"namespace":{"html_id":"nats/NATS/JetStream/API/V1","kind":"module","full_name":"NATS::JetStream::API::V1","name":"V1"}},{"html_id":"nats/NATS/JetStream/API/V1/StreamListResponse","path":"NATS/JetStream/API/V1/StreamListResponse.html","kind":"alias","full_name":"NATS::JetStream::API::V1::StreamListResponse","name":"StreamListResponse","abstract":false,"locations":[{"filename":"src/jetstream/stream_list_response.cr","line_number":45,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_list_response.cr#L45"}],"repository_name":"nats","program":false,"enum":false,"alias":true,"aliased":"NATS::JetStream::StreamListResponse","aliased_html":"<a href=\"../../../../NATS/JetStream/StreamListResponse.html\">NATS::JetStream::StreamListResponse</a>","const":false,"namespace":{"html_id":"nats/NATS/JetStream/API/V1","kind":"module","full_name":"NATS::JetStream::API::V1","name":"V1"}},{"html_id":"nats/NATS/JetStream/API/V1/Streams","path":"NATS/JetStream/API/V1/Streams.html","kind":"alias","full_name":"NATS::JetStream::API::V1::Streams","name":"Streams","abstract":false,"locations":[{"filename":"src/jetstream/streams.cr","line_number":205,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/streams.cr#L205"}],"repository_name":"nats","program":false,"enum":false,"alias":true,"aliased":"NATS::JetStream::Streams","aliased_html":"<a href=\"../../../../NATS/JetStream/Streams.html\">NATS::JetStream::Streams</a>","const":false,"namespace":{"html_id":"nats/NATS/JetStream/API/V1","kind":"module","full_name":"NATS::JetStream::API::V1","name":"V1"}},{"html_id":"nats/NATS/JetStream/API/V1/StreamSource","path":"NATS/JetStream/API/V1/StreamSource.html","kind":"alias","full_name":"NATS::JetStream::API::V1::StreamSource","name":"StreamSource","abstract":false,"locations":[{"filename":"src/jetstream/stream_source.cr","line_number":22,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_source.cr#L22"}],"repository_name":"nats","program":false,"enum":false,"alias":true,"aliased":"NATS::JetStream::StreamSource","aliased_html":"<a href=\"../../../../NATS/JetStream/StreamSource.html\">NATS::JetStream::StreamSource</a>","const":false,"namespace":{"html_id":"nats/NATS/JetStream/API/V1","kind":"module","full_name":"NATS::JetStream::API::V1","name":"V1"}},{"html_id":"nats/NATS/JetStream/API/V1/StreamSourceInfo","path":"NATS/JetStream/API/V1/StreamSourceInfo.html","kind":"alias","full_name":"NATS::JetStream::API::V1::StreamSourceInfo","name":"StreamSourceInfo","abstract":false,"locations":[{"filename":"src/jetstream/stream_source_info.cr","line_number":20,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_source_info.cr#L20"}],"repository_name":"nats","program":false,"enum":false,"alias":true,"aliased":"NATS::JetStream::StreamSourceInfo","aliased_html":"<a href=\"../../../../NATS/JetStream/StreamSourceInfo.html\">NATS::JetStream::StreamSourceInfo</a>","const":false,"namespace":{"html_id":"nats/NATS/JetStream/API/V1","kind":"module","full_name":"NATS::JetStream::API::V1","name":"V1"}},{"html_id":"nats/NATS/JetStream/API/V1/StreamState","path":"NATS/JetStream/API/V1/StreamState.html","kind":"alias","full_name":"NATS::JetStream::API::V1::StreamState","name":"StreamState","abstract":false,"locations":[{"filename":"src/jetstream/stream_state.cr","line_number":14,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_state.cr#L14"}],"repository_name":"nats","program":false,"enum":false,"alias":true,"aliased":"NATS::JetStream::StreamState","aliased_html":"<a href=\"../../../../NATS/JetStream/StreamState.html\">NATS::JetStream::StreamState</a>","const":false,"namespace":{"html_id":"nats/NATS/JetStream/API/V1","kind":"module","full_name":"NATS::JetStream::API::V1","name":"V1"}}]}]},{"html_id":"nats/NATS/JetStream/APIError","path":"NATS/JetStream/APIError.html","kind":"struct","full_name":"NATS::JetStream::APIError","name":"APIError","abstract":false,"superclass":{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},"ancestors":[{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/api_error.cr","line_number":4,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/api_error.cr#L4"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/jetstream/api_error.cr","line_number":4,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/api_error.cr#L4"},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"},"external_var":false}],"instance_methods":[{"html_id":"code:Int64-instance-method","name":"code","abstract":false,"location":{"filename":"src/jetstream/api_error.cr","line_number":5,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/api_error.cr#L5"},"def":{"name":"code","return_type":"Int64","visibility":"Public","body":"@code"},"external_var":false},{"html_id":"description:String|Nil-instance-method","name":"description","abstract":false,"location":{"filename":"src/jetstream/api_error.cr","line_number":7,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/api_error.cr#L7"},"def":{"name":"description","return_type":"String | ::Nil","visibility":"Public","body":"@description"},"external_var":false},{"html_id":"err_code:UInt16|Nil-instance-method","name":"err_code","abstract":false,"location":{"filename":"src/jetstream/api_error.cr","line_number":6,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/api_error.cr#L6"},"def":{"name":"err_code","return_type":"UInt16 | ::Nil","visibility":"Public","body":"@err_code"},"external_var":false}]},{"html_id":"nats/NATS/JetStream/Client","path":"NATS/JetStream/Client.html","kind":"class","full_name":"NATS::JetStream::Client","name":"Client","abstract":false,"superclass":{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/client.cr","line_number":12,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/client.cr#L12"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"},"doc":"This class provides a client for NATS JetStream for at-least-once delivery.\nYou can either instantiate it with a NATS client or with the\n`NATS::Client#jetstream` method as a shortcut.","summary":"<p>This class provides a client for NATS JetStream for at-least-once delivery.</p>","constructors":[{"html_id":"new(nats:NATS::Client)-class-method","name":"new","abstract":false,"args":[{"name":"nats","external_name":"nats","restriction":"::NATS::Client"}],"args_string":"(nats : NATS::Client)","args_html":"(nats : <a href=\"../../NATS/Client.html\">NATS::Client</a>)","location":{"filename":"src/jetstream/client.cr","line_number":13,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/client.cr#L13"},"def":{"name":"new","args":[{"name":"nats","external_name":"nats","restriction":"::NATS::Client"}],"visibility":"Public","body":"_ = allocate\n_.initialize(nats)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"ack(msg:Message)-instance-method","name":"ack","doc":"Acknowledge success processing the specified message, usually called at\nthe end of your subscription block.\n\nNOTE: This method is asynchronous. If you need a guarantee that NATS has\nreceived your acknowledgement, use `ack_sync` instead.\n\n```\njetstream.subscribe consumer do |msg|\n  # ...\n\n  jetstream.ack msg\nend\n```","summary":"<p>Acknowledge success processing the specified message, usually called at the end of your subscription block.</p>","abstract":false,"args":[{"name":"msg","external_name":"msg","restriction":"Message"}],"args_string":"(msg : Message)","args_html":"(msg : <a href=\"../../NATS/JetStream/Message.html\">Message</a>)","location":{"filename":"src/jetstream/client.cr","line_number":132,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/client.cr#L132"},"def":{"name":"ack","args":[{"name":"msg","external_name":"msg","restriction":"Message"}],"visibility":"Public","body":"@nats.publish(msg.reply_to, \"+ACK\")"},"external_var":false},{"html_id":"ack_sync(msg:Message,timeout:Time::Span=2.seconds)-instance-method","name":"ack_sync","doc":"Acknowledge the given message, waiting on the NATS server to acknowledge\nyour acknowledgement so that you can be sure it was delivered to the\nserver and not simply caught up in the output buffer.\n\n```\njetstream.subscribe consumer do |msg|\n  # ...\n\n  jetstream.ack_sync msg\n  # By the time you get here, the NATS server knows you've acknowledged.\nend\n```","summary":"<p>Acknowledge the given message, waiting on the NATS server to acknowledge your acknowledgement so that you can be sure it was delivered to the server and not simply caught up in the output buffer.</p>","abstract":false,"args":[{"name":"msg","external_name":"msg","restriction":"Message"},{"name":"timeout","default_value":"2.seconds","external_name":"timeout","restriction":"Time::Span"}],"args_string":"(msg : Message, timeout : Time::Span = 2.seconds)","args_html":"(msg : <a href=\"../../NATS/JetStream/Message.html\">Message</a>, timeout : Time::Span = <span class=\"n\">2</span>.seconds)","location":{"filename":"src/jetstream/client.cr","line_number":148,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/client.cr#L148"},"def":{"name":"ack_sync","args":[{"name":"msg","external_name":"msg","restriction":"Message"},{"name":"timeout","default_value":"2.seconds","external_name":"timeout","restriction":"Time::Span"}],"visibility":"Public","body":"@nats.request(msg.reply_to, \"+ACK\", timeout: timeout)"},"external_var":false},{"html_id":"ack_sync(messages:Enumerable(Message),timeout:Time::Span=2.seconds)-instance-method","name":"ack_sync","abstract":false,"args":[{"name":"messages","external_name":"messages","restriction":"Enumerable(Message)"},{"name":"timeout","default_value":"2.seconds","external_name":"timeout","restriction":"Time::Span"}],"args_string":"(messages : Enumerable(Message), timeout : Time::Span = 2.seconds)","args_html":"(messages : Enumerable(<a href=\"../../NATS/JetStream/Message.html\">Message</a>), timeout : Time::Span = <span class=\"n\">2</span>.seconds)","location":{"filename":"src/jetstream/client.cr","line_number":152,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/client.cr#L152"},"def":{"name":"ack_sync","args":[{"name":"messages","external_name":"messages","restriction":"Enumerable(Message)"},{"name":"timeout","default_value":"2.seconds","external_name":"timeout","restriction":"Time::Span"}],"visibility":"Public","body":"channel = Channel(Bool).new(messages.size)\nmessages.each do |msg|\n  @nats.request(msg.reply_to, \"+ACK\", timeout: timeout) do |response|\n    channel.send(true)\n  end\nend\n\ncount = 0\nmessages.each do\n  select\n  when channel.receive\n    count = count + 1\n  when timeout(timeout)\n  end\nend\ncount\n"},"external_var":false},{"html_id":"consumer-instance-method","name":"consumer","doc":"Returns an `API::Consumer` instance to interact with the NATS JetStream\nAPI for consumers.","summary":"<p>Returns an <code>API::Consumer</code> instance to interact with the NATS JetStream API for consumers.</p>","abstract":false,"location":{"filename":"src/jetstream/client.cr","line_number":24,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/client.cr#L24"},"def":{"name":"consumer","visibility":"Public","body":"Consumers.new(@nats)"},"external_var":false},{"html_id":"in_progress(msg:Message)-instance-method","name":"in_progress","doc":"Notify the NATS server that you need more time to process this message,\nusually used when a consumer requires that you acknowledge a message\nwithin a certain amount of time but a given message is taking longer\nthan expected.\n\n```\njetstream.subscribe consumer do |msg|\n  start = Time.monotonic\n  users.each do |user|\n    # If we're running out of time, reset the timer.\n    if Time.monotonic - start > 25.seconds\n      jetstream.in_progress msg\n    end\n\n    process(msg)\n  end\nend\n```","summary":"<p>Notify the NATS server that you need more time to process this message, usually used when a consumer requires that you acknowledge a message within a certain amount of time but a given message is taking longer than expected.</p>","abstract":false,"args":[{"name":"msg","external_name":"msg","restriction":"Message"}],"args_string":"(msg : Message)","args_html":"(msg : <a href=\"../../NATS/JetStream/Message.html\">Message</a>)","location":{"filename":"src/jetstream/client.cr","line_number":189,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/client.cr#L189"},"def":{"name":"in_progress","args":[{"name":"msg","external_name":"msg","restriction":"Message"}],"visibility":"Public","body":"@nats.publish(msg.reply_to, \"+WPI\")"},"external_var":false},{"html_id":"nack(msg:Message)-instance-method","name":"nack","doc":"Negatively acknowledge the processing of a message, typically called\nwhen an exception is raised while processing.\n\n```\njetstream.subscribe consumer do |msg|\n  # doing some work\n\n  jetstream.ack msg # Successfully processed\nrescue ex\n  jetstream.nack msg # Processing was unsuccessful, try again.\nend\n```","summary":"<p>Negatively acknowledge the processing of a message, typically called when an exception is raised while processing.</p>","abstract":false,"args":[{"name":"msg","external_name":"msg","restriction":"Message"}],"args_string":"(msg : Message)","args_html":"(msg : <a href=\"../../NATS/JetStream/Message.html\">Message</a>)","location":{"filename":"src/jetstream/client.cr","line_number":205,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/client.cr#L205"},"def":{"name":"nack","args":[{"name":"msg","external_name":"msg","restriction":"Message"}],"visibility":"Public","body":"@nats.publish(msg.reply_to, \"-NAK\")"},"external_var":false},{"html_id":"nack(msg:Message,*,backoff:NAKBackoff,max:Time::Span=1.day)-instance-method","name":"nack","doc":"Deliver a negative acknowledgement for the given message and tell the\nNATS server to delay sending it based on the `NAKBackoff` pattern\nspecified.\n\n```\njetstream.subscribe consumer do |msg|\n  # do some work\n  jetstream.ack msg\nrescue\n  # Use exponential backoff of up to an hour for retries\n  jetstream.nack msg, backoff: :exponential, max: 1.hour\nend\n```","summary":"<p>Deliver a negative acknowledgement for the given message and tell the NATS server to delay sending it based on the <code><a href=\"../../NATS/JetStream/NAKBackoff.html\">NAKBackoff</a></code> pattern specified.</p>","abstract":false,"args":[{"name":"msg","external_name":"msg","restriction":"Message"},{"name":"","external_name":"","restriction":""},{"name":"backoff","external_name":"backoff","restriction":"NAKBackoff"},{"name":"max","default_value":"1.day","external_name":"max","restriction":"Time::Span"}],"args_string":"(msg : Message, *, backoff : NAKBackoff, max : Time::Span = 1.day)","args_html":"(msg : <a href=\"../../NATS/JetStream/Message.html\">Message</a>, *, backoff : <a href=\"../../NATS/JetStream/NAKBackoff.html\">NAKBackoff</a>, max : Time::Span = <span class=\"n\">1</span>.day)","location":{"filename":"src/jetstream/client.cr","line_number":222,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/client.cr#L222"},"def":{"name":"nack","args":[{"name":"msg","external_name":"msg","restriction":"Message"},{"name":"","external_name":"","restriction":""},{"name":"backoff","external_name":"backoff","restriction":"NAKBackoff"},{"name":"max","default_value":"1.day","external_name":"max","restriction":"Time::Span"}],"splat_index":1,"visibility":"Public","body":"case backoff\nin .exponential?\n  delay = {(2.0 ** (msg.delivered_count - 5)).seconds, max}.min\nin .linear?\n  delay = {msg.delivered_count.seconds, max}.min\nend\nnack(msg, delay: delay)\n"},"external_var":false},{"html_id":"nack(msg:Message,*,delay:Time::Span)-instance-method","name":"nack","doc":"Deliver a negative acknowledgement for the given message and tell the\nNATS server to delay sending it for the given time span.\n\n```\njetstream.subscribe consumer do |msg|\n  # do some work\n  jetstream.ack msg\nrescue\n  # Use exponential backoff of up to an hour for retries\n  jetstream.nack msg, delay: 30.seconds\nend\n```","summary":"<p>Deliver a negative acknowledgement for the given message and tell the NATS server to delay sending it for the given time span.</p>","abstract":false,"args":[{"name":"msg","external_name":"msg","restriction":"Message"},{"name":"","external_name":"","restriction":""},{"name":"delay","external_name":"delay","restriction":"Time::Span"}],"args_string":"(msg : Message, *, delay : Time::Span)","args_html":"(msg : <a href=\"../../NATS/JetStream/Message.html\">Message</a>, *, delay : Time::Span)","location":{"filename":"src/jetstream/client.cr","line_number":245,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/client.cr#L245"},"def":{"name":"nack","args":[{"name":"msg","external_name":"msg","restriction":"Message"},{"name":"","external_name":"","restriction":""},{"name":"delay","external_name":"delay","restriction":"Time::Span"}],"splat_index":1,"visibility":"Public","body":"@nats.publish(msg.reply_to, \"-NAK {\\\"delay\\\":#{delay.total_nanoseconds.to_i64}}\")"},"external_var":false},{"html_id":"publish(subject:String,body:Data,timeout:Time::Span=2.seconds,headers:Headers=Headers.new,message_id:String|Nil=nil,expected_last_message_id:String|Nil=nil,expected_last_sequence:Int64|Nil=nil,expected_stream:String|Nil=nil,expected_last_subject_sequence:Int64|Nil=nil)-instance-method","name":"publish","abstract":false,"args":[{"name":"subject","external_name":"subject","restriction":"String"},{"name":"body","external_name":"body","restriction":"Data"},{"name":"timeout","default_value":"2.seconds","external_name":"timeout","restriction":"Time::Span"},{"name":"headers","default_value":"Headers.new","external_name":"headers","restriction":"Headers"},{"name":"message_id","default_value":"nil","external_name":"message_id","restriction":"String | ::Nil"},{"name":"expected_last_message_id","default_value":"nil","external_name":"expected_last_message_id","restriction":"String | ::Nil"},{"name":"expected_last_sequence","default_value":"nil","external_name":"expected_last_sequence","restriction":"Int64 | ::Nil"},{"name":"expected_stream","default_value":"nil","external_name":"expected_stream","restriction":"String | ::Nil"},{"name":"expected_last_subject_sequence","default_value":"nil","external_name":"expected_last_subject_sequence","restriction":"Int64 | ::Nil"}],"args_string":"(subject : String, body : Data, timeout : Time::Span = 2.seconds, headers : Headers = Headers.new, message_id : String | Nil = nil, expected_last_message_id : String | Nil = nil, expected_last_sequence : Int64 | Nil = nil, expected_stream : String | Nil = nil, expected_last_subject_sequence : Int64 | Nil = nil)","args_html":"(subject : String, body : <a href=\"../../NATS/Data.html\">Data</a>, timeout : Time::Span = <span class=\"n\">2</span>.seconds, headers : <a href=\"../../NATS/Headers.html\">Headers</a> = <span class=\"t\">Headers</span>.new, message_id : String | Nil = <span class=\"n\">nil</span>, expected_last_message_id : String | Nil = <span class=\"n\">nil</span>, expected_last_sequence : Int64 | Nil = <span class=\"n\">nil</span>, expected_stream : String | Nil = <span class=\"n\">nil</span>, expected_last_subject_sequence : Int64 | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/jetstream/client.cr","line_number":28,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/client.cr#L28"},"def":{"name":"publish","args":[{"name":"subject","external_name":"subject","restriction":"String"},{"name":"body","external_name":"body","restriction":"Data"},{"name":"timeout","default_value":"2.seconds","external_name":"timeout","restriction":"Time::Span"},{"name":"headers","default_value":"Headers.new","external_name":"headers","restriction":"Headers"},{"name":"message_id","default_value":"nil","external_name":"message_id","restriction":"String | ::Nil"},{"name":"expected_last_message_id","default_value":"nil","external_name":"expected_last_message_id","restriction":"String | ::Nil"},{"name":"expected_last_sequence","default_value":"nil","external_name":"expected_last_sequence","restriction":"Int64 | ::Nil"},{"name":"expected_stream","default_value":"nil","external_name":"expected_stream","restriction":"String | ::Nil"},{"name":"expected_last_subject_sequence","default_value":"nil","external_name":"expected_last_subject_sequence","restriction":"Int64 | ::Nil"}],"visibility":"Public","body":"if message_id\n  headers[\"Nats-Msg-Id\"] = message_id\nend\nif expected_last_message_id\n  headers[\"Nats-Expected-Last-Msg-Id\"] = expected_last_message_id\nend\nif expected_stream\n  headers[\"Nats-Expected-Stream\"] = expected_stream\nend\nif expected_last_sequence\n  headers[\"Nats-Expected-Last-Sequence\"] = expected_last_sequence\nend\nif expected_last_subject_sequence\n  headers[\"Nats-Expected-Last-Subject-Sequence\"] = expected_last_subject_sequence.to_s\nend\n\nif response = @nats.request(subject, body, timeout: timeout, headers: headers)\n  (PubAck | ErrorResponse).from_json(String.new(response.body))\nend\n"},"external_var":false},{"html_id":"pull_each(consumer:Consumer,*,batch_size:Int,&):Nil-instance-method","name":"pull_each","summary":"<p><span class=\"flag lime\">EXPERIMENTAL</span>  NATS JetStream pull subscriptions may be unstable</p>","abstract":false,"args":[{"name":"consumer","external_name":"consumer","restriction":"Consumer"},{"name":"","external_name":"","restriction":""},{"name":"batch_size","external_name":"batch_size","restriction":"Int"}],"args_string":"(consumer : Consumer, *, batch_size : Int, &) : Nil","args_html":"(consumer : <a href=\"../../NATS/JetStream/Consumer.html\">Consumer</a>, *, batch_size : Int, &) : Nil","location":{"filename":"src/jetstream/client.cr","line_number":96,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/client.cr#L96"},"def":{"name":"pull_each","args":[{"name":"consumer","external_name":"consumer","restriction":"Consumer"},{"name":"","external_name":"","restriction":""},{"name":"batch_size","external_name":"batch_size","restriction":"Int"}],"splat_index":1,"yields":2,"block_arity":2,"return_type":"Nil","visibility":"Public","body":"pull_subscribe(consumer, batch_size: batch_size) do |msgs, pull|\n  msgs.each do |msg|\n    yield msg, pull\n  end\nend"},"external_var":false},{"html_id":"pull_subscribe(consumer:Consumer,*,batch_size:Int,&):Nil-instance-method","name":"pull_subscribe","summary":"<p><span class=\"flag lime\">EXPERIMENTAL</span>  NATS JetStream pull subscriptions may be unstable</p>","abstract":false,"args":[{"name":"consumer","external_name":"consumer","restriction":"Consumer"},{"name":"","external_name":"","restriction":""},{"name":"batch_size","external_name":"batch_size","restriction":"Int"}],"args_string":"(consumer : Consumer, *, batch_size : Int, &) : Nil","args_html":"(consumer : <a href=\"../../NATS/JetStream/Consumer.html\">Consumer</a>, *, batch_size : Int, &) : Nil","location":{"filename":"src/jetstream/client.cr","line_number":103,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/client.cr#L103"},"def":{"name":"pull_subscribe","args":[{"name":"consumer","external_name":"consumer","restriction":"Consumer"},{"name":"","external_name":"","restriction":""},{"name":"batch_size","external_name":"batch_size","restriction":"Int"}],"splat_index":1,"yields":2,"block_arity":2,"return_type":"Nil","visibility":"Public","body":"pull = pull_subscribe(consumer, backlog: batch_size)\nwhile !pull.closed?\n  yield pull.fetch(batch_size), pull\nend\n"},"external_var":false},{"html_id":"pull_subscribe(consumer:Consumer,backlog:Int=64)-instance-method","name":"pull_subscribe","summary":"<p><span class=\"flag lime\">EXPERIMENTAL</span>  NATS JetStream pull subscriptions may be unstable</p>","abstract":false,"args":[{"name":"consumer","external_name":"consumer","restriction":"Consumer"},{"name":"backlog","default_value":"64","external_name":"backlog","restriction":"Int"}],"args_string":"(consumer : Consumer, backlog : Int = 64)","args_html":"(consumer : <a href=\"../../NATS/JetStream/Consumer.html\">Consumer</a>, backlog : Int = <span class=\"n\">64</span>)","location":{"filename":"src/jetstream/client.cr","line_number":111,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/client.cr#L111"},"def":{"name":"pull_subscribe","args":[{"name":"consumer","external_name":"consumer","restriction":"Consumer"},{"name":"backlog","default_value":"64","external_name":"backlog","restriction":"Int"}],"visibility":"Public","body":"if consumer.config.deliver_subject\n  raise(ArgumentError.new(\"Cannot set up a pull-based subscription to a push-based consumer: #{consumer.name.inspect} on stream #{consumer.stream_name.inspect}\"))\nend\n\nPullSubscription.new(consumer, @nats)\n"},"external_var":false},{"html_id":"stream-instance-method","name":"stream","doc":"Returns an `API::Stream` instance to interact with the NATS JetStream\nAPI for streams.","summary":"<p>Returns an <code>API::Stream</code> instance to interact with the NATS JetStream API for streams.</p>","abstract":false,"location":{"filename":"src/jetstream/client.cr","line_number":18,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/client.cr#L18"},"def":{"name":"stream","visibility":"Public","body":"Streams.new(@nats)"},"external_var":false},{"html_id":"subscribe(consumer:JetStream::Consumer,&block:Message->)-instance-method","name":"subscribe","doc":"Subscribe to messages delivered to the given consumer. Note that this\nconsumer _must_ be a push-based consumer. Pull-based consumers do not\nallow subscriptions because you must explicitly request the next\nmessage.\n\n```\njs = nats.jetstream\nconsumer = js.consumer.info(\"orders\", \"fulfillment\")\njs.subscribe consumer do |msg|\n  # ...\n\n  js.ack msg\nend\n```","summary":"<p>Subscribe to messages delivered to the given consumer.</p>","abstract":false,"args":[{"name":"consumer","external_name":"consumer","restriction":"JetStream::Consumer"}],"args_string":"(consumer : JetStream::Consumer, &block : Message -> )","args_html":"(consumer : <a href=\"../../NATS/JetStream/Consumer.html\">JetStream::Consumer</a>, &block : <a href=\"../../NATS/JetStream/Message.html\">Message</a> -> )","location":{"filename":"src/jetstream/client.cr","line_number":64,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/client.cr#L64"},"def":{"name":"subscribe","args":[{"name":"consumer","external_name":"consumer","restriction":"JetStream::Consumer"}],"yields":1,"block_arity":1,"block_arg":{"name":"block","external_name":"block","restriction":"(Message ->)"},"visibility":"Public","body":"if subject = consumer.config.deliver_subject\n  subscribe(subject, queue_group: consumer.config.deliver_group, &block)\nelse\n  raise(ArgumentError.new(\"Consumer is not a push consumer (no `deliver_subject`)\"))\nend"},"external_var":false},{"html_id":"subscribe(subject:String,queue_group:String|Nil=nil,&block:Message->)-instance-method","name":"subscribe","doc":"Subscribe to the given subject with an optional queue group. This is\neffectively identical to `NATS::Client#subscribe`, but the message\nyielded to the block is a `NATS::JetStream::Message` instead of\na `NATS::Message`.\n\n```\njs = nats.jetstream\njs.subscribe \"orders.*\", queue_group: \"fulfillment\" do |msg|\n  # ...\n\n  js.ack msg\nend\n```\n\n_NOTE:_ If provided, the `queue_group` _must_ be the same as a `Consumer`'s `deliver_group` for NATS server 2.4.0 and above.","summary":"<p>Subscribe to the given subject with an optional queue group.</p>","abstract":false,"args":[{"name":"subject","external_name":"subject","restriction":"String"},{"name":"queue_group","default_value":"nil","external_name":"queue_group","restriction":"String | ::Nil"}],"args_string":"(subject : String, queue_group : String | Nil = nil, &block : Message -> )","args_html":"(subject : String, queue_group : String | Nil = <span class=\"n\">nil</span>, &block : <a href=\"../../NATS/JetStream/Message.html\">Message</a> -> )","location":{"filename":"src/jetstream/client.cr","line_number":87,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/client.cr#L87"},"def":{"name":"subscribe","args":[{"name":"subject","external_name":"subject","restriction":"String"},{"name":"queue_group","default_value":"nil","external_name":"queue_group","restriction":"String | ::Nil"}],"yields":1,"block_arity":1,"block_arg":{"name":"block","external_name":"block","restriction":"(Message ->)"},"visibility":"Public","body":"@nats.subscribe(subject, queue_group: queue_group) do |msg|\n  if (headers = msg.headers) && (headers[\"Status\"]? == \"100 Idle Heartbeat\")\n  else\n    block.call(Message.new(msg))\n  end\nend"},"external_var":false}]},{"html_id":"nats/NATS/JetStream/ClusterInfo","path":"NATS/JetStream/ClusterInfo.html","kind":"struct","full_name":"NATS::JetStream::ClusterInfo","name":"ClusterInfo","abstract":false,"superclass":{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},"ancestors":[{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/cluster_info.cr","line_number":5,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/cluster_info.cr#L5"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/jetstream/cluster_info.cr","line_number":5,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/cluster_info.cr#L5"},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"},"external_var":false}],"instance_methods":[{"html_id":"leader:String|Nil-instance-method","name":"leader","abstract":false,"location":{"filename":"src/jetstream/cluster_info.cr","line_number":7,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/cluster_info.cr#L7"},"def":{"name":"leader","return_type":"String | ::Nil","visibility":"Public","body":"@leader"},"external_var":false},{"html_id":"name:String|Nil-instance-method","name":"name","abstract":false,"location":{"filename":"src/jetstream/cluster_info.cr","line_number":6,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/cluster_info.cr#L6"},"def":{"name":"name","return_type":"String | ::Nil","visibility":"Public","body":"@name"},"external_var":false},{"html_id":"replicas:Array(PeerInfo)-instance-method","name":"replicas","abstract":false,"location":{"filename":"src/jetstream/cluster_info.cr","line_number":8,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/cluster_info.cr#L8"},"def":{"name":"replicas","return_type":"Array(PeerInfo)","visibility":"Public","body":"if (__temp_162 = @replicas).nil?\n  @replicas = ([] of PeerInfo)\nelse\n  __temp_162\nend"},"external_var":false}]},{"html_id":"nats/NATS/JetStream/Consumer","path":"NATS/JetStream/Consumer.html","kind":"struct","full_name":"NATS::JetStream::Consumer","name":"Consumer","abstract":false,"superclass":{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},"ancestors":[{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/consumer.cr","line_number":6,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer.cr#L6"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/jetstream/consumer.cr","line_number":6,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer.cr#L6"},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"},"external_var":false}],"instance_methods":[{"html_id":"ack_floor:Sequence-instance-method","name":"ack_floor","doc":"The number of messages that have been acknowledged for this consumer/stream","summary":"<p>The number of messages that have been acknowledged for this consumer/stream</p>","abstract":false,"location":{"filename":"src/jetstream/consumer.cr","line_number":23,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer.cr#L23"},"def":{"name":"ack_floor","return_type":"Sequence","visibility":"Public","body":"@ack_floor"},"external_var":false},{"html_id":"cluster:ClusterInfo|Nil-instance-method","name":"cluster","doc":"Where this consumer's data lives in the cluster","summary":"<p>Where this consumer's data lives in the cluster</p>","abstract":false,"location":{"filename":"src/jetstream/consumer.cr","line_number":38,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer.cr#L38"},"def":{"name":"cluster","return_type":"ClusterInfo | ::Nil","visibility":"Public","body":"@cluster"},"external_var":false},{"html_id":"config:ConsumerConfig-instance-method","name":"config","doc":"The configuration used to create this consumer (including its defaults)","summary":"<p>The configuration used to create this consumer (including its defaults)</p>","abstract":false,"location":{"filename":"src/jetstream/consumer.cr","line_number":17,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer.cr#L17"},"def":{"name":"config","return_type":"ConsumerConfig","visibility":"Public","body":"@config"},"external_var":false},{"html_id":"created:Time-instance-method","name":"created","doc":"The timestamp when this consumer was created","summary":"<p>The timestamp when this consumer was created</p>","abstract":false,"location":{"filename":"src/jetstream/consumer.cr","line_number":14,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer.cr#L14"},"def":{"name":"created","return_type":"Time","visibility":"Public","body":"@created"},"external_var":false},{"html_id":"delivered:Sequence-instance-method","name":"delivered","doc":"The number of times this consumer has delivered messages for this stream","summary":"<p>The number of times this consumer has delivered messages for this stream</p>","abstract":false,"location":{"filename":"src/jetstream/consumer.cr","line_number":20,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer.cr#L20"},"def":{"name":"delivered","return_type":"Sequence","visibility":"Public","body":"@delivered"},"external_var":false},{"html_id":"name:String-instance-method","name":"name","doc":"The name of this consumer","summary":"<p>The name of this consumer</p>","abstract":false,"location":{"filename":"src/jetstream/consumer.cr","line_number":11,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer.cr#L11"},"def":{"name":"name","return_type":"String","visibility":"Public","body":"@name"},"external_var":false},{"html_id":"num_ack_pending:Int64-instance-method","name":"num_ack_pending","doc":"The number of messages currently in-flight that are awaiting acknowledgement","summary":"<p>The number of messages currently in-flight that are awaiting acknowledgement</p>","abstract":false,"location":{"filename":"src/jetstream/consumer.cr","line_number":26,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer.cr#L26"},"def":{"name":"num_ack_pending","return_type":"Int64","visibility":"Public","body":"@num_ack_pending"},"external_var":false},{"html_id":"num_pending:Int64-instance-method","name":"num_pending","doc":"The number of messages in the stream that this consumer has not delivered at all yet","summary":"<p>The number of messages in the stream that this consumer has not delivered at all yet</p>","abstract":false,"location":{"filename":"src/jetstream/consumer.cr","line_number":35,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer.cr#L35"},"def":{"name":"num_pending","return_type":"Int64","visibility":"Public","body":"@num_pending"},"external_var":false},{"html_id":"num_redelivered:Int64-instance-method","name":"num_redelivered","doc":"The number of messages that have been redelivered","summary":"<p>The number of messages that have been redelivered</p>","abstract":false,"location":{"filename":"src/jetstream/consumer.cr","line_number":29,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer.cr#L29"},"def":{"name":"num_redelivered","return_type":"Int64","visibility":"Public","body":"@num_redelivered"},"external_var":false},{"html_id":"num_waiting:Int64-instance-method","name":"num_waiting","doc":"The number of messages that are currently waiting","summary":"<p>The number of messages that are currently waiting</p>","abstract":false,"location":{"filename":"src/jetstream/consumer.cr","line_number":32,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer.cr#L32"},"def":{"name":"num_waiting","return_type":"Int64","visibility":"Public","body":"@num_waiting"},"external_var":false},{"html_id":"push_bound?:Bool-instance-method","name":"push_bound?","abstract":false,"location":{"filename":"src/jetstream/consumer.cr","line_number":40,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer.cr#L40"},"def":{"name":"push_bound?","return_type":"Bool","visibility":"Public","body":"@push_bound"},"external_var":false},{"html_id":"stream_name:String-instance-method","name":"stream_name","doc":"The name of the stream this consumer sources its messages from","summary":"<p>The name of the stream this consumer sources its messages from</p>","abstract":false,"location":{"filename":"src/jetstream/consumer.cr","line_number":8,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer.cr#L8"},"def":{"name":"stream_name","return_type":"String","visibility":"Public","body":"@stream_name"},"external_var":false}],"types":[{"html_id":"nats/NATS/JetStream/Consumer/Sequence","path":"NATS/JetStream/Consumer/Sequence.html","kind":"struct","full_name":"NATS::JetStream::Consumer::Sequence","name":"Sequence","abstract":false,"superclass":{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},"ancestors":[{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/consumer.cr","line_number":44,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer.cr#L44"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream/Consumer","kind":"struct","full_name":"NATS::JetStream::Consumer","name":"Consumer"},"doc":"The sequence represense a cursor for how many messages have been\ndelivered or acknowledged for this consumer and stream.","summary":"<p>The sequence represense a cursor for how many messages have been delivered or acknowledged for this consumer and stream.</p>","constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","doc":"The sequence represense a cursor for how many messages have been\ndelivered or acknowledged for this consumer and stream.","summary":"<p>The sequence represense a cursor for how many messages have been delivered or acknowledged for this consumer and stream.</p>","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/jetstream/consumer.cr","line_number":44,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer.cr#L44"},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"},"external_var":false}],"instance_methods":[{"html_id":"consumer_seq:Int64-instance-method","name":"consumer_seq","abstract":false,"location":{"filename":"src/jetstream/consumer.cr","line_number":45,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer.cr#L45"},"def":{"name":"consumer_seq","return_type":"Int64","visibility":"Public","body":"@consumer_seq"},"external_var":false},{"html_id":"stream_seq:Int64-instance-method","name":"stream_seq","abstract":false,"location":{"filename":"src/jetstream/consumer.cr","line_number":46,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer.cr#L46"},"def":{"name":"stream_seq","return_type":"Int64","visibility":"Public","body":"@stream_seq"},"external_var":false}]}]},{"html_id":"nats/NATS/JetStream/ConsumerConfig","path":"NATS/JetStream/ConsumerConfig.html","kind":"struct","full_name":"NATS::JetStream::ConsumerConfig","name":"ConsumerConfig","abstract":false,"superclass":{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},"ancestors":[{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/consumer_config.cr","line_number":4,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L4"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/jetstream/consumer_config.cr","line_number":4,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L4"},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"},"external_var":false},{"html_id":"new(deliver_subject:Nil|String=nil,durable_name:Nil|String=nil,ack_policy:AckPolicy=:explicit,deliver_policy:DeliverPolicy=:all,replay_policy:ReplayPolicy=:instant,ack_wait:Time::Span|Nil=nil,filter_subject:Nil|String=nil,max_deliver=nil,opt_start_seq:Int64|Nil=nil,sample_frequency:Nil|String=nil,opt_start_time:Time|Nil=nil,rate_limit_bps:UInt64|Nil=nil,max_ack_pending:Int|Nil=nil,max_waiting:Int|Nil=nil,idle_heartbeat:Time::Span|Nil=nil,flow_control:Bool|Nil=nil,deliver_group:Nil|String=durable_name,max_request_batch:Int32|Nil=nil,max_request_expires:Time::Span|Nil=nil,max_request_max_bytes:Int32|Nil=nil,replicas:Int32=0,memory_storage:Bool|Nil=nil,inactive_threshold:Time::Span|Nil=nil)-class-method","name":"new","abstract":false,"args":[{"name":"deliver_subject","default_value":"nil","external_name":"deliver_subject","restriction":"::Nil | ::String"},{"name":"durable_name","default_value":"nil","external_name":"durable_name","restriction":"::Nil | ::String"},{"name":"ack_policy","default_value":":explicit","external_name":"ack_policy","restriction":"AckPolicy"},{"name":"deliver_policy","default_value":":all","external_name":"deliver_policy","restriction":"DeliverPolicy"},{"name":"replay_policy","default_value":":instant","external_name":"replay_policy","restriction":"ReplayPolicy"},{"name":"ack_wait","default_value":"nil","external_name":"ack_wait","restriction":"::Time::Span | ::Nil"},{"name":"filter_subject","default_value":"nil","external_name":"filter_subject","restriction":"::Nil | ::String"},{"name":"max_deliver","default_value":"nil","external_name":"max_deliver","restriction":""},{"name":"opt_start_seq","default_value":"nil","external_name":"opt_start_seq","restriction":"::Int64 | ::Nil"},{"name":"sample_frequency","default_value":"nil","external_name":"sample_frequency","restriction":"::Nil | ::String"},{"name":"opt_start_time","default_value":"nil","external_name":"opt_start_time","restriction":"::Time | ::Nil"},{"name":"rate_limit_bps","default_value":"nil","external_name":"rate_limit_bps","restriction":"::UInt64 | ::Nil"},{"name":"max_ack_pending","default_value":"nil","external_name":"max_ack_pending","restriction":"Int | ::Nil"},{"name":"max_waiting","default_value":"nil","external_name":"max_waiting","restriction":"Int | ::Nil"},{"name":"idle_heartbeat","default_value":"nil","external_name":"idle_heartbeat","restriction":"::Time::Span | ::Nil"},{"name":"flow_control","default_value":"nil","external_name":"flow_control","restriction":"::Bool | ::Nil"},{"name":"deliver_group","default_value":"durable_name","external_name":"deliver_group","restriction":"::Nil | ::String"},{"name":"max_request_batch","default_value":"nil","external_name":"max_request_batch","restriction":"::Int32 | ::Nil"},{"name":"max_request_expires","default_value":"nil","external_name":"max_request_expires","restriction":"::Time::Span | ::Nil"},{"name":"max_request_max_bytes","default_value":"nil","external_name":"max_request_max_bytes","restriction":"::Int32 | ::Nil"},{"name":"replicas","default_value":"0","external_name":"replicas","restriction":"::Int32"},{"name":"memory_storage","default_value":"nil","external_name":"memory_storage","restriction":"::Bool | ::Nil"},{"name":"inactive_threshold","default_value":"nil","external_name":"inactive_threshold","restriction":"::Time::Span | ::Nil"}],"args_string":"(deliver_subject : Nil | String = nil, durable_name : Nil | String = nil, ack_policy : AckPolicy = :explicit, deliver_policy : DeliverPolicy = :all, replay_policy : ReplayPolicy = :instant, ack_wait : Time::Span | Nil = nil, filter_subject : Nil | String = nil, max_deliver = nil, opt_start_seq : Int64 | Nil = nil, sample_frequency : Nil | String = nil, opt_start_time : Time | Nil = nil, rate_limit_bps : UInt64 | Nil = nil, max_ack_pending : Int | Nil = nil, max_waiting : Int | Nil = nil, idle_heartbeat : Time::Span | Nil = nil, flow_control : Bool | Nil = nil, deliver_group : Nil | String = durable_name, max_request_batch : Int32 | Nil = nil, max_request_expires : Time::Span | Nil = nil, max_request_max_bytes : Int32 | Nil = nil, replicas : Int32 = 0, memory_storage : Bool | Nil = nil, inactive_threshold : Time::Span | Nil = nil)","args_html":"(deliver_subject : Nil | String = <span class=\"n\">nil</span>, durable_name : Nil | String = <span class=\"n\">nil</span>, ack_policy : <a href=\"../../NATS/JetStream/ConsumerConfig/AckPolicy.html\">AckPolicy</a> = <span class=\"n\">:explicit</span>, deliver_policy : <a href=\"../../NATS/JetStream/ConsumerConfig/DeliverPolicy.html\">DeliverPolicy</a> = <span class=\"n\">:all</span>, replay_policy : <a href=\"../../NATS/JetStream/ConsumerConfig/ReplayPolicy.html\">ReplayPolicy</a> = <span class=\"n\">:instant</span>, ack_wait : Time::Span | Nil = <span class=\"n\">nil</span>, filter_subject : Nil | String = <span class=\"n\">nil</span>, max_deliver = <span class=\"n\">nil</span>, opt_start_seq : Int64 | Nil = <span class=\"n\">nil</span>, sample_frequency : Nil | String = <span class=\"n\">nil</span>, opt_start_time : Time | Nil = <span class=\"n\">nil</span>, rate_limit_bps : UInt64 | Nil = <span class=\"n\">nil</span>, max_ack_pending : Int | Nil = <span class=\"n\">nil</span>, max_waiting : Int | Nil = <span class=\"n\">nil</span>, idle_heartbeat : Time::Span | Nil = <span class=\"n\">nil</span>, flow_control : Bool | Nil = <span class=\"n\">nil</span>, deliver_group : Nil | String = durable_name, max_request_batch : Int32 | Nil = <span class=\"n\">nil</span>, max_request_expires : Time::Span | Nil = <span class=\"n\">nil</span>, max_request_max_bytes : Int32 | Nil = <span class=\"n\">nil</span>, replicas : Int32 = <span class=\"n\">0</span>, memory_storage : Bool | Nil = <span class=\"n\">nil</span>, inactive_threshold : Time::Span | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/jetstream/consumer_config.cr","line_number":67,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L67"},"def":{"name":"new","args":[{"name":"deliver_subject","default_value":"nil","external_name":"deliver_subject","restriction":"::Nil | ::String"},{"name":"durable_name","default_value":"nil","external_name":"durable_name","restriction":"::Nil | ::String"},{"name":"ack_policy","default_value":":explicit","external_name":"ack_policy","restriction":"AckPolicy"},{"name":"deliver_policy","default_value":":all","external_name":"deliver_policy","restriction":"DeliverPolicy"},{"name":"replay_policy","default_value":":instant","external_name":"replay_policy","restriction":"ReplayPolicy"},{"name":"ack_wait","default_value":"nil","external_name":"ack_wait","restriction":"::Time::Span | ::Nil"},{"name":"filter_subject","default_value":"nil","external_name":"filter_subject","restriction":"::Nil | ::String"},{"name":"max_deliver","default_value":"nil","external_name":"max_deliver","restriction":""},{"name":"opt_start_seq","default_value":"nil","external_name":"opt_start_seq","restriction":"::Int64 | ::Nil"},{"name":"sample_frequency","default_value":"nil","external_name":"sample_frequency","restriction":"::Nil | ::String"},{"name":"opt_start_time","default_value":"nil","external_name":"opt_start_time","restriction":"::Time | ::Nil"},{"name":"rate_limit_bps","default_value":"nil","external_name":"rate_limit_bps","restriction":"::UInt64 | ::Nil"},{"name":"max_ack_pending","default_value":"nil","external_name":"max_ack_pending","restriction":"Int | ::Nil"},{"name":"max_waiting","default_value":"nil","external_name":"max_waiting","restriction":"Int | ::Nil"},{"name":"idle_heartbeat","default_value":"nil","external_name":"idle_heartbeat","restriction":"::Time::Span | ::Nil"},{"name":"flow_control","default_value":"nil","external_name":"flow_control","restriction":"::Bool | ::Nil"},{"name":"deliver_group","default_value":"durable_name","external_name":"deliver_group","restriction":"::Nil | ::String"},{"name":"max_request_batch","default_value":"nil","external_name":"max_request_batch","restriction":"::Int32 | ::Nil"},{"name":"max_request_expires","default_value":"nil","external_name":"max_request_expires","restriction":"::Time::Span | ::Nil"},{"name":"max_request_max_bytes","default_value":"nil","external_name":"max_request_max_bytes","restriction":"::Int32 | ::Nil"},{"name":"replicas","default_value":"0","external_name":"replicas","restriction":"::Int32"},{"name":"memory_storage","default_value":"nil","external_name":"memory_storage","restriction":"::Bool | ::Nil"},{"name":"inactive_threshold","default_value":"nil","external_name":"inactive_threshold","restriction":"::Time::Span | ::Nil"}],"visibility":"Public","body":"_ = allocate\n_.initialize(deliver_subject, durable_name, ack_policy, deliver_policy, replay_policy, ack_wait, filter_subject, max_deliver, opt_start_seq, sample_frequency, opt_start_time, rate_limit_bps, max_ack_pending, max_waiting, idle_heartbeat, flow_control, deliver_group, max_request_batch, max_request_expires, max_request_max_bytes, replicas, memory_storage, inactive_threshold)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"ack_policy:AckPolicy-instance-method","name":"ack_policy","doc":"How messages should be acknowledged: none, all, or explicit","summary":"<p>How messages should be acknowledged: none, all, or explicit</p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":6,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L6"},"def":{"name":"ack_policy","return_type":"AckPolicy","visibility":"Public","body":"@ack_policy"},"external_var":false},{"html_id":"ack_wait:Time::Span|Nil-instance-method","name":"ack_wait","doc":"How long to allow messages to remain un-acknowledged before attempting redelivery","summary":"<p>How long to allow messages to remain un-acknowledged before attempting redelivery</p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":9,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L9"},"def":{"name":"ack_wait","return_type":"Time::Span | ::Nil","visibility":"Public","body":"@ack_wait"},"external_var":false},{"html_id":"deliver_group:String|Nil-instance-method","name":"deliver_group","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":17,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L17"},"def":{"name":"deliver_group","return_type":"String | ::Nil","visibility":"Public","body":"@deliver_group"},"external_var":false},{"html_id":"deliver_policy:DeliverPolicy-instance-method","name":"deliver_policy","doc":"The initial starting mode of the consumer: all, last, new, by-start_sequence or by_start_time","summary":"<p>The initial starting mode of the consumer: all, last, new, by-start_sequence or by_start_time</p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":11,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L11"},"def":{"name":"deliver_policy","return_type":"DeliverPolicy","visibility":"Public","body":"@deliver_policy"},"external_var":false},{"html_id":"deliver_subject:String|Nil-instance-method","name":"deliver_subject","doc":"The subject to deliver observed messages, when not set, a pull-based Consumer is created","summary":"<p>The subject to deliver observed messages, when not set, a pull-based Consumer is created</p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":13,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L13"},"def":{"name":"deliver_subject","return_type":"String | ::Nil","visibility":"Public","body":"@deliver_subject"},"external_var":false},{"html_id":"description:String|Nil-instance-method","name":"description","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":18,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L18"},"def":{"name":"description","return_type":"String | ::Nil","visibility":"Public","body":"@description"},"external_var":false},{"html_id":"durable_name:String|Nil-instance-method","name":"durable_name","doc":"The name of the Consumer, specifying this will persist the consumer to the NATS server","summary":"<p>The name of the Consumer, specifying this will persist the consumer to the NATS server</p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":15,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L15"},"def":{"name":"durable_name","return_type":"String | ::Nil","visibility":"Public","body":"@durable_name"},"external_var":false},{"html_id":"filter_subject:String|Nil-instance-method","name":"filter_subject","doc":"When consuming from a Stream with many subjects, or wildcards, select only a specific incoming subjects, supports wildcards","summary":"<p>When consuming from a Stream with many subjects, or wildcards, select only a specific incoming subjects, supports wildcards</p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":30,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L30"},"def":{"name":"filter_subject","return_type":"String | ::Nil","visibility":"Public","body":"@filter_subject"},"external_var":false},{"html_id":"flow_control?:Bool-instance-method","name":"flow_control?","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":22,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L22"},"def":{"name":"flow_control?","return_type":"Bool","visibility":"Public","body":"if (__temp_168 = @flow_control).nil?\n  @flow_control = (false)\nelse\n  __temp_168\nend"},"external_var":false},{"html_id":"headers_only?:Bool-instance-method","name":"headers_only?","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":23,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L23"},"def":{"name":"headers_only?","return_type":"Bool","visibility":"Public","body":"if (__temp_169 = @headers_only).nil?\n  @headers_only = (false)\nelse\n  __temp_169\nend"},"external_var":false},{"html_id":"idle_heartbeat:Time::Span|Nil-instance-method","name":"idle_heartbeat","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":21,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L21"},"def":{"name":"idle_heartbeat","return_type":"Time::Span | ::Nil","visibility":"Public","body":"@idle_heartbeat"},"external_var":false},{"html_id":"inactive_threshold:Time::Span|Nil-instance-method","name":"inactive_threshold","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":47,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L47"},"def":{"name":"inactive_threshold","return_type":"Time::Span | ::Nil","visibility":"Public","body":"@inactive_threshold"},"external_var":false},{"html_id":"max_ack_pending:Int64|Nil-instance-method","name":"max_ack_pending","doc":"The maximum number of messages without acknowledgement that can be outstanding, once this limit is reached message delivery will be suspended","summary":"<p>The maximum number of messages without acknowledgement that can be outstanding, once this limit is reached message delivery will be suspended</p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":44,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L44"},"def":{"name":"max_ack_pending","return_type":"Int64 | ::Nil","visibility":"Public","body":"@max_ack_pending"},"external_var":false},{"html_id":"max_deliver:Int64|Nil-instance-method","name":"max_deliver","doc":"Maximum number of times a message will be delivered via this consumer. Use this to avoid poison pills crashing all your services forever.","summary":"<p>Maximum number of times a message will be delivered via this consumer.</p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":32,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L32"},"def":{"name":"max_deliver","return_type":"Int64 | ::Nil","visibility":"Public","body":"@max_deliver"},"external_var":false},{"html_id":"max_request_batch:Int32|Nil-instance-method","name":"max_request_batch","doc":"// Pull based options.\nMaxRequestBatch    int           `json:\"max_batch,omitempty\"`\nMaxRequestExpires  time.Duration `json:\"max_expires,omitempty\"`\nMaxRequestMaxBytes int           `json:\"max_bytes,omitempty\"`\nThe maximum number of messages that can be requested from a pull consumer","summary":"<p>// Pull based options.</p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":60,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L60"},"def":{"name":"max_request_batch","return_type":"Int32 | ::Nil","visibility":"Public","body":"@max_request_batch"},"external_var":false},{"html_id":"max_request_expires:Time::Span|Nil-instance-method","name":"max_request_expires","doc":"The","summary":"<p>The</p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":63,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L63"},"def":{"name":"max_request_expires","return_type":"Time::Span | ::Nil","visibility":"Public","body":"@max_request_expires"},"external_var":false},{"html_id":"max_request_max_bytes:Int32|Nil-instance-method","name":"max_request_max_bytes","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":65,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L65"},"def":{"name":"max_request_max_bytes","return_type":"Int32 | ::Nil","visibility":"Public","body":"@max_request_max_bytes"},"external_var":false},{"html_id":"max_waiting:Int64|Nil-instance-method","name":"max_waiting","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":19,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L19"},"def":{"name":"max_waiting","return_type":"Int64 | ::Nil","visibility":"Public","body":"@max_waiting"},"external_var":false},{"html_id":"memory_storage?:Bool|Nil-instance-method","name":"memory_storage?","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":52,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L52"},"def":{"name":"memory_storage?","return_type":"Bool | ::Nil","visibility":"Public","body":"@memory_storage"},"external_var":false},{"html_id":"opt_start_seq:Int64|Nil-instance-method","name":"opt_start_seq","doc":"When first consuming messages from the Stream start at this particular message in the set","summary":"<p>When first consuming messages from the Stream start at this particular message in the set</p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":34,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L34"},"def":{"name":"opt_start_seq","return_type":"Int64 | ::Nil","visibility":"Public","body":"@opt_start_seq"},"external_var":false},{"html_id":"opt_start_time:Time|Nil-instance-method","name":"opt_start_time","doc":"OptStartTime\tWhen first consuming messages from the Stream start with messages on or after this time","summary":"<p>OptStartTime\tWhen first consuming messages from the Stream start with messages on or after this time</p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":36,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L36"},"def":{"name":"opt_start_time","return_type":"Time | ::Nil","visibility":"Public","body":"@opt_start_time"},"external_var":false},{"html_id":"rate_limit_bps:UInt64|Nil-instance-method","name":"rate_limit_bps","doc":"The rate of message delivery in bits per second","summary":"<p>The rate of message delivery in bits per second</p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":42,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L42"},"def":{"name":"rate_limit_bps","return_type":"UInt64 | ::Nil","visibility":"Public","body":"@rate_limit_bps"},"external_var":false},{"html_id":"replay_policy:ReplayPolicy-instance-method","name":"replay_policy","doc":"How messages are sent: `instant` (default) or `original`","summary":"<p>How messages are sent: <code>instant</code> (default) or <code>original</code></p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":38,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L38"},"def":{"name":"replay_policy","return_type":"ReplayPolicy","visibility":"Public","body":"@replay_policy"},"external_var":false},{"html_id":"replicas:Int32-instance-method","name":"replicas","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":50,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L50"},"def":{"name":"replicas","return_type":"Int32","visibility":"Public","body":"@replicas"},"external_var":false},{"html_id":"sample_frequency:String|Nil-instance-method","name":"sample_frequency","doc":"What percentage of acknowledgements should be samples for observability, 0-100","summary":"<p>What percentage of acknowledgements should be samples for observability, 0-100</p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":40,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L40"},"def":{"name":"sample_frequency","return_type":"String | ::Nil","visibility":"Public","body":"@sample_frequency"},"external_var":false}],"types":[{"html_id":"nats/NATS/JetStream/ConsumerConfig/AckPolicy","path":"NATS/JetStream/ConsumerConfig/AckPolicy.html","kind":"enum","full_name":"NATS::JetStream::ConsumerConfig::AckPolicy","name":"AckPolicy","abstract":false,"ancestors":[{"html_id":"nats/Enum","kind":"struct","full_name":"Enum","name":"Enum"},{"html_id":"nats/Comparable","kind":"module","full_name":"Comparable","name":"Comparable"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/consumer_config.cr","line_number":100,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L100"}],"repository_name":"nats","program":false,"enum":true,"alias":false,"const":false,"constants":[{"id":"None","name":"None","value":"0","doc":"No acknowledgements are required. All messages are considered\nacknowledged on delivery.","summary":"<p>No acknowledgements are required.</p>"},{"id":"All","name":"All","value":"1","doc":"Acknowledging a message acknowledges all messages that came before\nit.","summary":"<p>Acknowledging a message acknowledges all messages that came before it.</p>"},{"id":"Explicit","name":"Explicit","value":"2","doc":"Every message must be acknowledged individually. This is the\ndefault.","summary":"<p>Every message must be acknowledged individually.</p>"}],"namespace":{"html_id":"nats/NATS/JetStream/ConsumerConfig","kind":"struct","full_name":"NATS::JetStream::ConsumerConfig","name":"ConsumerConfig"},"doc":"The way this consumer expects messages to be acknowledged.\n\nSee [AckPolicy in the NATS server code](https://github.com/nats-io/nats-server/blob/3aa8e63b290ac4ba1c99193827b3f66ad5679904/server/consumer.go#L136-L143)","summary":"<p>The way this consumer expects messages to be acknowledged.</p>","instance_methods":[{"html_id":"all?-instance-method","name":"all?","doc":"Returns `true` if this enum value equals `All`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../../NATS/JetStream/ConsumerConfig/AckPolicy.html#All\">All</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":107,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L107"},"def":{"name":"all?","visibility":"Public","body":"self == All"},"external_var":false},{"html_id":"explicit?-instance-method","name":"explicit?","doc":"Returns `true` if this enum value equals `Explicit`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../../NATS/JetStream/ConsumerConfig/AckPolicy.html#Explicit\">Explicit</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":111,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L111"},"def":{"name":"explicit?","visibility":"Public","body":"self == Explicit"},"external_var":false},{"html_id":"none?-instance-method","name":"none?","doc":"Returns `true` if this enum value equals `None`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../../NATS/JetStream/ConsumerConfig/AckPolicy.html#None\">None</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":103,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L103"},"def":{"name":"none?","visibility":"Public","body":"self == None"},"external_var":false}]},{"html_id":"nats/NATS/JetStream/ConsumerConfig/DeliverPolicy","path":"NATS/JetStream/ConsumerConfig/DeliverPolicy.html","kind":"enum","full_name":"NATS::JetStream::ConsumerConfig::DeliverPolicy","name":"DeliverPolicy","abstract":false,"ancestors":[{"html_id":"nats/Enum","kind":"struct","full_name":"Enum","name":"Enum"},{"html_id":"nats/Comparable","kind":"module","full_name":"Comparable","name":"Comparable"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/consumer_config.cr","line_number":117,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L117"}],"repository_name":"nats","program":false,"enum":true,"alias":false,"const":false,"constants":[{"id":"All","name":"All","value":"0","doc":"Deliver _all_ messages from a stream via this consumer","summary":"<p>Deliver <em>all</em> messages from a stream via this consumer</p>"},{"id":"Last","name":"Last","value":"1","doc":"Start from the current last message in the stream when this\nconsumer was created","summary":"<p>Start from the current last message in the stream when this consumer was created</p>"},{"id":"New","name":"New","value":"2","doc":"Start _after_ the current last message in the stream when this\nconsumer was created. This is different from `Last` in that it\nwill not begin delivering messages until more are published.","summary":"<p>Start <em>after</em> the current last message in the stream when this consumer was created.</p>"},{"id":"ByStartSequence","name":"ByStartSequence","value":"3","doc":"Start delivery at the sequence in the stream denoted by\n`opt_start_seq`. `opt_start_seq` is _required_ when this\n`DeliverPolicy` is used.","summary":"<p>Start delivery at the sequence in the stream denoted by <code>opt_start_seq</code>.</p>"},{"id":"ByStartTime","name":"ByStartTime","value":"4","doc":"Start delivery at the first message whose `timestamp` is equal to\nor later than `opt_start_time`. `opt_start_time` is _required\nwhen this `DeliverPolicy` is used.","summary":"<p>Start delivery at the first message whose <code>timestamp</code> is equal to or later than <code>opt_start_time</code>.</p>"},{"id":"LastPerSubject","name":"LastPerSubject","value":"5","doc":"Similar to `Last`, but on a per-subject basis.","summary":"<p>Similar to <code><a href=\"../../../NATS/JetStream/ConsumerConfig/DeliverPolicy.html#Last\">Last</a></code>, but on a per-subject basis.</p>"},{"id":"Undefined","name":"Undefined","value":"6","doc":"If you've got this set, something's probably borked. This value\nonly exists in this client because [the server can send it](https://github.com/nats-io/nats-server/blob/3aa8e63b290ac4ba1c99193827b3f66ad5679904/server/consumer.go#L118-L119).","summary":"<p>If you've got this set, something's probably borked.</p>"}],"namespace":{"html_id":"nats/NATS/JetStream/ConsumerConfig","kind":"struct","full_name":"NATS::JetStream::ConsumerConfig","name":"ConsumerConfig"},"doc":"Where to begin consuming messages from a stream.\n\nSee [DeliverPolicy in the NATS server code](https://github.com/nats-io/nats-server/blob/3aa8e63b290ac4ba1c99193827b3f66ad5679904/server/consumer.go#L105-L120)","summary":"<p>Where to begin consuming messages from a stream.</p>","instance_methods":[{"html_id":"all?-instance-method","name":"all?","doc":"Returns `true` if this enum value equals `All`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../../NATS/JetStream/ConsumerConfig/DeliverPolicy.html#All\">All</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":119,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L119"},"def":{"name":"all?","visibility":"Public","body":"self == All"},"external_var":false},{"html_id":"by_start_sequence?-instance-method","name":"by_start_sequence?","doc":"Returns `true` if this enum value equals `ByStartSequence`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../../NATS/JetStream/ConsumerConfig/DeliverPolicy.html#ByStartSequence\">ByStartSequence</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":133,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L133"},"def":{"name":"by_start_sequence?","visibility":"Public","body":"self == ByStartSequence"},"external_var":false},{"html_id":"by_start_time?-instance-method","name":"by_start_time?","doc":"Returns `true` if this enum value equals `ByStartTime`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../../NATS/JetStream/ConsumerConfig/DeliverPolicy.html#ByStartTime\">ByStartTime</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":138,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L138"},"def":{"name":"by_start_time?","visibility":"Public","body":"self == ByStartTime"},"external_var":false},{"html_id":"last?-instance-method","name":"last?","doc":"Returns `true` if this enum value equals `Last`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../../NATS/JetStream/ConsumerConfig/DeliverPolicy.html#Last\">Last</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":123,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L123"},"def":{"name":"last?","visibility":"Public","body":"self == Last"},"external_var":false},{"html_id":"last_per_subject?-instance-method","name":"last_per_subject?","doc":"Returns `true` if this enum value equals `LastPerSubject`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../../NATS/JetStream/ConsumerConfig/DeliverPolicy.html#LastPerSubject\">LastPerSubject</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":141,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L141"},"def":{"name":"last_per_subject?","visibility":"Public","body":"self == LastPerSubject"},"external_var":false},{"html_id":"new?-instance-method","name":"new?","doc":"Returns `true` if this enum value equals `New`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../../NATS/JetStream/ConsumerConfig/DeliverPolicy.html#New\">New</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":128,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L128"},"def":{"name":"new?","visibility":"Public","body":"self == New"},"external_var":false},{"html_id":"undefined?-instance-method","name":"undefined?","doc":"Returns `true` if this enum value equals `Undefined`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../../NATS/JetStream/ConsumerConfig/DeliverPolicy.html#Undefined\">Undefined</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":145,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L145"},"def":{"name":"undefined?","visibility":"Public","body":"self == Undefined"},"external_var":false}]},{"html_id":"nats/NATS/JetStream/ConsumerConfig/ReplayPolicy","path":"NATS/JetStream/ConsumerConfig/ReplayPolicy.html","kind":"enum","full_name":"NATS::JetStream::ConsumerConfig::ReplayPolicy","name":"ReplayPolicy","abstract":false,"ancestors":[{"html_id":"nats/Enum","kind":"struct","full_name":"Enum","name":"Enum"},{"html_id":"nats/Comparable","kind":"module","full_name":"Comparable","name":"Comparable"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/consumer_config.cr","line_number":152,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L152"}],"repository_name":"nats","program":false,"enum":true,"alias":false,"const":false,"constants":[{"id":"Instant","name":"Instant","value":"0","doc":"Tells the NATS server to deliver messages immediately","summary":"<p>Tells the NATS server to deliver messages immediately</p>"},{"id":"Original","name":"Original","value":"1","doc":"Tells the NATS server to deliver messages at the rate they were\noriginally published.","summary":"<p>Tells the NATS server to deliver messages at the rate they were originally published.</p>"}],"namespace":{"html_id":"nats/NATS/JetStream/ConsumerConfig","kind":"struct","full_name":"NATS::JetStream::ConsumerConfig","name":"ConsumerConfig"},"doc":"A consumer's `replay_policy` is the pace at which to replay messages\nfrom a stream.\n\nSee [ReplayPolicy in the NATS server code](https://github.com/nats-io/nats-server/blob/3aa8e63b290ac4ba1c99193827b3f66ad5679904/server/consumer.go#L157-L162)","summary":"<p>A consumer's <code>replay_policy</code> is the pace at which to replay messages from a stream.</p>","instance_methods":[{"html_id":"instant?-instance-method","name":"instant?","doc":"Returns `true` if this enum value equals `Instant`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../../NATS/JetStream/ConsumerConfig/ReplayPolicy.html#Instant\">Instant</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":154,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L154"},"def":{"name":"instant?","visibility":"Public","body":"self == Instant"},"external_var":false},{"html_id":"original?-instance-method","name":"original?","doc":"Returns `true` if this enum value equals `Original`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../../NATS/JetStream/ConsumerConfig/ReplayPolicy.html#Original\">Original</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/consumer_config.cr","line_number":158,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_config.cr#L158"},"def":{"name":"original?","visibility":"Public","body":"self == Original"},"external_var":false}]}]},{"html_id":"nats/NATS/JetStream/ConsumerListResponse","path":"NATS/JetStream/ConsumerListResponse.html","kind":"struct","full_name":"NATS::JetStream::ConsumerListResponse","name":"ConsumerListResponse","abstract":false,"superclass":{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},"ancestors":[{"html_id":"nats/Enumerable","kind":"module","full_name":"Enumerable","name":"Enumerable"},{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/consumer_list_response.cr","line_number":5,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_list_response.cr#L5"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"included_modules":[{"html_id":"nats/Enumerable","kind":"module","full_name":"Enumerable","name":"Enumerable"}],"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/jetstream/consumer_list_response.cr","line_number":5,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_list_response.cr#L5"},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"},"external_var":false}],"instance_methods":[{"html_id":"consumers:Array(Consumer)-instance-method","name":"consumers","abstract":false,"location":{"filename":"src/jetstream/consumer_list_response.cr","line_number":11,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_list_response.cr#L11"},"def":{"name":"consumers","return_type":"Array(Consumer)","visibility":"Public","body":"@consumers"},"external_var":false},{"html_id":"each(&)-instance-method","name":"each","doc":"Must yield this collection's elements to the block.","summary":"<p>Must yield this collection's elements to the block.</p>","abstract":false,"location":{"filename":"src/jetstream/consumer_list_response.cr","line_number":13,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_list_response.cr#L13"},"def":{"name":"each","yields":1,"block_arity":1,"visibility":"Public","body":"consumers.each do |c|\n  yield c\nend"},"external_var":false},{"html_id":"limit:Int64-instance-method","name":"limit","abstract":false,"location":{"filename":"src/jetstream/consumer_list_response.cr","line_number":10,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_list_response.cr#L10"},"def":{"name":"limit","return_type":"Int64","visibility":"Public","body":"@limit"},"external_var":false},{"html_id":"offset:Int64-instance-method","name":"offset","abstract":false,"location":{"filename":"src/jetstream/consumer_list_response.cr","line_number":9,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_list_response.cr#L9"},"def":{"name":"offset","return_type":"Int64","visibility":"Public","body":"@offset"},"external_var":false},{"html_id":"total:Int64-instance-method","name":"total","abstract":false,"location":{"filename":"src/jetstream/consumer_list_response.cr","line_number":8,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumer_list_response.cr#L8"},"def":{"name":"total","return_type":"Int64","visibility":"Public","body":"@total"},"external_var":false}]},{"html_id":"nats/NATS/JetStream/Consumers","path":"NATS/JetStream/Consumers.html","kind":"struct","full_name":"NATS::JetStream::Consumers","name":"Consumers","abstract":false,"superclass":{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},"ancestors":[{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/consumers.cr","line_number":10,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumers.cr#L10"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"},"doc":"A NATS JetStream consumer is a message index sourced from a stream.\nIt can apply additional filters and records which messages are pending,\nacknowledged, etc, at the consumer layer.","summary":"<p>A NATS JetStream consumer is a message index sourced from a stream.</p>","constructors":[{"html_id":"new(nats:NATS::Client)-class-method","name":"new","abstract":false,"args":[{"name":"nats","external_name":"nats","restriction":"::NATS::Client"}],"args_string":"(nats : NATS::Client)","args_html":"(nats : <a href=\"../../NATS/Client.html\">NATS::Client</a>)","location":{"filename":"src/jetstream/consumers.cr","line_number":11,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumers.cr#L11"},"def":{"name":"new","args":[{"name":"nats","external_name":"nats","restriction":"::NATS::Client"}],"visibility":"Public","body":"_ = allocate\n_.initialize(nats)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"create(stream_name:String,deliver_policy:ConsumerConfig::DeliverPolicy=:all,ack_policy:ConsumerConfig::AckPolicy=:explicit,**properties):Consumer-instance-method","name":"create","doc":"Create a consumer for the given stream with the given properties,\nwhich are passed unmodified to `NATS::JetStream::Consumer.new`.","summary":"<p>Create a consumer for the given stream with the given properties, which are passed unmodified to <code><a href=\"../../NATS/JetStream/Consumer.html#new%28pull%3AJSON%3A%3APullParser%29-class-method\">NATS::JetStream::Consumer.new</a></code>.</p>","abstract":false,"args":[{"name":"stream_name","external_name":"stream_name","restriction":"String"},{"name":"deliver_policy","default_value":":all","external_name":"deliver_policy","restriction":"ConsumerConfig::DeliverPolicy"},{"name":"ack_policy","default_value":":explicit","external_name":"ack_policy","restriction":"ConsumerConfig::AckPolicy"}],"args_string":"(stream_name : String, deliver_policy : ConsumerConfig::DeliverPolicy = :all, ack_policy : ConsumerConfig::AckPolicy = :explicit, **properties) : Consumer","args_html":"(stream_name : String, deliver_policy : <a href=\"../../NATS/JetStream/ConsumerConfig/DeliverPolicy.html\">ConsumerConfig::DeliverPolicy</a> = <span class=\"n\">:all</span>, ack_policy : <a href=\"../../NATS/JetStream/ConsumerConfig/AckPolicy.html\">ConsumerConfig::AckPolicy</a> = <span class=\"n\">:explicit</span>, **properties) : <a href=\"../../NATS/JetStream/Consumer.html\">Consumer</a>","location":{"filename":"src/jetstream/consumers.cr","line_number":16,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumers.cr#L16"},"def":{"name":"create","args":[{"name":"stream_name","external_name":"stream_name","restriction":"String"},{"name":"deliver_policy","default_value":":all","external_name":"deliver_policy","restriction":"ConsumerConfig::DeliverPolicy"},{"name":"ack_policy","default_value":":explicit","external_name":"ack_policy","restriction":"ConsumerConfig::AckPolicy"}],"double_splat":{"name":"properties","external_name":"properties","restriction":""},"return_type":"Consumer","visibility":"Public","body":"consumer_config = ConsumerConfig.new(**properties, deliver_policy: deliver_policy, ack_policy: ack_policy)\ncreate_consumer = {stream_name: stream_name, config: consumer_config}\nif durable_name = consumer_config.durable_name\n  create_consumer_subject = \"$JS.API.CONSUMER.DURABLE.CREATE.#{stream_name}.#{durable_name}\"\nelse\n  name = @nats.nuid.next\n  create_consumer_subject = \"$JS.API.CONSUMER.CREATE.#{stream_name}.#{name}\"\nend\n\nif response = @nats.request(create_consumer_subject, create_consumer.to_json)\nelse\n  raise(Error.new(\"Did not receive a response from NATS JetStream\"))\nend\n\ncase parsed = (Consumer | ErrorResponse).from_json(String.new(response.body))\nin Consumer\n  parsed\nin ErrorResponse\n  raise(Error.new(\"#{parsed.error.description} (#{parsed.error.code})\"))\nend\n"},"external_var":false},{"html_id":"delete(stream:JetStream::Stream,consumer:JetStream::Consumer)-instance-method","name":"delete","doc":"Delete the given consumer for the given stream","summary":"<p>Delete the given consumer for the given stream</p>","abstract":false,"args":[{"name":"stream","external_name":"stream","restriction":"JetStream::Stream"},{"name":"consumer","external_name":"consumer","restriction":"JetStream::Consumer"}],"args_string":"(stream : JetStream::Stream, consumer : JetStream::Consumer)","args_html":"(stream : <a href=\"../../NATS/JetStream/Stream.html\">JetStream::Stream</a>, consumer : <a href=\"../../NATS/JetStream/Consumer.html\">JetStream::Consumer</a>)","location":{"filename":"src/jetstream/consumers.cr","line_number":99,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumers.cr#L99"},"def":{"name":"delete","args":[{"name":"stream","external_name":"stream","restriction":"JetStream::Stream"},{"name":"consumer","external_name":"consumer","restriction":"JetStream::Consumer"}],"visibility":"Public","body":"delete(stream.config.name, consumer.name)"},"external_var":false},{"html_id":"delete(stream:String,consumer:String)-instance-method","name":"delete","doc":"Delete the consumer with the given name associated with the stream\nwith the given name.","summary":"<p>Delete the consumer with the given name associated with the stream with the given name.</p>","abstract":false,"args":[{"name":"stream","external_name":"stream","restriction":"String"},{"name":"consumer","external_name":"consumer","restriction":"String"}],"args_string":"(stream : String, consumer : String)","args_html":"(stream : String, consumer : String)","location":{"filename":"src/jetstream/consumers.cr","line_number":105,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumers.cr#L105"},"def":{"name":"delete","args":[{"name":"stream","external_name":"stream","restriction":"String"},{"name":"consumer","external_name":"consumer","restriction":"String"}],"visibility":"Public","body":"@nats.request(\"$JS.API.CONSUMER.DELETE.#{stream}.#{consumer}\")"},"external_var":false},{"html_id":"delete(consumer:JetStream::Consumer)-instance-method","name":"delete","doc":"Delete the given consumer for the given stream","summary":"<p>Delete the given consumer for the given stream</p>","abstract":false,"args":[{"name":"consumer","external_name":"consumer","restriction":"JetStream::Consumer"}],"args_string":"(consumer : JetStream::Consumer)","args_html":"(consumer : <a href=\"../../NATS/JetStream/Consumer.html\">JetStream::Consumer</a>)","location":{"filename":"src/jetstream/consumers.cr","line_number":94,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumers.cr#L94"},"def":{"name":"delete","args":[{"name":"consumer","external_name":"consumer","restriction":"JetStream::Consumer"}],"visibility":"Public","body":"delete(consumer.stream_name, consumer.name)"},"external_var":false},{"html_id":"info(stream_name:String,name:String):Consumer|Nil-instance-method","name":"info","abstract":false,"args":[{"name":"stream_name","external_name":"stream_name","restriction":"String"},{"name":"name","external_name":"name","restriction":"String"}],"args_string":"(stream_name : String, name : String) : Consumer | Nil","args_html":"(stream_name : String, name : String) : <a href=\"../../NATS/JetStream/Consumer.html\">Consumer</a> | Nil","location":{"filename":"src/jetstream/consumers.cr","line_number":70,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumers.cr#L70"},"def":{"name":"info","args":[{"name":"stream_name","external_name":"stream_name","restriction":"String"},{"name":"name","external_name":"name","restriction":"String"}],"return_type":"Consumer | ::Nil","visibility":"Public","body":"info(stream_name, name) do\n  nil\nend"},"external_var":false},{"html_id":"info(stream_name:String,name:String,&)-instance-method","name":"info","doc":"Return the consumer with the specified `name` associated with the\ngiven stream, yielding to the block if the consumer does not exist","summary":"<p>Return the consumer with the specified <code>name</code> associated with the given stream, yielding to the block if the consumer does not exist</p>","abstract":false,"args":[{"name":"stream_name","external_name":"stream_name","restriction":"String"},{"name":"name","external_name":"name","restriction":"String"}],"args_string":"(stream_name : String, name : String, &)","args_html":"(stream_name : String, name : String, &)","location":{"filename":"src/jetstream/consumers.cr","line_number":76,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumers.cr#L76"},"def":{"name":"info","args":[{"name":"stream_name","external_name":"stream_name","restriction":"String"},{"name":"name","external_name":"name","restriction":"String"}],"yields":0,"block_arity":0,"visibility":"Public","body":"if consumer_response = @nats.request(\"$JS.API.CONSUMER.INFO.#{stream_name}.#{name}\")\n  case parsed = (Consumer | ErrorResponse).from_json(String.new(consumer_response.body))\n  in Consumer\n    parsed\n  in ErrorResponse\n    if parsed.error.err_code.consumer_not_found?\n      yield\n    else\n      raise(Error.new(parsed.error.description))\n    end\n  end\nelse\n  raise(\"no info for #{name.inspect} (stream #{stream_name.inspect})\")\nend"},"external_var":false},{"html_id":"info!(stream_name:String,name:String):Consumer-instance-method","name":"info!","doc":"Return the consumer with the specified `name` associated with the\ngiven stream, yielding to the block if the consumer does not exist","summary":"<p>Return the consumer with the specified <code>name</code> associated with the given stream, yielding to the block if the consumer does not exist</p>","abstract":false,"args":[{"name":"stream_name","external_name":"stream_name","restriction":"String"},{"name":"name","external_name":"name","restriction":"String"}],"args_string":"(stream_name : String, name : String) : Consumer","args_html":"(stream_name : String, name : String) : <a href=\"../../NATS/JetStream/Consumer.html\">Consumer</a>","location":{"filename":"src/jetstream/consumers.cr","line_number":64,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumers.cr#L64"},"def":{"name":"info!","args":[{"name":"stream_name","external_name":"stream_name","restriction":"String"},{"name":"name","external_name":"name","restriction":"String"}],"return_type":"Consumer","visibility":"Public","body":"info(stream_name, name) do\n  raise(ArgumentError.new(\"Consumer #{name.inspect} not found for stream #{stream_name.inspect}\"))\nend"},"external_var":false},{"html_id":"list(stream:JetStream::Stream)-instance-method","name":"list","doc":"Returns a paginated list of consumers for the specified stream.","summary":"<p>Returns a paginated list of consumers for the specified stream.</p>","abstract":false,"args":[{"name":"stream","external_name":"stream","restriction":"JetStream::Stream"}],"args_string":"(stream : JetStream::Stream)","args_html":"(stream : <a href=\"../../NATS/JetStream/Stream.html\">JetStream::Stream</a>)","location":{"filename":"src/jetstream/consumers.cr","line_number":48,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumers.cr#L48"},"def":{"name":"list","args":[{"name":"stream","external_name":"stream","restriction":"JetStream::Stream"}],"visibility":"Public","body":"list(stream.config.name)"},"external_var":false},{"html_id":"list(stream_name:String)-instance-method","name":"list","doc":"Returns a paginated list of consumers for the stream with the\nspecified name.","summary":"<p>Returns a paginated list of consumers for the stream with the specified name.</p>","abstract":false,"args":[{"name":"stream_name","external_name":"stream_name","restriction":"String"}],"args_string":"(stream_name : String)","args_html":"(stream_name : String)","location":{"filename":"src/jetstream/consumers.cr","line_number":54,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/consumers.cr#L54"},"def":{"name":"list","args":[{"name":"stream_name","external_name":"stream_name","restriction":"String"}],"visibility":"Public","body":"if consumers_response = @nats.request(\"$JS.API.CONSUMER.LIST.#{stream_name}\")\n  ConsumerListResponse.from_json(String.new(consumers_response.body))\nelse\n  raise(\"whoops\")\nend"},"external_var":false}]},{"html_id":"nats/NATS/JetStream/Entity","path":"NATS/JetStream/Entity.html","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity","abstract":true,"superclass":{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},"ancestors":[{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/entity.cr","line_number":2,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/entity.cr#L2"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"included_modules":[{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"}],"subclasses":[{"html_id":"nats/NATS/JetStream/APIError","kind":"struct","full_name":"NATS::JetStream::APIError","name":"APIError"},{"html_id":"nats/NATS/JetStream/ClusterInfo","kind":"struct","full_name":"NATS::JetStream::ClusterInfo","name":"ClusterInfo"},{"html_id":"nats/NATS/JetStream/Consumer","kind":"struct","full_name":"NATS::JetStream::Consumer","name":"Consumer"},{"html_id":"nats/NATS/JetStream/Consumer/Sequence","kind":"struct","full_name":"NATS::JetStream::Consumer::Sequence","name":"Sequence"},{"html_id":"nats/NATS/JetStream/ConsumerConfig","kind":"struct","full_name":"NATS::JetStream::ConsumerConfig","name":"ConsumerConfig"},{"html_id":"nats/NATS/JetStream/ConsumerListResponse","kind":"struct","full_name":"NATS::JetStream::ConsumerListResponse","name":"ConsumerListResponse"},{"html_id":"nats/NATS/JetStream/ExternalStream","kind":"struct","full_name":"NATS::JetStream::ExternalStream","name":"ExternalStream"},{"html_id":"nats/NATS/JetStream/PeerInfo","kind":"struct","full_name":"NATS::JetStream::PeerInfo","name":"PeerInfo"},{"html_id":"nats/NATS/JetStream/PubAck","kind":"struct","full_name":"NATS::JetStream::PubAck","name":"PubAck"},{"html_id":"nats/NATS/JetStream/Stream","kind":"struct","full_name":"NATS::JetStream::Stream","name":"Stream"},{"html_id":"nats/NATS/JetStream/StreamConfig","kind":"struct","full_name":"NATS::JetStream::StreamConfig","name":"StreamConfig"},{"html_id":"nats/NATS/JetStream/StreamConfig/Placement","kind":"struct","full_name":"NATS::JetStream::StreamConfig::Placement","name":"Placement"},{"html_id":"nats/NATS/JetStream/StreamConfig/Republish","kind":"struct","full_name":"NATS::JetStream::StreamConfig::Republish","name":"Republish"},{"html_id":"nats/NATS/JetStream/StreamGetMsgResponse","kind":"struct","full_name":"NATS::JetStream::StreamGetMsgResponse","name":"StreamGetMsgResponse"},{"html_id":"nats/NATS/JetStream/StreamGetMsgResponse/Message","kind":"struct","full_name":"NATS::JetStream::StreamGetMsgResponse::Message","name":"Message"},{"html_id":"nats/NATS/JetStream/StreamListResponse","kind":"struct","full_name":"NATS::JetStream::StreamListResponse","name":"StreamListResponse"},{"html_id":"nats/NATS/JetStream/StreamSource","kind":"struct","full_name":"NATS::JetStream::StreamSource","name":"StreamSource"},{"html_id":"nats/NATS/JetStream/StreamSourceInfo","kind":"struct","full_name":"NATS::JetStream::StreamSourceInfo","name":"StreamSourceInfo"},{"html_id":"nats/NATS/JetStream/StreamState","kind":"struct","full_name":"NATS::JetStream::StreamState","name":"StreamState"}],"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/jetstream/entity.cr","line_number":3,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/entity.cr#L3"},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"},"external_var":false}]},{"html_id":"nats/NATS/JetStream/Error","path":"NATS/JetStream/Error.html","kind":"class","full_name":"NATS::JetStream::Error","name":"Error","abstract":false,"superclass":{"html_id":"nats/NATS/Error","kind":"class","full_name":"NATS::Error","name":"Error"},"ancestors":[{"html_id":"nats/NATS/Error","kind":"class","full_name":"NATS::Error","name":"Error"},{"html_id":"nats/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/error.cr","line_number":4,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/error.cr#L4"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"}},{"html_id":"nats/NATS/JetStream/ErrorResponse","path":"NATS/JetStream/ErrorResponse.html","kind":"struct","full_name":"NATS::JetStream::ErrorResponse","name":"ErrorResponse","abstract":false,"superclass":{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},"ancestors":[{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/error_response.cr","line_number":5,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/error_response.cr#L5"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"included_modules":[{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"}],"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/jetstream/error_response.cr","line_number":6,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/error_response.cr#L6"},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"},"external_var":false}],"instance_methods":[{"html_id":"error:Error-instance-method","name":"error","abstract":false,"location":{"filename":"src/jetstream/error_response.cr","line_number":8,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/error_response.cr#L8"},"def":{"name":"error","return_type":"Error","visibility":"Public","body":"@error"},"external_var":false}],"types":[{"html_id":"nats/NATS/JetStream/ErrorResponse/Error","path":"NATS/JetStream/ErrorResponse/Error.html","kind":"struct","full_name":"NATS::JetStream::ErrorResponse::Error","name":"Error","abstract":false,"superclass":{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},"ancestors":[{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/error_response.cr","line_number":10,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/error_response.cr#L10"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"included_modules":[{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"}],"namespace":{"html_id":"nats/NATS/JetStream/ErrorResponse","kind":"struct","full_name":"NATS::JetStream::ErrorResponse","name":"ErrorResponse"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/jetstream/error_response.cr","line_number":11,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/error_response.cr#L11"},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"},"external_var":false}],"instance_methods":[{"html_id":"code:Int32-instance-method","name":"code","abstract":false,"location":{"filename":"src/jetstream/error_response.cr","line_number":13,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/error_response.cr#L13"},"def":{"name":"code","return_type":"Int32","visibility":"Public","body":"@code"},"external_var":false},{"html_id":"description:String-instance-method","name":"description","abstract":false,"location":{"filename":"src/jetstream/error_response.cr","line_number":15,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/error_response.cr#L15"},"def":{"name":"description","return_type":"String","visibility":"Public","body":"@description"},"external_var":false},{"html_id":"err_code:Errors-instance-method","name":"err_code","abstract":false,"location":{"filename":"src/jetstream/error_response.cr","line_number":14,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/error_response.cr#L14"},"def":{"name":"err_code","return_type":"Errors","visibility":"Public","body":"@err_code"},"external_var":false}]}]},{"html_id":"nats/NATS/JetStream/Errors","path":"NATS/JetStream/Errors.html","kind":"enum","full_name":"NATS::JetStream::Errors","name":"Errors","abstract":false,"ancestors":[{"html_id":"nats/Enum","kind":"struct","full_name":"Enum","name":"Enum"},{"html_id":"nats/Comparable","kind":"module","full_name":"Comparable","name":"Comparable"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/errors.cr","line_number":5,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/errors.cr#L5"}],"repository_name":"nats","program":false,"enum":true,"alias":false,"const":false,"constants":[{"id":"None","name":"None","value":"0"},{"id":"ConsumerNotFound","name":"ConsumerNotFound","value":"10014"},{"id":"NoMessageFound","name":"NoMessageFound","value":"10037"},{"id":"StreamNotFound","name":"StreamNotFound","value":"10059"},{"id":"StreamWrongLastSequence","name":"StreamWrongLastSequence","value":"10071"},{"id":"MaximumMessagesPerSubjectExceeded","name":"MaximumMessagesPerSubjectExceeded","value":"10077"}],"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"},"doc":"https://github.com/nats-io/nats-server/blob/main/server/errors.json","summary":"<p>https://github.com/nats-io/nats-server/blob/main/server/errors.json</p>","constructors":[{"html_id":"new(json:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"json","external_name":"json","restriction":"JSON::PullParser"}],"args_string":"(json : JSON::PullParser)","args_html":"(json : JSON::PullParser)","location":{"filename":"src/jetstream/errors.cr","line_number":13,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/errors.cr#L13"},"def":{"name":"new","args":[{"name":"json","external_name":"json","restriction":"JSON::PullParser"}],"visibility":"Public","body":"new(json.read_int.to_i)"},"external_var":false}],"instance_methods":[{"html_id":"consumer_not_found?-instance-method","name":"consumer_not_found?","doc":"Returns `true` if this enum value equals `ConsumerNotFound`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../NATS/JetStream/Errors.html#ConsumerNotFound\">ConsumerNotFound</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/errors.cr","line_number":7,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/errors.cr#L7"},"def":{"name":"consumer_not_found?","visibility":"Public","body":"self == ConsumerNotFound"},"external_var":false},{"html_id":"maximum_messages_per_subject_exceeded?-instance-method","name":"maximum_messages_per_subject_exceeded?","doc":"Returns `true` if this enum value equals `MaximumMessagesPerSubjectExceeded`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../NATS/JetStream/Errors.html#MaximumMessagesPerSubjectExceeded\">MaximumMessagesPerSubjectExceeded</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/errors.cr","line_number":11,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/errors.cr#L11"},"def":{"name":"maximum_messages_per_subject_exceeded?","visibility":"Public","body":"self == MaximumMessagesPerSubjectExceeded"},"external_var":false},{"html_id":"no_message_found?-instance-method","name":"no_message_found?","doc":"Returns `true` if this enum value equals `NoMessageFound`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../NATS/JetStream/Errors.html#NoMessageFound\">NoMessageFound</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/errors.cr","line_number":8,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/errors.cr#L8"},"def":{"name":"no_message_found?","visibility":"Public","body":"self == NoMessageFound"},"external_var":false},{"html_id":"none?-instance-method","name":"none?","doc":"Returns `true` if this enum value equals `None`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../NATS/JetStream/Errors.html#None\">None</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/errors.cr","line_number":6,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/errors.cr#L6"},"def":{"name":"none?","visibility":"Public","body":"self == None"},"external_var":false},{"html_id":"stream_not_found?-instance-method","name":"stream_not_found?","doc":"Returns `true` if this enum value equals `StreamNotFound`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../NATS/JetStream/Errors.html#StreamNotFound\">StreamNotFound</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/errors.cr","line_number":9,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/errors.cr#L9"},"def":{"name":"stream_not_found?","visibility":"Public","body":"self == StreamNotFound"},"external_var":false},{"html_id":"stream_wrong_last_sequence?-instance-method","name":"stream_wrong_last_sequence?","doc":"Returns `true` if this enum value equals `StreamWrongLastSequence`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../NATS/JetStream/Errors.html#StreamWrongLastSequence\">StreamWrongLastSequence</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/errors.cr","line_number":10,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/errors.cr#L10"},"def":{"name":"stream_wrong_last_sequence?","visibility":"Public","body":"self == StreamWrongLastSequence"},"external_var":false}]},{"html_id":"nats/NATS/JetStream/ExternalStream","path":"NATS/JetStream/ExternalStream.html","kind":"struct","full_name":"NATS::JetStream::ExternalStream","name":"ExternalStream","abstract":false,"superclass":{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},"ancestors":[{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/external_stream.cr","line_number":5,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/external_stream.cr#L5"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/jetstream/external_stream.cr","line_number":5,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/external_stream.cr#L5"},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"},"external_var":false},{"html_id":"new(*,api_prefix:String=\"\",deliver_prefix:String=\"\")-class-method","name":"new","abstract":false,"args":[{"name":"","external_name":"","restriction":""},{"name":"api_prefix","default_value":"\"\"","external_name":"api_prefix","restriction":"::String"},{"name":"deliver_prefix","default_value":"\"\"","external_name":"deliver_prefix","restriction":"::String"}],"args_string":"(*, api_prefix : String = \"\", deliver_prefix : String = \"\")","args_html":"(*, api_prefix : String = <span class=\"s\">&quot;&quot;</span>, deliver_prefix : String = <span class=\"s\">&quot;&quot;</span>)","location":{"filename":"src/jetstream/external_stream.cr","line_number":11,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/external_stream.cr#L11"},"def":{"name":"new","args":[{"name":"","external_name":"","restriction":""},{"name":"api_prefix","default_value":"\"\"","external_name":"api_prefix","restriction":"::String"},{"name":"deliver_prefix","default_value":"\"\"","external_name":"deliver_prefix","restriction":"::String"}],"splat_index":0,"visibility":"Public","body":"_ = allocate\n_.initialize(api_prefix: api_prefix, deliver_prefix: deliver_prefix)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"api_prefix:String-instance-method","name":"api_prefix","abstract":false,"location":{"filename":"src/jetstream/external_stream.cr","line_number":7,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/external_stream.cr#L7"},"def":{"name":"api_prefix","return_type":"String","visibility":"Public","body":"@api_prefix"},"external_var":false},{"html_id":"deliver_prefix:String-instance-method","name":"deliver_prefix","abstract":false,"location":{"filename":"src/jetstream/external_stream.cr","line_number":9,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/external_stream.cr#L9"},"def":{"name":"deliver_prefix","return_type":"String","visibility":"Public","body":"@deliver_prefix"},"external_var":false}]},{"html_id":"nats/NATS/JetStream/Message","path":"NATS/JetStream/Message.html","kind":"struct","full_name":"NATS::JetStream::Message","name":"Message","abstract":false,"superclass":{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},"ancestors":[{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/message.cr","line_number":9,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/message.cr#L9"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"},"doc":"A `NATS::JetStream::Message` is very similar to a `NATS::Message` in that\nit represents a piece of information published by a NATS client (not\nnecessarily _this_ NATS client, though). This `Message` type contains more\ninformation, however, such as information about the stream and consumer\nit came from, how many times it's been delivered, etc.","summary":"<p>A <code><a href=\"../../NATS/JetStream/Message.html\">NATS::JetStream::Message</a></code> is very similar to a <code><a href=\"../../NATS/Message.html\">NATS::Message</a></code> in that it represents a piece of information published by a NATS client (not necessarily <em>this</em> NATS client, though).</p>","constructors":[{"html_id":"new(stream:String,consumer:String,delivered_count:Int64,stream_seq:Int64,consumer_seq:Int64,timestamp:Time,pending:Int64,body:Slice(UInt8),subject:String,reply_to:String,headers:Nil|Hash(String,String))-class-method","name":"new","abstract":false,"args":[{"name":"stream","external_name":"stream","restriction":"::String"},{"name":"consumer","external_name":"consumer","restriction":"::String"},{"name":"delivered_count","external_name":"delivered_count","restriction":"::Int64"},{"name":"stream_seq","external_name":"stream_seq","restriction":"::Int64"},{"name":"consumer_seq","external_name":"consumer_seq","restriction":"::Int64"},{"name":"timestamp","external_name":"timestamp","restriction":"::Time"},{"name":"pending","external_name":"pending","restriction":"::Int64"},{"name":"body","external_name":"body","restriction":"::Slice(::UInt8)"},{"name":"subject","external_name":"subject","restriction":"::String"},{"name":"reply_to","external_name":"reply_to","restriction":"::String"},{"name":"headers","external_name":"headers","restriction":"::Nil | ::Hash(::String, ::String)"}],"args_string":"(stream : String, consumer : String, delivered_count : Int64, stream_seq : Int64, consumer_seq : Int64, timestamp : Time, pending : Int64, body : Slice(UInt8), subject : String, reply_to : String, headers : Nil | Hash(String, String))","args_html":"(stream : String, consumer : String, delivered_count : Int64, stream_seq : Int64, consumer_seq : Int64, timestamp : Time, pending : Int64, body : Slice(UInt8), subject : String, reply_to : String, headers : Nil | Hash(String, String))","location":{"filename":"src/jetstream/message.cr","line_number":83,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/message.cr#L83"},"def":{"name":"new","args":[{"name":"stream","external_name":"stream","restriction":"::String"},{"name":"consumer","external_name":"consumer","restriction":"::String"},{"name":"delivered_count","external_name":"delivered_count","restriction":"::Int64"},{"name":"stream_seq","external_name":"stream_seq","restriction":"::Int64"},{"name":"consumer_seq","external_name":"consumer_seq","restriction":"::Int64"},{"name":"timestamp","external_name":"timestamp","restriction":"::Time"},{"name":"pending","external_name":"pending","restriction":"::Int64"},{"name":"body","external_name":"body","restriction":"::Slice(::UInt8)"},{"name":"subject","external_name":"subject","restriction":"::String"},{"name":"reply_to","external_name":"reply_to","restriction":"::String"},{"name":"headers","external_name":"headers","restriction":"::Nil | ::Hash(::String, ::String)"}],"visibility":"Public","body":"_ = allocate\n_.initialize(stream, consumer, delivered_count, stream_seq, consumer_seq, timestamp, pending, body, subject, reply_to, headers)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false},{"html_id":"new(msg:NATS::Message)-class-method","name":"new","doc":"Instantiate a `NATS::JetStream::Message` based on a `NATS::Message`.\nUsed by JetStream subscriptions to build `JetStream::Message`\ninstances, since JetStream is a layer on top of core NATS.","summary":"<p>Instantiate a <code><a href=\"../../NATS/JetStream/Message.html\">NATS::JetStream::Message</a></code> based on a <code><a href=\"../../NATS/Message.html\">NATS::Message</a></code>.</p>","abstract":false,"args":[{"name":"msg","external_name":"msg","restriction":"::NATS::Message"}],"args_string":"(msg : NATS::Message)","args_html":"(msg : <a href=\"../../NATS/Message.html\">NATS::Message</a>)","location":{"filename":"src/jetstream/message.cr","line_number":59,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/message.cr#L59"},"def":{"name":"new","args":[{"name":"msg","external_name":"msg","restriction":"::NATS::Message"}],"visibility":"Public","body":"if reply_to = msg.reply_to\n  _jetstream, _ack, stream, consumer, delivered_count, stream_seq, consumer_seq, timestamp, pending_messages = reply_to.split('.')\n  new(stream: stream, consumer: consumer, delivered_count: delivered_count.to_i64, stream_seq: stream_seq.to_i64, consumer_seq: consumer_seq.to_i64, timestamp: Time::UNIX_EPOCH + timestamp.to_i64.nanoseconds, pending: pending_messages.to_i64, body: msg.body, subject: msg.subject, reply_to: reply_to, headers: msg.headers)\nelse\n  raise(InvalidJetStreamMessage.new(\"JetStream messages must have the reply_to field\"))\nend"},"external_var":false}],"instance_methods":[{"html_id":"body:Bytes-instance-method","name":"body","doc":"The original body of the message, encoded as binary. If you need text,\nwrap the body in a `String`.\n\n```\njetstream.subscribe consumer do |msg|\n  body_string = String.new(msg.body)\n\n  # ...\nend\n```","summary":"<p>The original body of the message, encoded as binary.</p>","abstract":false,"location":{"filename":"src/jetstream/message.cr","line_number":42,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/message.cr#L42"},"def":{"name":"body","return_type":"Bytes","visibility":"Public","body":"@body"},"external_var":false},{"html_id":"consumer:String-instance-method","name":"consumer","doc":"The name of the consumer we received this message from","summary":"<p>The name of the consumer we received this message from</p>","abstract":false,"location":{"filename":"src/jetstream/message.cr","line_number":14,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/message.cr#L14"},"def":{"name":"consumer","return_type":"String","visibility":"Public","body":"@consumer"},"external_var":false},{"html_id":"consumer_seq:Int64-instance-method","name":"consumer_seq","doc":"The position of this message within its consumer, including redeliveries","summary":"<p>The position of this message within its consumer, including redeliveries</p>","abstract":false,"location":{"filename":"src/jetstream/message.cr","line_number":24,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/message.cr#L24"},"def":{"name":"consumer_seq","return_type":"Int64","visibility":"Public","body":"@consumer_seq"},"external_var":false},{"html_id":"delivered_count:Int64-instance-method","name":"delivered_count","doc":"The number of times this particular message has been delivered by this\nconsumer, starting at 1","summary":"<p>The number of times this particular message has been delivered by this consumer, starting at 1</p>","abstract":false,"location":{"filename":"src/jetstream/message.cr","line_number":18,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/message.cr#L18"},"def":{"name":"delivered_count","return_type":"Int64","visibility":"Public","body":"@delivered_count"},"external_var":false},{"html_id":"headers:Headers-instance-method","name":"headers","doc":"Any headers that were published with this message, including ones\ninterpreted by the NATS server, such as `Nats-Msg-Id` for message\ndeduplication.","summary":"<p>Any headers that were published with this message, including ones interpreted by the NATS server, such as <code>Nats-Msg-Id</code> for message deduplication.</p>","abstract":false,"location":{"filename":"src/jetstream/message.cr","line_number":54,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/message.cr#L54"},"def":{"name":"headers","return_type":"Headers","visibility":"Public","body":"if (__temp_170 = @headers).nil?\n  @headers = (Headers.new)\nelse\n  __temp_170\nend"},"external_var":false},{"html_id":"pending:Int64-instance-method","name":"pending","doc":"How many messages follow this message for this consumer","summary":"<p>How many messages follow this message for this consumer</p>","abstract":false,"location":{"filename":"src/jetstream/message.cr","line_number":30,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/message.cr#L30"},"def":{"name":"pending","return_type":"Int64","visibility":"Public","body":"@pending"},"external_var":false},{"html_id":"reply_to:String-instance-method","name":"reply_to","doc":"The subject used for acknowledging this message","summary":"<p>The subject used for acknowledging this message</p>","abstract":false,"location":{"filename":"src/jetstream/message.cr","line_number":49,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/message.cr#L49"},"def":{"name":"reply_to","return_type":"String","visibility":"Public","body":"@reply_to"},"external_var":false},{"html_id":"stream:String-instance-method","name":"stream","doc":"The name of the stream this message was consumed from","summary":"<p>The name of the stream this message was consumed from</p>","abstract":false,"location":{"filename":"src/jetstream/message.cr","line_number":11,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/message.cr#L11"},"def":{"name":"stream","return_type":"String","visibility":"Public","body":"@stream"},"external_var":false},{"html_id":"stream_seq:Int64-instance-method","name":"stream_seq","doc":"The position of this message within its stream","summary":"<p>The position of this message within its stream</p>","abstract":false,"location":{"filename":"src/jetstream/message.cr","line_number":21,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/message.cr#L21"},"def":{"name":"stream_seq","return_type":"Int64","visibility":"Public","body":"@stream_seq"},"external_var":false},{"html_id":"subject:String-instance-method","name":"subject","doc":"The original subject this message was published to, which can be (and\nmost likely is) different from the subject it was delivered to","summary":"<p>The original subject this message was published to, which can be (and most likely is) different from the subject it was delivered to</p>","abstract":false,"location":{"filename":"src/jetstream/message.cr","line_number":46,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/message.cr#L46"},"def":{"name":"subject","return_type":"String","visibility":"Public","body":"@subject"},"external_var":false},{"html_id":"timestamp:Time-instance-method","name":"timestamp","doc":"When this message was originally published","summary":"<p>When this message was originally published</p>","abstract":false,"location":{"filename":"src/jetstream/message.cr","line_number":27,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/message.cr#L27"},"def":{"name":"timestamp","return_type":"Time","visibility":"Public","body":"@timestamp"},"external_var":false}],"types":[{"html_id":"nats/NATS/JetStream/Message/InvalidJetStreamMessage","path":"NATS/JetStream/Message/InvalidJetStreamMessage.html","kind":"class","full_name":"NATS::JetStream::Message::InvalidJetStreamMessage","name":"InvalidJetStreamMessage","abstract":false,"superclass":{"html_id":"nats/Exception","kind":"class","full_name":"Exception","name":"Exception"},"ancestors":[{"html_id":"nats/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/message.cr","line_number":86,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/message.cr#L86"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream/Message","kind":"struct","full_name":"NATS::JetStream::Message","name":"Message"}}]},{"html_id":"nats/NATS/JetStream/NAKBackoff","path":"NATS/JetStream/NAKBackoff.html","kind":"enum","full_name":"NATS::JetStream::NAKBackoff","name":"NAKBackoff","abstract":false,"ancestors":[{"html_id":"nats/Enum","kind":"struct","full_name":"Enum","name":"Enum"},{"html_id":"nats/Comparable","kind":"module","full_name":"Comparable","name":"Comparable"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/nak_backoff.cr","line_number":16,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/nak_backoff.cr#L16"}],"repository_name":"nats","program":false,"enum":true,"alias":false,"const":false,"constants":[{"id":"Exponential","name":"Exponential","value":"0","doc":"Exponential backoff starts at a delay of 1/16th of a second and\ndoubles every time the message is nacked with this strategy. This has\nthe effect of running the first 3 attempts roughly immediately so that\nan uncommon but not unexpected failure (API call in a downstream\nservice returns a 500) doesn't need to wait several seconds unless it\ntruly needs to.","summary":"<p>Exponential backoff starts at a delay of 1/16th of a second and doubles every time the message is nacked with this strategy.</p>"},{"id":"Linear","name":"Linear","value":"1","doc":"Linear backoff delays for 1 second for each time the message is nacked\nwith this strategy.","summary":"<p>Linear backoff delays for 1 second for each time the message is nacked with this strategy.</p>"}],"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"},"doc":"Common `nack` backoff strategies give a simple shorthand for setting the\ndelays on subsequent delivery attempts.\n\n```\nnats = NATS::Client.new\n\njetstream.subscribe consumer do |msg|\n  # do some work\n  jetstream.ack msg\nrescue ex\n  jetstream.nack msg, backoff: :exponential\n  raise ex\nend\n```","summary":"<p>Common <code>nack</code> backoff strategies give a simple shorthand for setting the delays on subsequent delivery attempts.</p>","instance_methods":[{"html_id":"exponential?-instance-method","name":"exponential?","doc":"Returns `true` if this enum value equals `Exponential`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../NATS/JetStream/NAKBackoff.html#Exponential\">Exponential</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/nak_backoff.cr","line_number":23,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/nak_backoff.cr#L23"},"def":{"name":"exponential?","visibility":"Public","body":"self == Exponential"},"external_var":false},{"html_id":"linear?-instance-method","name":"linear?","doc":"Returns `true` if this enum value equals `Linear`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../NATS/JetStream/NAKBackoff.html#Linear\">Linear</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/nak_backoff.cr","line_number":27,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/nak_backoff.cr#L27"},"def":{"name":"linear?","visibility":"Public","body":"self == Linear"},"external_var":false}]},{"html_id":"nats/NATS/JetStream/NanosecondsConverter","path":"NATS/JetStream/NanosecondsConverter.html","kind":"module","full_name":"NATS::JetStream::NanosecondsConverter","name":"NanosecondsConverter","abstract":false,"locations":[{"filename":"src/jetstream/nanoseconds_converter.cr","line_number":4,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/nanoseconds_converter.cr#L4"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"},"class_methods":[{"html_id":"from_json(json:JSON::PullParser)-class-method","name":"from_json","abstract":false,"args":[{"name":"json","external_name":"json","restriction":"JSON::PullParser"}],"args_string":"(json : JSON::PullParser)","args_html":"(json : JSON::PullParser)","location":{"filename":"src/jetstream/nanoseconds_converter.cr","line_number":9,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/nanoseconds_converter.cr#L9"},"def":{"name":"from_json","args":[{"name":"json","external_name":"json","restriction":"JSON::PullParser"}],"visibility":"Public","body":"json.read_int.nanoseconds"},"external_var":false},{"html_id":"to_json(span:Time::Span,json:JSON::Builder)-class-method","name":"to_json","abstract":false,"args":[{"name":"span","external_name":"span","restriction":"Time::Span"},{"name":"json","external_name":"json","restriction":"JSON::Builder"}],"args_string":"(span : Time::Span, json : JSON::Builder)","args_html":"(span : Time::Span, json : JSON::Builder)","location":{"filename":"src/jetstream/nanoseconds_converter.cr","line_number":5,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/nanoseconds_converter.cr#L5"},"def":{"name":"to_json","args":[{"name":"span","external_name":"span","restriction":"Time::Span"},{"name":"json","external_name":"json","restriction":"JSON::Builder"}],"visibility":"Public","body":"json.number(span.total_nanoseconds.to_i64)"},"external_var":false}]},{"html_id":"nats/NATS/JetStream/PeerInfo","path":"NATS/JetStream/PeerInfo.html","kind":"struct","full_name":"NATS::JetStream::PeerInfo","name":"PeerInfo","abstract":false,"superclass":{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},"ancestors":[{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/peer_info.cr","line_number":5,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/peer_info.cr#L5"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/jetstream/peer_info.cr","line_number":5,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/peer_info.cr#L5"},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"},"external_var":false}],"instance_methods":[{"html_id":"active:Time::Span-instance-method","name":"active","abstract":false,"location":{"filename":"src/jetstream/peer_info.cr","line_number":10,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/peer_info.cr#L10"},"def":{"name":"active","return_type":"Time::Span","visibility":"Public","body":"@active"},"external_var":false},{"html_id":"current?:Bool-instance-method","name":"current?","abstract":false,"location":{"filename":"src/jetstream/peer_info.cr","line_number":7,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/peer_info.cr#L7"},"def":{"name":"current?","return_type":"Bool","visibility":"Public","body":"@current"},"external_var":false},{"html_id":"lag:UInt64|Nil-instance-method","name":"lag","abstract":false,"location":{"filename":"src/jetstream/peer_info.cr","line_number":11,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/peer_info.cr#L11"},"def":{"name":"lag","return_type":"UInt64 | ::Nil","visibility":"Public","body":"@lag"},"external_var":false},{"html_id":"name:String-instance-method","name":"name","abstract":false,"location":{"filename":"src/jetstream/peer_info.cr","line_number":6,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/peer_info.cr#L6"},"def":{"name":"name","return_type":"String","visibility":"Public","body":"@name"},"external_var":false},{"html_id":"offline?:Bool-instance-method","name":"offline?","abstract":false,"location":{"filename":"src/jetstream/peer_info.cr","line_number":8,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/peer_info.cr#L8"},"def":{"name":"offline?","return_type":"Bool","visibility":"Public","body":"@offline"},"external_var":false}]},{"html_id":"nats/NATS/JetStream/PubAck","path":"NATS/JetStream/PubAck.html","kind":"struct","full_name":"NATS::JetStream::PubAck","name":"PubAck","abstract":false,"superclass":{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},"ancestors":[{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/pub_ack.cr","line_number":5,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/pub_ack.cr#L5"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/jetstream/pub_ack.cr","line_number":5,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/pub_ack.cr#L5"},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"},"external_var":false}],"instance_methods":[{"html_id":"domain:String|Nil-instance-method","name":"domain","abstract":false,"location":{"filename":"src/jetstream/pub_ack.cr","line_number":10,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/pub_ack.cr#L10"},"def":{"name":"domain","return_type":"String | ::Nil","visibility":"Public","body":"@domain"},"external_var":false},{"html_id":"duplicate?:Bool-instance-method","name":"duplicate?","abstract":false,"location":{"filename":"src/jetstream/pub_ack.cr","line_number":9,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/pub_ack.cr#L9"},"def":{"name":"duplicate?","return_type":"Bool","visibility":"Public","body":"@duplicate"},"external_var":false},{"html_id":"sequence:Int64-instance-method","name":"sequence","abstract":false,"location":{"filename":"src/jetstream/pub_ack.cr","line_number":8,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/pub_ack.cr#L8"},"def":{"name":"sequence","return_type":"Int64","visibility":"Public","body":"@sequence"},"external_var":false},{"html_id":"stream:String-instance-method","name":"stream","abstract":false,"location":{"filename":"src/jetstream/pub_ack.cr","line_number":6,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/pub_ack.cr#L6"},"def":{"name":"stream","return_type":"String","visibility":"Public","body":"@stream"},"external_var":false}]},{"html_id":"nats/NATS/JetStream/PullSubscription","path":"NATS/JetStream/PullSubscription.html","kind":"class","full_name":"NATS::JetStream::PullSubscription","name":"PullSubscription","abstract":false,"superclass":{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/pull_subscription.cr","line_number":6,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/pull_subscription.cr#L6"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"},"constructors":[{"html_id":"new(consumer:NATS::JetStream::Consumer,nats:NATS::Client)-class-method","name":"new","abstract":false,"args":[{"name":"consumer","external_name":"consumer","restriction":"::NATS::JetStream::Consumer"},{"name":"nats","external_name":"nats","restriction":"::NATS::Client"}],"args_string":"(consumer : NATS::JetStream::Consumer, nats : NATS::Client)","args_html":"(consumer : <a href=\"../../NATS/JetStream/Consumer.html\">NATS::JetStream::Consumer</a>, nats : <a href=\"../../NATS/Client.html\">NATS::Client</a>)","location":{"filename":"src/jetstream/pull_subscription.cr","line_number":10,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/pull_subscription.cr#L10"},"def":{"name":"new","args":[{"name":"consumer","external_name":"consumer","restriction":"::NATS::JetStream::Consumer"},{"name":"nats","external_name":"nats","restriction":"::NATS::Client"}],"visibility":"Public","body":"_ = allocate\n_.initialize(consumer, nats)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"ack_next(msg:Message,timeout:Time::Span=2.seconds)-instance-method","name":"ack_next","doc":"Acknowledge the given message and request the next in a single round\ntrip to the server to save latency.\n\n```\npull = js.pull_subscribe(consumer)\n# Poll for messages until we get one\nuntil msg = pull.fetch(timeout: 30.seconds)\nend\nloop do\nend\n```","summary":"<p>Acknowledge the given message and request the next in a single round trip to the server to save latency.</p>","abstract":false,"args":[{"name":"msg","external_name":"msg","restriction":"Message"},{"name":"timeout","default_value":"2.seconds","external_name":"timeout","restriction":"Time::Span"}],"args_string":"(msg : Message, timeout : Time::Span = 2.seconds)","args_html":"(msg : <a href=\"../../NATS/JetStream/Message.html\">Message</a>, timeout : Time::Span = <span class=\"n\">2</span>.seconds)","location":{"filename":"src/jetstream/pull_subscription.cr","line_number":79,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/pull_subscription.cr#L79"},"def":{"name":"ack_next","args":[{"name":"msg","external_name":"msg","restriction":"Message"},{"name":"timeout","default_value":"2.seconds","external_name":"timeout","restriction":"Time::Span"}],"visibility":"Public","body":"inbox = \"ack-next.#{NUID.next}\"\nchannel = Channel(Message).new(1)\n\n\nsub = @nats.subscribe(inbox) do |msg|\n  channel.send(Message.new(msg))\nend\n@nats.unsubscribe(sub, max_messages: 1)\n@nats.publish(msg.reply_to, \"+NXT 1\", reply_to: inbox)\n\nselect\nwhen reply = channel.receive\n  reply\nwhen timeout(timeout)\n  @nats.unsubscribe(sub)\n  nil\nend\n"},"external_var":false},{"html_id":"ack_next(msg:Message,count:Int,timeout:Time::Span=2.seconds,no_wait:Bool=false)-instance-method","name":"ack_next","doc":"Acknowledge the given message and request the next `count` messages in\na single round trip to the server to save latency.","summary":"<p>Acknowledge the given message and request the next <code>count</code> messages in a single round trip to the server to save latency.</p>","abstract":false,"args":[{"name":"msg","external_name":"msg","restriction":"Message"},{"name":"count","external_name":"count","restriction":"Int"},{"name":"timeout","default_value":"2.seconds","external_name":"timeout","restriction":"Time::Span"},{"name":"no_wait","default_value":"false","external_name":"no_wait","restriction":"Bool"}],"args_string":"(msg : Message, count : Int, timeout : Time::Span = 2.seconds, no_wait : Bool = false)","args_html":"(msg : <a href=\"../../NATS/JetStream/Message.html\">Message</a>, count : Int, timeout : Time::Span = <span class=\"n\">2</span>.seconds, no_wait : Bool = <span class=\"n\">false</span>)","location":{"filename":"src/jetstream/pull_subscription.cr","line_number":104,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/pull_subscription.cr#L104"},"def":{"name":"ack_next","args":[{"name":"msg","external_name":"msg","restriction":"Message"},{"name":"count","external_name":"count","restriction":"Int"},{"name":"timeout","default_value":"2.seconds","external_name":"timeout","restriction":"Time::Span"},{"name":"no_wait","default_value":"false","external_name":"no_wait","restriction":"Bool"}],"visibility":"Public","body":"nats.jetstream.ack(msg)\nfetch(count, timeout: timeout)\n"},"external_var":false},{"html_id":"consumer:Consumer-instance-method","name":"consumer","abstract":false,"location":{"filename":"src/jetstream/pull_subscription.cr","line_number":7,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/pull_subscription.cr#L7"},"def":{"name":"consumer","return_type":"Consumer","visibility":"Public","body":"@consumer"},"external_var":false},{"html_id":"fetch(timeout:Time::Span=2.seconds)-instance-method","name":"fetch","abstract":false,"args":[{"name":"timeout","default_value":"2.seconds","external_name":"timeout","restriction":"Time::Span"}],"args_string":"(timeout : Time::Span = 2.seconds)","args_html":"(timeout : Time::Span = <span class=\"n\">2</span>.seconds)","location":{"filename":"src/jetstream/pull_subscription.cr","line_number":13,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/pull_subscription.cr#L13"},"def":{"name":"fetch","args":[{"name":"timeout","default_value":"2.seconds","external_name":"timeout","restriction":"Time::Span"}],"visibility":"Public","body":"(fetch(1, timeout: timeout)).first?"},"external_var":false},{"html_id":"fetch(message_count:Int,timeout:Time::Span=2.seconds,no_wait:Bool=false,max_bytes:Int|Nil=nil):Enumerable(Message)-instance-method","name":"fetch","abstract":false,"args":[{"name":"message_count","external_name":"message_count","restriction":"Int"},{"name":"timeout","default_value":"2.seconds","external_name":"timeout","restriction":"Time::Span"},{"name":"no_wait","default_value":"false","external_name":"no_wait","restriction":"Bool"},{"name":"max_bytes","default_value":"nil","external_name":"max_bytes","restriction":"Int | ::Nil"}],"args_string":"(message_count : Int, timeout : Time::Span = 2.seconds, no_wait : Bool = false, max_bytes : Int | Nil = nil) : Enumerable(Message)","args_html":"(message_count : Int, timeout : Time::Span = <span class=\"n\">2</span>.seconds, no_wait : Bool = <span class=\"n\">false</span>, max_bytes : Int | Nil = <span class=\"n\">nil</span>) : Enumerable(<a href=\"../../NATS/JetStream/Message.html\">Message</a>)","location":{"filename":"src/jetstream/pull_subscription.cr","line_number":17,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/pull_subscription.cr#L17"},"def":{"name":"fetch","args":[{"name":"message_count","external_name":"message_count","restriction":"Int"},{"name":"timeout","default_value":"2.seconds","external_name":"timeout","restriction":"Time::Span"},{"name":"no_wait","default_value":"false","external_name":"no_wait","restriction":"Bool"},{"name":"max_bytes","default_value":"nil","external_name":"max_bytes","restriction":"Int | ::Nil"}],"return_type":"Enumerable(Message)","visibility":"Public","body":"LOG.trace do\n  \"Creating channel\"\nend\nchannel = Channel(Message).new(message_count)\ndeliver_subject = \"_INBOX.#{NUID.next}\"\nLOG.trace do\n  \"Sending subscription\"\nend\nsubscription = @nats.subscribe(deliver_subject) do |msg, sub|\n  if ((headers = msg.headers) && (status = headers[\"Status\"]?)) && (status.starts_with?(\"409\"))\n    sub.close\n  else\n    if msg.reply_to.presence\n      channel.send(Message.new(msg))\n    else\n      raise(InternalError.new(\"Found a bug in NATS pull subscriptions. Please check the issues at https://github.com/jgaskins/nats/issues and, if there is not one open yet, please open one with this stack trace.\"))\n    end\n  end\nend\n\n@nats.publish(\"$JS.API.CONSUMER.MSG.NEXT.#{consumer.stream_name}.#{consumer.name}\", message: {expires: {(timeout - 100.milliseconds).total_nanoseconds, 0}.max.to_i64, batch: message_count}.to_json, reply_to: deliver_subject)\n@nats.flush!\n\nmsgs = Array(Message).new(initial_capacity: message_count)\ntotal_timeout = timeout\nfinish_by = Time.monotonic + timeout\n\nmessage_count.times do |i|\n  LOG.trace do\n    \"Waiting for message #{i}\"\n  end\n  select\n  when msg = channel.receive\n    LOG.trace do\n      \"received\"\n    end\n    msgs << msg\n  when timeout(finish_by - Time.monotonic)\n    LOG.trace do\n      \"timed out\"\n    end\n    break\n  end\nend\n@nats.unsubscribe(subscription)\n\nmsgs\n"},"external_var":false}],"types":[{"html_id":"nats/NATS/JetStream/PullSubscription/InternalError","path":"NATS/JetStream/PullSubscription/InternalError.html","kind":"class","full_name":"NATS::JetStream::PullSubscription::InternalError","name":"InternalError","abstract":false,"superclass":{"html_id":"nats/NATS/Error","kind":"class","full_name":"NATS::Error","name":"Error"},"ancestors":[{"html_id":"nats/NATS/Error","kind":"class","full_name":"NATS::Error","name":"Error"},{"html_id":"nats/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/pull_subscription.cr","line_number":110,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/pull_subscription.cr#L110"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream/PullSubscription","kind":"class","full_name":"NATS::JetStream::PullSubscription","name":"PullSubscription"}}]},{"html_id":"nats/NATS/JetStream/Stream","path":"NATS/JetStream/Stream.html","kind":"struct","full_name":"NATS::JetStream::Stream","name":"Stream","abstract":false,"superclass":{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},"ancestors":[{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/stream.cr","line_number":8,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream.cr#L8"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/jetstream/stream.cr","line_number":8,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream.cr#L8"},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"},"external_var":false}],"instance_methods":[{"html_id":"cluster:ClusterInfo|Nil-instance-method","name":"cluster","abstract":false,"location":{"filename":"src/jetstream/stream.cr","line_number":12,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream.cr#L12"},"def":{"name":"cluster","return_type":"ClusterInfo | ::Nil","visibility":"Public","body":"@cluster"},"external_var":false},{"html_id":"config:StreamConfig-instance-method","name":"config","abstract":false,"location":{"filename":"src/jetstream/stream.cr","line_number":9,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream.cr#L9"},"def":{"name":"config","return_type":"StreamConfig","visibility":"Public","body":"@config"},"external_var":false},{"html_id":"created:Time-instance-method","name":"created","abstract":false,"location":{"filename":"src/jetstream/stream.cr","line_number":10,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream.cr#L10"},"def":{"name":"created","return_type":"Time","visibility":"Public","body":"@created"},"external_var":false},{"html_id":"mirror:StreamSourceInfo|Nil-instance-method","name":"mirror","abstract":false,"location":{"filename":"src/jetstream/stream.cr","line_number":13,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream.cr#L13"},"def":{"name":"mirror","return_type":"StreamSourceInfo | ::Nil","visibility":"Public","body":"@mirror"},"external_var":false},{"html_id":"sources:Array(StreamSourceInfo)-instance-method","name":"sources","abstract":false,"location":{"filename":"src/jetstream/stream.cr","line_number":14,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream.cr#L14"},"def":{"name":"sources","return_type":"Array(StreamSourceInfo)","visibility":"Public","body":"if (__temp_163 = @sources).nil?\n  @sources = ([] of StreamSourceInfo)\nelse\n  __temp_163\nend"},"external_var":false},{"html_id":"state:StreamState-instance-method","name":"state","abstract":false,"location":{"filename":"src/jetstream/stream.cr","line_number":11,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream.cr#L11"},"def":{"name":"state","return_type":"StreamState","visibility":"Public","body":"@state"},"external_var":false}]},{"html_id":"nats/NATS/JetStream/StreamConfig","path":"NATS/JetStream/StreamConfig.html","kind":"struct","full_name":"NATS::JetStream::StreamConfig","name":"StreamConfig","abstract":false,"superclass":{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},"ancestors":[{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/stream_config.cr","line_number":5,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L5"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/jetstream/stream_config.cr","line_number":5,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L5"},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"},"external_var":false},{"html_id":"new(name:String,subjects:Nil|Array(String)=nil,description:Nil|String=nil,max_age:Time::Span|Nil=nil,max_bytes:Int64|Nil=nil,max_msg_size:Int32|Nil=nil,max_msgs:Int64|Nil=nil,max_msgs_per_subject:Int64|Nil=nil,max_consumers:Int32|Nil=nil,no_ack:Bool|Nil=false,replicas:Int32=1,retention:RetentionPolicy|Nil=nil,allow_rollup_headers:Bool|Nil=nil,deny_delete:Bool|Nil=nil,allow_direct:Bool|Nil=nil,mirror_direct:Bool|Nil=nil,republish:NATS::JetStream::StreamConfig::Republish|Nil=nil,placement:NATS::JetStream::StreamConfig::Placement|Nil=nil,mirror:NATS::JetStream::StreamSource|Nil=nil,sources:Nil|Array(NATS::JetStream::StreamSource)=nil,discard_new_per_subject:Bool|Nil=nil,discard:DiscardPolicy|Nil=nil,allow_msg_ttl:Bool|Nil=false,storage:Storage=:file,compression:NATS::JetStream::StreamConfig::Compression=:none)-class-method","name":"new","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"::String"},{"name":"subjects","default_value":"nil","external_name":"subjects","restriction":"::Nil | ::Array(::String)"},{"name":"description","default_value":"nil","external_name":"description","restriction":"::Nil | ::String"},{"name":"max_age","default_value":"nil","external_name":"max_age","restriction":"::Time::Span | ::Nil"},{"name":"max_bytes","default_value":"nil","external_name":"max_bytes","restriction":"::Int64 | ::Nil"},{"name":"max_msg_size","default_value":"nil","external_name":"max_msg_size","restriction":"::Int32 | ::Nil"},{"name":"max_msgs","default_value":"nil","external_name":"max_msgs","restriction":"::Int64 | ::Nil"},{"name":"max_msgs_per_subject","default_value":"nil","external_name":"max_msgs_per_subject","restriction":"::Int64 | ::Nil"},{"name":"max_consumers","default_value":"nil","external_name":"max_consumers","restriction":"::Int32 | ::Nil"},{"name":"no_ack","default_value":"false","external_name":"no_ack","restriction":"::Bool | ::Nil"},{"name":"replicas","default_value":"1","external_name":"replicas","restriction":"::Int32"},{"name":"retention","default_value":"nil","external_name":"retention","restriction":"RetentionPolicy | ::Nil"},{"name":"allow_rollup_headers","default_value":"nil","external_name":"allow_rollup_headers","restriction":"::Bool | ::Nil"},{"name":"deny_delete","default_value":"nil","external_name":"deny_delete","restriction":"::Bool | ::Nil"},{"name":"allow_direct","default_value":"nil","external_name":"allow_direct","restriction":"::Bool | ::Nil"},{"name":"mirror_direct","default_value":"nil","external_name":"mirror_direct","restriction":"::Bool | ::Nil"},{"name":"republish","default_value":"nil","external_name":"republish","restriction":"::NATS::JetStream::StreamConfig::Republish | ::Nil"},{"name":"placement","default_value":"nil","external_name":"placement","restriction":"::NATS::JetStream::StreamConfig::Placement | ::Nil"},{"name":"mirror","default_value":"nil","external_name":"mirror","restriction":"::NATS::JetStream::StreamSource | ::Nil"},{"name":"sources","default_value":"nil","external_name":"sources","restriction":"::Nil | ::Array(::NATS::JetStream::StreamSource)"},{"name":"discard_new_per_subject","default_value":"nil","external_name":"discard_new_per_subject","restriction":"::Bool | ::Nil"},{"name":"discard","default_value":"nil","external_name":"discard","restriction":"DiscardPolicy | ::Nil"},{"name":"allow_msg_ttl","default_value":"false","external_name":"allow_msg_ttl","restriction":"::Bool | ::Nil"},{"name":"storage","default_value":":file","external_name":"storage","restriction":"Storage"},{"name":"compression","default_value":":none","external_name":"compression","restriction":"::NATS::JetStream::StreamConfig::Compression"}],"args_string":"(name : String, subjects : Nil | Array(String) = nil, description : Nil | String = nil, max_age : Time::Span | Nil = nil, max_bytes : Int64 | Nil = nil, max_msg_size : Int32 | Nil = nil, max_msgs : Int64 | Nil = nil, max_msgs_per_subject : Int64 | Nil = nil, max_consumers : Int32 | Nil = nil, no_ack : Bool | Nil = false, replicas : Int32 = 1, retention : RetentionPolicy | Nil = nil, allow_rollup_headers : Bool | Nil = nil, deny_delete : Bool | Nil = nil, allow_direct : Bool | Nil = nil, mirror_direct : Bool | Nil = nil, republish : NATS::JetStream::StreamConfig::Republish | Nil = nil, placement : NATS::JetStream::StreamConfig::Placement | Nil = nil, mirror : NATS::JetStream::StreamSource | Nil = nil, sources : Nil | Array(NATS::JetStream::StreamSource) = nil, discard_new_per_subject : Bool | Nil = nil, discard : DiscardPolicy | Nil = nil, allow_msg_ttl : Bool | Nil = false, storage : Storage = :file, compression : NATS::JetStream::StreamConfig::Compression = :none)","args_html":"(name : String, subjects : Nil | Array(String) = <span class=\"n\">nil</span>, description : Nil | String = <span class=\"n\">nil</span>, max_age : Time::Span | Nil = <span class=\"n\">nil</span>, max_bytes : Int64 | Nil = <span class=\"n\">nil</span>, max_msg_size : Int32 | Nil = <span class=\"n\">nil</span>, max_msgs : Int64 | Nil = <span class=\"n\">nil</span>, max_msgs_per_subject : Int64 | Nil = <span class=\"n\">nil</span>, max_consumers : Int32 | Nil = <span class=\"n\">nil</span>, no_ack : Bool | Nil = <span class=\"n\">false</span>, replicas : Int32 = <span class=\"n\">1</span>, retention : <a href=\"../../NATS/JetStream/StreamConfig/RetentionPolicy.html\">RetentionPolicy</a> | Nil = <span class=\"n\">nil</span>, allow_rollup_headers : Bool | Nil = <span class=\"n\">nil</span>, deny_delete : Bool | Nil = <span class=\"n\">nil</span>, allow_direct : Bool | Nil = <span class=\"n\">nil</span>, mirror_direct : Bool | Nil = <span class=\"n\">nil</span>, republish : <a href=\"../../NATS/JetStream/StreamConfig/Republish.html\">NATS::JetStream::StreamConfig::Republish</a> | Nil = <span class=\"n\">nil</span>, placement : <a href=\"../../NATS/JetStream/StreamConfig/Placement.html\">NATS::JetStream::StreamConfig::Placement</a> | Nil = <span class=\"n\">nil</span>, mirror : <a href=\"../../NATS/JetStream/StreamSource.html\">NATS::JetStream::StreamSource</a> | Nil = <span class=\"n\">nil</span>, sources : Nil | Array(<a href=\"../../NATS/JetStream/StreamSource.html\">NATS::JetStream::StreamSource</a>) = <span class=\"n\">nil</span>, discard_new_per_subject : Bool | Nil = <span class=\"n\">nil</span>, discard : <a href=\"../../NATS/JetStream/StreamConfig/DiscardPolicy.html\">DiscardPolicy</a> | Nil = <span class=\"n\">nil</span>, allow_msg_ttl : Bool | Nil = <span class=\"n\">false</span>, storage : <a href=\"../../NATS/JetStream/StreamConfig/Storage.html\">Storage</a> = <span class=\"n\">:file</span>, compression : <a href=\"../../NATS/JetStream/StreamConfig/Compression.html\">NATS::JetStream::StreamConfig::Compression</a> = <span class=\"n\">:none</span>)","location":{"filename":"src/jetstream/stream_config.cr","line_number":114,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L114"},"def":{"name":"new","args":[{"name":"name","external_name":"name","restriction":"::String"},{"name":"subjects","default_value":"nil","external_name":"subjects","restriction":"::Nil | ::Array(::String)"},{"name":"description","default_value":"nil","external_name":"description","restriction":"::Nil | ::String"},{"name":"max_age","default_value":"nil","external_name":"max_age","restriction":"::Time::Span | ::Nil"},{"name":"max_bytes","default_value":"nil","external_name":"max_bytes","restriction":"::Int64 | ::Nil"},{"name":"max_msg_size","default_value":"nil","external_name":"max_msg_size","restriction":"::Int32 | ::Nil"},{"name":"max_msgs","default_value":"nil","external_name":"max_msgs","restriction":"::Int64 | ::Nil"},{"name":"max_msgs_per_subject","default_value":"nil","external_name":"max_msgs_per_subject","restriction":"::Int64 | ::Nil"},{"name":"max_consumers","default_value":"nil","external_name":"max_consumers","restriction":"::Int32 | ::Nil"},{"name":"no_ack","default_value":"false","external_name":"no_ack","restriction":"::Bool | ::Nil"},{"name":"replicas","default_value":"1","external_name":"replicas","restriction":"::Int32"},{"name":"retention","default_value":"nil","external_name":"retention","restriction":"RetentionPolicy | ::Nil"},{"name":"allow_rollup_headers","default_value":"nil","external_name":"allow_rollup_headers","restriction":"::Bool | ::Nil"},{"name":"deny_delete","default_value":"nil","external_name":"deny_delete","restriction":"::Bool | ::Nil"},{"name":"allow_direct","default_value":"nil","external_name":"allow_direct","restriction":"::Bool | ::Nil"},{"name":"mirror_direct","default_value":"nil","external_name":"mirror_direct","restriction":"::Bool | ::Nil"},{"name":"republish","default_value":"nil","external_name":"republish","restriction":"::NATS::JetStream::StreamConfig::Republish | ::Nil"},{"name":"placement","default_value":"nil","external_name":"placement","restriction":"::NATS::JetStream::StreamConfig::Placement | ::Nil"},{"name":"mirror","default_value":"nil","external_name":"mirror","restriction":"::NATS::JetStream::StreamSource | ::Nil"},{"name":"sources","default_value":"nil","external_name":"sources","restriction":"::Nil | ::Array(::NATS::JetStream::StreamSource)"},{"name":"discard_new_per_subject","default_value":"nil","external_name":"discard_new_per_subject","restriction":"::Bool | ::Nil"},{"name":"discard","default_value":"nil","external_name":"discard","restriction":"DiscardPolicy | ::Nil"},{"name":"allow_msg_ttl","default_value":"false","external_name":"allow_msg_ttl","restriction":"::Bool | ::Nil"},{"name":"storage","default_value":":file","external_name":"storage","restriction":"Storage"},{"name":"compression","default_value":":none","external_name":"compression","restriction":"::NATS::JetStream::StreamConfig::Compression"}],"visibility":"Public","body":"_ = allocate\n_.initialize(name, subjects, description, max_age, max_bytes, max_msg_size, max_msgs, max_msgs_per_subject, max_consumers, no_ack, replicas, retention, allow_rollup_headers, deny_delete, allow_direct, mirror_direct, republish, placement, mirror, sources, discard_new_per_subject, discard, allow_msg_ttl, storage, compression)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"allow_direct?:Bool|Nil-instance-method","name":"allow_direct?","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":107,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L107"},"def":{"name":"allow_direct?","return_type":"Bool | ::Nil","visibility":"Public","body":"@allow_direct"},"external_var":false},{"html_id":"allow_msg_ttl?:Bool|Nil-instance-method","name":"allow_msg_ttl?","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":110,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L110"},"def":{"name":"allow_msg_ttl?","return_type":"Bool | ::Nil","visibility":"Public","body":"@allow_msg_ttl"},"external_var":false},{"html_id":"allow_rollup_headers?:Bool|Nil-instance-method","name":"allow_rollup_headers?","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":103,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L103"},"def":{"name":"allow_rollup_headers?","return_type":"Bool | ::Nil","visibility":"Public","body":"@allow_rollup_headers"},"external_var":false},{"html_id":"compression:Compression-instance-method","name":"compression","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":112,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L112"},"def":{"name":"compression","return_type":"Compression","visibility":"Public","body":"@compression"},"external_var":false},{"html_id":"deny_delete?:Bool|Nil-instance-method","name":"deny_delete?","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":105,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L105"},"def":{"name":"deny_delete?","return_type":"Bool | ::Nil","visibility":"Public","body":"@deny_delete"},"external_var":false},{"html_id":"deny_purge?:Bool|Nil-instance-method","name":"deny_purge?","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":104,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L104"},"def":{"name":"deny_purge?","return_type":"Bool | ::Nil","visibility":"Public","body":"@deny_purge"},"external_var":false},{"html_id":"description:String|Nil-instance-method","name":"description","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":80,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L80"},"def":{"name":"description","return_type":"String | ::Nil","visibility":"Public","body":"@description"},"external_var":false},{"html_id":"discard:DiscardPolicy|Nil-instance-method","name":"discard","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":96,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L96"},"def":{"name":"discard","return_type":"DiscardPolicy | ::Nil","visibility":"Public","body":"@discard"},"external_var":false},{"html_id":"discard_new_per_subject?:Bool|Nil-instance-method","name":"discard_new_per_subject?","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":109,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L109"},"def":{"name":"discard_new_per_subject?","return_type":"Bool | ::Nil","visibility":"Public","body":"@discard_new_per_subject"},"external_var":false},{"html_id":"duplicate_window:Time::Span|Nil-instance-method","name":"duplicate_window","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":101,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L101"},"def":{"name":"duplicate_window","return_type":"Time::Span | ::Nil","visibility":"Public","body":"@duplicate_window"},"external_var":false},{"html_id":"max_age:Time::Span|Nil-instance-method","name":"max_age","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":86,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L86"},"def":{"name":"max_age","return_type":"Time::Span | ::Nil","visibility":"Public","body":"@max_age"},"external_var":false},{"html_id":"max_bytes:Int64|Nil-instance-method","name":"max_bytes","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":87,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L87"},"def":{"name":"max_bytes","return_type":"Int64 | ::Nil","visibility":"Public","body":"@max_bytes"},"external_var":false},{"html_id":"max_consumers:Int32|Nil-instance-method","name":"max_consumers","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":91,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L91"},"def":{"name":"max_consumers","return_type":"Int32 | ::Nil","visibility":"Public","body":"@max_consumers"},"external_var":false},{"html_id":"max_msg_size:Int32|Nil-instance-method","name":"max_msg_size","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":88,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L88"},"def":{"name":"max_msg_size","return_type":"Int32 | ::Nil","visibility":"Public","body":"@max_msg_size"},"external_var":false},{"html_id":"max_msgs:Int64|Nil-instance-method","name":"max_msgs","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":89,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L89"},"def":{"name":"max_msgs","return_type":"Int64 | ::Nil","visibility":"Public","body":"@max_msgs"},"external_var":false},{"html_id":"max_msgs_per_subject:Int64|Nil-instance-method","name":"max_msgs_per_subject","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":90,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L90"},"def":{"name":"max_msgs_per_subject","return_type":"Int64 | ::Nil","visibility":"Public","body":"@max_msgs_per_subject"},"external_var":false},{"html_id":"mirror:StreamSource|Nil-instance-method","name":"mirror","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":98,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L98"},"def":{"name":"mirror","return_type":"StreamSource | ::Nil","visibility":"Public","body":"@mirror"},"external_var":false},{"html_id":"mirror_direct?:Bool|Nil-instance-method","name":"mirror_direct?","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":108,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L108"},"def":{"name":"mirror_direct?","return_type":"Bool | ::Nil","visibility":"Public","body":"@mirror_direct"},"external_var":false},{"html_id":"name:String-instance-method","name":"name","doc":"Name of this stream","summary":"<p>Name of this stream</p>","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":79,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L79"},"def":{"name":"name","return_type":"String","visibility":"Public","body":"@name"},"external_var":false},{"html_id":"no_ack?:Bool|Nil-instance-method","name":"no_ack?","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":92,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L92"},"def":{"name":"no_ack?","return_type":"Bool | ::Nil","visibility":"Public","body":"@no_ack"},"external_var":false},{"html_id":"placement:Placement|Nil-instance-method","name":"placement","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":97,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L97"},"def":{"name":"placement","return_type":"Placement | ::Nil","visibility":"Public","body":"@placement"},"external_var":false},{"html_id":"replicas:Int32-instance-method","name":"replicas","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":94,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L94"},"def":{"name":"replicas","return_type":"Int32","visibility":"Public","body":"@replicas"},"external_var":false},{"html_id":"republish:Republish|Nil-instance-method","name":"republish","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":111,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L111"},"def":{"name":"republish","return_type":"Republish | ::Nil","visibility":"Public","body":"@republish"},"external_var":false},{"html_id":"retention:RetentionPolicy|Nil-instance-method","name":"retention","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":95,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L95"},"def":{"name":"retention","return_type":"RetentionPolicy | ::Nil","visibility":"Public","body":"@retention"},"external_var":false},{"html_id":"sealed?:Bool|Nil-instance-method","name":"sealed?","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":106,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L106"},"def":{"name":"sealed?","return_type":"Bool | ::Nil","visibility":"Public","body":"@sealed"},"external_var":false},{"html_id":"sources:Array(StreamSource)-instance-method","name":"sources","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":99,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L99"},"def":{"name":"sources","return_type":"Array(StreamSource)","visibility":"Public","body":"if (__temp_161 = @sources).nil?\n  @sources = ([] of StreamSource)\nelse\n  __temp_161\nend"},"external_var":false},{"html_id":"storage:Storage-instance-method","name":"storage","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":84,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L84"},"def":{"name":"storage","return_type":"Storage","visibility":"Public","body":"@storage"},"external_var":false},{"html_id":"subjects:Array(String)-instance-method","name":"subjects","doc":"Which subjects this stream will listen for.","summary":"<p>Which subjects this stream will listen for.</p>","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":83,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L83"},"def":{"name":"subjects","return_type":"Array(String)","visibility":"Public","body":"if (__temp_160 = @subjects).nil?\n  @subjects = ([] of String)\nelse\n  __temp_160\nend"},"external_var":false}],"types":[{"html_id":"nats/NATS/JetStream/StreamConfig/Compression","path":"NATS/JetStream/StreamConfig/Compression.html","kind":"enum","full_name":"NATS::JetStream::StreamConfig::Compression","name":"Compression","abstract":false,"ancestors":[{"html_id":"nats/Enum","kind":"struct","full_name":"Enum","name":"Enum"},{"html_id":"nats/Comparable","kind":"module","full_name":"Comparable","name":"Comparable"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/stream_config.cr","line_number":143,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L143"}],"repository_name":"nats","program":false,"enum":true,"alias":false,"const":false,"constants":[{"id":"None","name":"None","value":"0"},{"id":"S2","name":"S2","value":"1"}],"namespace":{"html_id":"nats/NATS/JetStream/StreamConfig","kind":"struct","full_name":"NATS::JetStream::StreamConfig","name":"StreamConfig"},"instance_methods":[{"html_id":"none?-instance-method","name":"none?","doc":"Returns `true` if this enum value equals `None`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../../NATS/JetStream/StreamConfig/Compression.html#None\">None</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":144,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L144"},"def":{"name":"none?","visibility":"Public","body":"self == None"},"external_var":false},{"html_id":"s2?-instance-method","name":"s2?","doc":"Returns `true` if this enum value equals `S2`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../../NATS/JetStream/StreamConfig/Compression.html#S2\">S2</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":145,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L145"},"def":{"name":"s2?","visibility":"Public","body":"self == S2"},"external_var":false}]},{"html_id":"nats/NATS/JetStream/StreamConfig/DiscardPolicy","path":"NATS/JetStream/StreamConfig/DiscardPolicy.html","kind":"enum","full_name":"NATS::JetStream::StreamConfig::DiscardPolicy","name":"DiscardPolicy","abstract":false,"ancestors":[{"html_id":"nats/Enum","kind":"struct","full_name":"Enum","name":"Enum"},{"html_id":"nats/Comparable","kind":"module","full_name":"Comparable","name":"Comparable"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/stream_config.cr","line_number":50,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L50"}],"repository_name":"nats","program":false,"enum":true,"alias":false,"const":false,"constants":[{"id":"Old","name":"Old","value":"0","doc":"Drop old messages when the stream has reached a count or volume\nlimit","summary":"<p>Drop old messages when the stream has reached a count or volume limit</p>"},{"id":"New","name":"New","value":"1","doc":"Don't add new messages until old ones are discarded","summary":"<p>Don't add new messages until old ones are discarded</p>"}],"namespace":{"html_id":"nats/NATS/JetStream/StreamConfig","kind":"struct","full_name":"NATS::JetStream::StreamConfig","name":"StreamConfig"},"doc":"The `DiscardPolicy` tells the NATS server which end of the stream to\ntruncate when the stream is full  should we start dropping old\nmessages or avoid adding new ones?","summary":"<p>The <code><a href=\"../../../NATS/JetStream/StreamConfig/DiscardPolicy.html\">DiscardPolicy</a></code> tells the NATS server which end of the stream to truncate when the stream is full  should we start dropping old messages or avoid adding new ones?</p>","instance_methods":[{"html_id":"new?-instance-method","name":"new?","doc":"Returns `true` if this enum value equals `New`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../../NATS/JetStream/StreamConfig/DiscardPolicy.html#New\">New</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":56,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L56"},"def":{"name":"new?","visibility":"Public","body":"self == New"},"external_var":false},{"html_id":"old?-instance-method","name":"old?","doc":"Returns `true` if this enum value equals `Old`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../../NATS/JetStream/StreamConfig/DiscardPolicy.html#Old\">Old</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":53,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L53"},"def":{"name":"old?","visibility":"Public","body":"self == Old"},"external_var":false}]},{"html_id":"nats/NATS/JetStream/StreamConfig/Placement","path":"NATS/JetStream/StreamConfig/Placement.html","kind":"struct","full_name":"NATS::JetStream::StreamConfig::Placement","name":"Placement","abstract":false,"superclass":{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},"ancestors":[{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/stream_config.cr","line_number":59,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L59"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream/StreamConfig","kind":"struct","full_name":"NATS::JetStream::StreamConfig","name":"StreamConfig"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/jetstream/stream_config.cr","line_number":59,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L59"},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"},"external_var":false},{"html_id":"new(cluster:Nil|String=nil,tags:Nil|Array(String)=nil)-class-method","name":"new","abstract":false,"args":[{"name":"cluster","default_value":"nil","external_name":"cluster","restriction":"::Nil | ::String"},{"name":"tags","default_value":"nil","external_name":"tags","restriction":"::Nil | ::Array(::String)"}],"args_string":"(cluster : Nil | String = nil, tags : Nil | Array(String) = nil)","args_html":"(cluster : Nil | String = <span class=\"n\">nil</span>, tags : Nil | Array(String) = <span class=\"n\">nil</span>)","location":{"filename":"src/jetstream/stream_config.cr","line_number":63,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L63"},"def":{"name":"new","args":[{"name":"cluster","default_value":"nil","external_name":"cluster","restriction":"::Nil | ::String"},{"name":"tags","default_value":"nil","external_name":"tags","restriction":"::Nil | ::Array(::String)"}],"visibility":"Public","body":"_ = allocate\n_.initialize(cluster, tags)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"cluster:String|Nil-instance-method","name":"cluster","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":60,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L60"},"def":{"name":"cluster","return_type":"String | ::Nil","visibility":"Public","body":"@cluster"},"external_var":false},{"html_id":"tags:Array(String)-instance-method","name":"tags","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":61,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L61"},"def":{"name":"tags","return_type":"Array(String)","visibility":"Public","body":"if (__temp_159 = @tags).nil?\n  @tags = ([] of ::String)\nelse\n  __temp_159\nend"},"external_var":false}]},{"html_id":"nats/NATS/JetStream/StreamConfig/Republish","path":"NATS/JetStream/StreamConfig/Republish.html","kind":"struct","full_name":"NATS::JetStream::StreamConfig::Republish","name":"Republish","abstract":false,"superclass":{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},"ancestors":[{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/stream_config.cr","line_number":67,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L67"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream/StreamConfig","kind":"struct","full_name":"NATS::JetStream::StreamConfig","name":"StreamConfig"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/jetstream/stream_config.cr","line_number":67,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L67"},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"},"external_var":false},{"html_id":"new(*,source:String|Nil=nil,destination:String,headers_only:Bool|Nil=nil)-class-method","name":"new","abstract":false,"args":[{"name":"","external_name":"","restriction":""},{"name":"source","default_value":"nil","external_name":"source","restriction":"String | ::Nil"},{"name":"destination","external_name":"destination","restriction":"::String"},{"name":"headers_only","default_value":"nil","external_name":"headers_only","restriction":"::Bool | ::Nil"}],"args_string":"(*, source : String | Nil = nil, destination : String, headers_only : Bool | Nil = nil)","args_html":"(*, source : String | Nil = <span class=\"n\">nil</span>, destination : String, headers_only : Bool | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/jetstream/stream_config.cr","line_number":74,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L74"},"def":{"name":"new","args":[{"name":"","external_name":"","restriction":""},{"name":"source","default_value":"nil","external_name":"source","restriction":"String | ::Nil"},{"name":"destination","external_name":"destination","restriction":"::String"},{"name":"headers_only","default_value":"nil","external_name":"headers_only","restriction":"::Bool | ::Nil"}],"splat_index":0,"visibility":"Public","body":"_ = allocate\n_.initialize(source: source, destination: destination, headers_only: headers_only)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"destination:String-instance-method","name":"destination","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":71,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L71"},"def":{"name":"destination","return_type":"String","visibility":"Public","body":"@destination"},"external_var":false},{"html_id":"headers_only?:Bool|Nil-instance-method","name":"headers_only?","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":72,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L72"},"def":{"name":"headers_only?","return_type":"Bool | ::Nil","visibility":"Public","body":"@headers_only"},"external_var":false},{"html_id":"source:String|Nil-instance-method","name":"source","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":69,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L69"},"def":{"name":"source","return_type":"String | ::Nil","visibility":"Public","body":"@source"},"external_var":false}]},{"html_id":"nats/NATS/JetStream/StreamConfig/RetentionPolicy","path":"NATS/JetStream/StreamConfig/RetentionPolicy.html","kind":"enum","full_name":"NATS::JetStream::StreamConfig::RetentionPolicy","name":"RetentionPolicy","abstract":false,"ancestors":[{"html_id":"nats/Enum","kind":"struct","full_name":"Enum","name":"Enum"},{"html_id":"nats/Comparable","kind":"module","full_name":"Comparable","name":"Comparable"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/stream_config.cr","line_number":31,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L31"}],"repository_name":"nats","program":false,"enum":true,"alias":false,"const":false,"constants":[{"id":"Limits","name":"Limits","value":"0","doc":"Discard messages when the stream has reached the limit of either\nthe number of messages or the total stream size in bytes, or the\nmessage's max age has passed.","summary":"<p>Discard messages when the stream has reached the limit of either the number of messages or the total stream size in bytes, or the message's max age has passed.</p>"},{"id":"Interest","name":"Interest","value":"1","doc":"Discard a message when all subscribed consumers have acknowledged\nit to guarantee delivery but not keep the message in memory. This\nis the default behavior of AMQP.","summary":"<p>Discard a message when all subscribed consumers have acknowledged it to guarantee delivery but not keep the message in memory.</p>"},{"id":"Workqueue","name":"Workqueue","value":"2","doc":"Discard a message when the first consumer has acknowledged it, as\nin a work queue like Sidekiq.","summary":"<p>Discard a message when the first consumer has acknowledged it, as in a work queue like Sidekiq.</p>"}],"namespace":{"html_id":"nats/NATS/JetStream/StreamConfig","kind":"struct","full_name":"NATS::JetStream::StreamConfig","name":"StreamConfig"},"doc":"The `RetentionPolicy` tells the NATS server when messages can be\ndiscarded. Your options are to wait until the a quantity/volume/time\nlimit has been reached, _all_ consumers have acknowledged, or _any_\nconsumers have acknowledged.\n\n```\njetstream.stream.create(\n  # ...\n  retention: :workqueue,\n)\n```","summary":"<p>The <code><a href=\"../../../NATS/JetStream/StreamConfig/RetentionPolicy.html\">RetentionPolicy</a></code> tells the NATS server when messages can be discarded.</p>","instance_methods":[{"html_id":"interest?-instance-method","name":"interest?","doc":"Returns `true` if this enum value equals `Interest`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../../NATS/JetStream/StreamConfig/RetentionPolicy.html#Interest\">Interest</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":40,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L40"},"def":{"name":"interest?","visibility":"Public","body":"self == Interest"},"external_var":false},{"html_id":"limits?-instance-method","name":"limits?","doc":"Returns `true` if this enum value equals `Limits`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../../NATS/JetStream/StreamConfig/RetentionPolicy.html#Limits\">Limits</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":35,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L35"},"def":{"name":"limits?","visibility":"Public","body":"self == Limits"},"external_var":false},{"html_id":"workqueue?-instance-method","name":"workqueue?","doc":"Returns `true` if this enum value equals `Workqueue`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../../NATS/JetStream/StreamConfig/RetentionPolicy.html#Workqueue\">Workqueue</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":44,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L44"},"def":{"name":"workqueue?","visibility":"Public","body":"self == Workqueue"},"external_var":false}]},{"html_id":"nats/NATS/JetStream/StreamConfig/Storage","path":"NATS/JetStream/StreamConfig/Storage.html","kind":"enum","full_name":"NATS::JetStream::StreamConfig::Storage","name":"Storage","abstract":false,"ancestors":[{"html_id":"nats/Enum","kind":"struct","full_name":"Enum","name":"Enum"},{"html_id":"nats/Comparable","kind":"module","full_name":"Comparable","name":"Comparable"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/stream_config.cr","line_number":8,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L8"}],"repository_name":"nats","program":false,"enum":true,"alias":false,"const":false,"constants":[{"id":"Memory","name":"Memory","value":"0","doc":"Store messages in memory. This is the fastest, but is not durable.\nIf the NATS server is restarted for any reason, the stream will\nbe dropped. Using this option may also increase the amount of\nmemory required by your NATS server. Use with caution.","summary":"<p>Store messages in memory.</p>"},{"id":"File","name":"File","value":"1","doc":"Store messages on disk. Always use this if your system depends on\n100% delivery.","summary":"<p>Store messages on disk.</p>"}],"namespace":{"html_id":"nats/NATS/JetStream/StreamConfig","kind":"struct","full_name":"NATS::JetStream::StreamConfig","name":"StreamConfig"},"doc":"The `Storage` parameter tells the NATS server how to store the\nmessages in the stream.","summary":"<p>The <code><a href=\"../../../NATS/JetStream/StreamConfig/Storage.html\">Storage</a></code> parameter tells the NATS server how to store the messages in the stream.</p>","instance_methods":[{"html_id":"file?-instance-method","name":"file?","doc":"Returns `true` if this enum value equals `File`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../../NATS/JetStream/StreamConfig/Storage.html#File\">File</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":17,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L17"},"def":{"name":"file?","visibility":"Public","body":"self == File"},"external_var":false},{"html_id":"memory?-instance-method","name":"memory?","doc":"Returns `true` if this enum value equals `Memory`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../../NATS/JetStream/StreamConfig/Storage.html#Memory\">Memory</a></code></p>","abstract":false,"location":{"filename":"src/jetstream/stream_config.cr","line_number":13,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_config.cr#L13"},"def":{"name":"memory?","visibility":"Public","body":"self == Memory"},"external_var":false}]}]},{"html_id":"nats/NATS/JetStream/StreamGetMsgResponse","path":"NATS/JetStream/StreamGetMsgResponse.html","kind":"struct","full_name":"NATS::JetStream::StreamGetMsgResponse","name":"StreamGetMsgResponse","abstract":false,"superclass":{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},"ancestors":[{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/stream_get_msg_response.cr","line_number":6,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_get_msg_response.cr#L6"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/jetstream/stream_get_msg_response.cr","line_number":6,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_get_msg_response.cr#L6"},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"},"external_var":false},{"html_id":"new(*,message:NATS::JetStream::StreamGetMsgResponse::Message)-class-method","name":"new","abstract":false,"args":[{"name":"","external_name":"","restriction":""},{"name":"message","external_name":"message","restriction":"::NATS::JetStream::StreamGetMsgResponse::Message"}],"args_string":"(*, message : NATS::JetStream::StreamGetMsgResponse::Message)","args_html":"(*, message : <a href=\"../../NATS/JetStream/StreamGetMsgResponse/Message.html\">NATS::JetStream::StreamGetMsgResponse::Message</a>)","location":{"filename":"src/jetstream/stream_get_msg_response.cr","line_number":9,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_get_msg_response.cr#L9"},"def":{"name":"new","args":[{"name":"","external_name":"","restriction":""},{"name":"message","external_name":"message","restriction":"::NATS::JetStream::StreamGetMsgResponse::Message"}],"splat_index":0,"visibility":"Public","body":"_ = allocate\n_.initialize(message: message)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"message:Message-instance-method","name":"message","abstract":false,"location":{"filename":"src/jetstream/stream_get_msg_response.cr","line_number":7,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_get_msg_response.cr#L7"},"def":{"name":"message","return_type":"Message","visibility":"Public","body":"@message"},"external_var":false}],"types":[{"html_id":"nats/NATS/JetStream/StreamGetMsgResponse/Message","path":"NATS/JetStream/StreamGetMsgResponse/Message.html","kind":"struct","full_name":"NATS::JetStream::StreamGetMsgResponse::Message","name":"Message","abstract":false,"superclass":{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},"ancestors":[{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/stream_get_msg_response.cr","line_number":12,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_get_msg_response.cr#L12"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"included_modules":[{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"}],"namespace":{"html_id":"nats/NATS/JetStream/StreamGetMsgResponse","kind":"struct","full_name":"NATS::JetStream::StreamGetMsgResponse","name":"StreamGetMsgResponse"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/jetstream/stream_get_msg_response.cr","line_number":13,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_get_msg_response.cr#L13"},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"},"external_var":false},{"html_id":"new(*,subject:String,seq:Int64,data:Slice(UInt8),headers:Nil|Hash(String,String),time:Time)-class-method","name":"new","abstract":false,"args":[{"name":"","external_name":"","restriction":""},{"name":"subject","external_name":"subject","restriction":"::String"},{"name":"seq","external_name":"seq","restriction":"::Int64"},{"name":"data","external_name":"data","restriction":"::Slice(::UInt8)"},{"name":"headers","external_name":"headers","restriction":"::Nil | ::Hash(::String, ::String)"},{"name":"time","external_name":"time","restriction":"::Time"}],"args_string":"(*, subject : String, seq : Int64, data : Slice(UInt8), headers : Nil | Hash(String, String), time : Time)","args_html":"(*, subject : String, seq : Int64, data : Slice(UInt8), headers : Nil | Hash(String, String), time : Time)","location":{"filename":"src/jetstream/stream_get_msg_response.cr","line_number":23,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_get_msg_response.cr#L23"},"def":{"name":"new","args":[{"name":"","external_name":"","restriction":""},{"name":"subject","external_name":"subject","restriction":"::String"},{"name":"seq","external_name":"seq","restriction":"::Int64"},{"name":"data","external_name":"data","restriction":"::Slice(::UInt8)"},{"name":"headers","external_name":"headers","restriction":"::Nil | ::Hash(::String, ::String)"},{"name":"time","external_name":"time","restriction":"::Time"}],"splat_index":0,"visibility":"Public","body":"_ = allocate\n_.initialize(subject: subject, seq: seq, data: data, headers: headers, time: time)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"data:Bytes-instance-method","name":"data","abstract":false,"location":{"filename":"src/jetstream/stream_get_msg_response.cr","line_number":18,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_get_msg_response.cr#L18"},"def":{"name":"data","return_type":"Bytes","visibility":"Public","body":"@data"},"external_var":false},{"html_id":"headers:Headers-instance-method","name":"headers","abstract":false,"location":{"filename":"src/jetstream/stream_get_msg_response.cr","line_number":20,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_get_msg_response.cr#L20"},"def":{"name":"headers","return_type":"Headers","visibility":"Public","body":"if (__temp_167 = @headers).nil?\n  @headers = (Headers.new)\nelse\n  __temp_167\nend"},"external_var":false},{"html_id":"seq:Int64-instance-method","name":"seq","abstract":false,"location":{"filename":"src/jetstream/stream_get_msg_response.cr","line_number":16,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_get_msg_response.cr#L16"},"def":{"name":"seq","return_type":"Int64","visibility":"Public","body":"@seq"},"external_var":false},{"html_id":"subject:String-instance-method","name":"subject","abstract":false,"location":{"filename":"src/jetstream/stream_get_msg_response.cr","line_number":15,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_get_msg_response.cr#L15"},"def":{"name":"subject","return_type":"String","visibility":"Public","body":"@subject"},"external_var":false},{"html_id":"time:Time-instance-method","name":"time","abstract":false,"location":{"filename":"src/jetstream/stream_get_msg_response.cr","line_number":21,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_get_msg_response.cr#L21"},"def":{"name":"time","return_type":"Time","visibility":"Public","body":"@time"},"external_var":false}],"types":[{"html_id":"nats/NATS/JetStream/StreamGetMsgResponse/Message/Base64Data","path":"NATS/JetStream/StreamGetMsgResponse/Message/Base64Data.html","kind":"module","full_name":"NATS::JetStream::StreamGetMsgResponse::Message::Base64Data","name":"Base64Data","abstract":false,"locations":[{"filename":"src/jetstream/stream_get_msg_response.cr","line_number":33,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_get_msg_response.cr#L33"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream/StreamGetMsgResponse/Message","kind":"struct","full_name":"NATS::JetStream::StreamGetMsgResponse::Message","name":"Message"},"class_methods":[{"html_id":"from_json(json:JSON::PullParser)-class-method","name":"from_json","abstract":false,"args":[{"name":"json","external_name":"json","restriction":"JSON::PullParser"}],"args_string":"(json : JSON::PullParser)","args_html":"(json : JSON::PullParser)","location":{"filename":"src/jetstream/stream_get_msg_response.cr","line_number":34,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_get_msg_response.cr#L34"},"def":{"name":"from_json","args":[{"name":"json","external_name":"json","restriction":"JSON::PullParser"}],"visibility":"Public","body":"::Base64.decode(json.read_string)"},"external_var":false},{"html_id":"to_json(value:Bytes,json:JSON::Builder)-class-method","name":"to_json","abstract":false,"args":[{"name":"value","external_name":"value","restriction":"Bytes"},{"name":"json","external_name":"json","restriction":"JSON::Builder"}],"args_string":"(value : Bytes, json : JSON::Builder)","args_html":"(value : Bytes, json : JSON::Builder)","location":{"filename":"src/jetstream/stream_get_msg_response.cr","line_number":38,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_get_msg_response.cr#L38"},"def":{"name":"to_json","args":[{"name":"value","external_name":"value","restriction":"Bytes"},{"name":"json","external_name":"json","restriction":"JSON::Builder"}],"visibility":"Public","body":"json.string(::Base64.encode(value))"},"external_var":false}]},{"html_id":"nats/NATS/JetStream/StreamGetMsgResponse/Message/HeadersConverter","path":"NATS/JetStream/StreamGetMsgResponse/Message/HeadersConverter.html","kind":"module","full_name":"NATS::JetStream::StreamGetMsgResponse::Message::HeadersConverter","name":"HeadersConverter","abstract":false,"locations":[{"filename":"src/jetstream/stream_get_msg_response.cr","line_number":43,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_get_msg_response.cr#L43"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream/StreamGetMsgResponse/Message","kind":"struct","full_name":"NATS::JetStream::StreamGetMsgResponse::Message","name":"Message"},"class_methods":[{"html_id":"from_json(json:JSON::PullParser)-class-method","name":"from_json","abstract":false,"args":[{"name":"json","external_name":"json","restriction":"JSON::PullParser"}],"args_string":"(json : JSON::PullParser)","args_html":"(json : JSON::PullParser)","location":{"filename":"src/jetstream/stream_get_msg_response.cr","line_number":44,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_get_msg_response.cr#L44"},"def":{"name":"from_json","args":[{"name":"json","external_name":"json","restriction":"JSON::PullParser"}],"visibility":"Public","body":"if string = json.read_string_or_null\n  raw = Base64.decode_string(string)\n  header_count = (raw.count('\\n')) - 2\n  headers = Headers.new(initial_capacity: header_count)\n\n  raw.each_line do |line|\n    if separator_index = line.index(':')\n      key = line[0...separator_index]\n      value = line[(separator_index + 2)..]\n      headers[key] = value\n    end\n  end\n\n  headers\nend"},"external_var":false},{"html_id":"to_json(headers:NATS::Headers,json:JSON::Builder)-class-method","name":"to_json","abstract":false,"args":[{"name":"headers","external_name":"headers","restriction":"NATS::Headers"},{"name":"json","external_name":"json","restriction":"JSON::Builder"}],"args_string":"(headers : NATS::Headers, json : JSON::Builder)","args_html":"(headers : <a href=\"../../../../NATS/Headers.html\">NATS::Headers</a>, json : JSON::Builder)","location":{"filename":"src/jetstream/stream_get_msg_response.cr","line_number":66,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_get_msg_response.cr#L66"},"def":{"name":"to_json","args":[{"name":"headers","external_name":"headers","restriction":"NATS::Headers"},{"name":"json","external_name":"json","restriction":"JSON::Builder"}],"visibility":"Public","body":"json.object do\n  headers.each do |__temp_166|\n    key, value = __temp_166\n    json.field(key, value)\n  end\nend"},"external_var":false}]}]}]},{"html_id":"nats/NATS/JetStream/StreamListResponse","path":"NATS/JetStream/StreamListResponse.html","kind":"struct","full_name":"NATS::JetStream::StreamListResponse","name":"StreamListResponse","abstract":false,"superclass":{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},"ancestors":[{"html_id":"nats/Enumerable","kind":"module","full_name":"Enumerable","name":"Enumerable"},{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/stream_list_response.cr","line_number":8,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_list_response.cr#L8"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"included_modules":[{"html_id":"nats/Enumerable","kind":"module","full_name":"Enumerable","name":"Enumerable"}],"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"},"constructors":[{"html_id":"new(js:JetStream::Client,json:JSON::PullParser,subject:String|Nil=nil)-class-method","name":"new","abstract":false,"args":[{"name":"js","external_name":"js","restriction":"JetStream::Client"},{"name":"json","external_name":"json","restriction":"JSON::PullParser"},{"name":"subject","default_value":"nil","external_name":"subject","restriction":"String | ::Nil"}],"args_string":"(js : JetStream::Client, json : JSON::PullParser, subject : String | Nil = nil)","args_html":"(js : <a href=\"../../NATS/JetStream/Client.html\">JetStream::Client</a>, json : JSON::PullParser, subject : String | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/jetstream/stream_list_response.cr","line_number":20,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_list_response.cr#L20"},"def":{"name":"new","args":[{"name":"js","external_name":"js","restriction":"JetStream::Client"},{"name":"json","external_name":"json","restriction":"JSON::PullParser"},{"name":"subject","default_value":"nil","external_name":"subject","restriction":"String | ::Nil"}],"visibility":"Public","body":"response = new(json)\nresponse.js = js\nresponse.subject = subject\nresponse\n"},"external_var":false},{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/jetstream/stream_list_response.cr","line_number":8,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_list_response.cr#L8"},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"},"external_var":false}],"instance_methods":[{"html_id":"each(&block:Stream->):Nil-instance-method","name":"each","doc":"Must yield this collection's elements to the block.","summary":"<p>Must yield this collection's elements to the block.</p>","abstract":false,"location":{"filename":"src/jetstream/stream_list_response.cr","line_number":27,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_list_response.cr#L27"},"def":{"name":"each","yields":1,"block_arity":1,"block_arg":{"name":"block","external_name":"block","restriction":"(Stream ->)"},"return_type":"Nil","visibility":"Public","body":"streams.each do |s|\n  yield s\nend\nnew_offset = offset + limit\ntotal = self.total\nwhile total > new_offset\n  response = js.stream.list(subject: subject, offset: new_offset, limit: limit)\n\n  response.streams.each do |s|\n    yield s\n  end\n  total = response.total\n  new_offset = response.offset + response.limit\nend\n"},"external_var":false},{"html_id":"limit:Int64-instance-method","name":"limit","abstract":false,"location":{"filename":"src/jetstream/stream_list_response.cr","line_number":13,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_list_response.cr#L13"},"def":{"name":"limit","return_type":"Int64","visibility":"Public","body":"@limit"},"external_var":false},{"html_id":"offset:Int64-instance-method","name":"offset","abstract":false,"location":{"filename":"src/jetstream/stream_list_response.cr","line_number":12,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_list_response.cr#L12"},"def":{"name":"offset","return_type":"Int64","visibility":"Public","body":"@offset"},"external_var":false},{"html_id":"streams:Array(Stream)-instance-method","name":"streams","abstract":false,"location":{"filename":"src/jetstream/stream_list_response.cr","line_number":14,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_list_response.cr#L14"},"def":{"name":"streams","return_type":"Array(Stream)","visibility":"Public","body":"if (__temp_164 = @streams).nil?\n  @streams = ([] of Stream)\nelse\n  __temp_164\nend"},"external_var":false},{"html_id":"total:Int64-instance-method","name":"total","abstract":false,"location":{"filename":"src/jetstream/stream_list_response.cr","line_number":11,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_list_response.cr#L11"},"def":{"name":"total","return_type":"Int64","visibility":"Public","body":"@total"},"external_var":false}]},{"html_id":"nats/NATS/JetStream/Streams","path":"NATS/JetStream/Streams.html","kind":"struct","full_name":"NATS::JetStream::Streams","name":"Streams","abstract":false,"superclass":{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},"ancestors":[{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/streams.cr","line_number":15,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/streams.cr#L15"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"},"doc":"A stream in NATS JetStream represents the history of messages\npertaining to a given domain. When you publish a message to a subject\nthat a stream is monitoring, the stream then adds that message to its\nhistory in the order it was published.","summary":"<p>A stream in NATS JetStream represents the history of messages pertaining to a given domain.</p>","constructors":[{"html_id":"new(nats:NATS::Client)-class-method","name":"new","abstract":false,"args":[{"name":"nats","external_name":"nats","restriction":"::NATS::Client"}],"args_string":"(nats : NATS::Client)","args_html":"(nats : <a href=\"../../NATS/Client.html\">NATS::Client</a>)","location":{"filename":"src/jetstream/streams.cr","line_number":16,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/streams.cr#L16"},"def":{"name":"new","args":[{"name":"nats","external_name":"nats","restriction":"::NATS::Client"}],"visibility":"Public","body":"_ = allocate\n_.initialize(nats)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"create(storage:StreamConfig::Storage,retention:StreamConfig::RetentionPolicy|Nil=nil,discard:StreamConfig::DiscardPolicy|Nil=nil,compression:StreamConfig::Compression=:none,**kwargs):Stream-instance-method","name":"create","doc":"Create a stream of the given storage type and with the given\nproperties, which are passed unmodified to\n`NATS::JetStream::StreamConfig.new`.","summary":"<p>Create a stream of the given storage type and with the given properties, which are passed unmodified to <code><a href=\"../../NATS/JetStream/StreamConfig.html#new%28pull%3AJSON%3A%3APullParser%29-class-method\">NATS::JetStream::StreamConfig.new</a></code>.</p>","abstract":false,"args":[{"name":"storage","external_name":"storage","restriction":"StreamConfig::Storage"},{"name":"retention","default_value":"nil","external_name":"retention","restriction":"StreamConfig::RetentionPolicy | ::Nil"},{"name":"discard","default_value":"nil","external_name":"discard","restriction":"StreamConfig::DiscardPolicy | ::Nil"},{"name":"compression","default_value":":none","external_name":"compression","restriction":"StreamConfig::Compression"}],"args_string":"(storage : StreamConfig::Storage, retention : StreamConfig::RetentionPolicy | Nil = nil, discard : StreamConfig::DiscardPolicy | Nil = nil, compression : StreamConfig::Compression = :none, **kwargs) : Stream","args_html":"(storage : <a href=\"../../NATS/JetStream/StreamConfig/Storage.html\">StreamConfig::Storage</a>, retention : <a href=\"../../NATS/JetStream/StreamConfig/RetentionPolicy.html\">StreamConfig::RetentionPolicy</a> | Nil = <span class=\"n\">nil</span>, discard : <a href=\"../../NATS/JetStream/StreamConfig/DiscardPolicy.html\">StreamConfig::DiscardPolicy</a> | Nil = <span class=\"n\">nil</span>, compression : <a href=\"../../NATS/JetStream/StreamConfig/Compression.html\">StreamConfig::Compression</a> = <span class=\"n\">:none</span>, **kwargs) : <a href=\"../../NATS/JetStream/Stream.html\">Stream</a>","location":{"filename":"src/jetstream/streams.cr","line_number":22,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/streams.cr#L22"},"def":{"name":"create","args":[{"name":"storage","external_name":"storage","restriction":"StreamConfig::Storage"},{"name":"retention","default_value":"nil","external_name":"retention","restriction":"StreamConfig::RetentionPolicy | ::Nil"},{"name":"discard","default_value":"nil","external_name":"discard","restriction":"StreamConfig::DiscardPolicy | ::Nil"},{"name":"compression","default_value":":none","external_name":"compression","restriction":"StreamConfig::Compression"}],"double_splat":{"name":"kwargs","external_name":"kwargs","restriction":""},"return_type":"Stream","visibility":"Public","body":"begin\n  create_stream = StreamConfig.new(**kwargs, storage: storage, retention: retention, discard: discard, compression: compression)\n\n  if create_stream.name.includes?('.')\n    raise(Error.new(\"Cannot create stream with '.' in the name\"))\n  end\n\n  if response = @nats.request(\"$JS.API.STREAM.CREATE.#{create_stream.name}\", create_stream.to_json)\n    case parsed = (Stream | ErrorResponse).from_json(String.new(response.body))\n    in ErrorResponse\n      raise(Error.new(\"#{parsed.error.description} (#{parsed.error.code})\"))\n    in Stream\n      parsed\n    end\n  else\n    raise(Error.new(\"Did not receive a response from NATS JetStream\"))\n  end\nrescue ex\n  raise(ex)\nend"},"external_var":false},{"html_id":"delete(stream:JetStream::Stream)-instance-method","name":"delete","doc":"Delete the given stream","summary":"<p>Delete the given stream</p>","abstract":false,"args":[{"name":"stream","external_name":"stream","restriction":"JetStream::Stream"}],"args_string":"(stream : JetStream::Stream)","args_html":"(stream : <a href=\"../../NATS/JetStream/Stream.html\">JetStream::Stream</a>)","location":{"filename":"src/jetstream/streams.cr","line_number":87,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/streams.cr#L87"},"def":{"name":"delete","args":[{"name":"stream","external_name":"stream","restriction":"JetStream::Stream"}],"visibility":"Public","body":"delete(stream.config.name)"},"external_var":false},{"html_id":"delete(stream:String)-instance-method","name":"delete","doc":"Delete the stream with the given name","summary":"<p>Delete the stream with the given name</p>","abstract":false,"args":[{"name":"stream","external_name":"stream","restriction":"String"}],"args_string":"(stream : String)","args_html":"(stream : String)","location":{"filename":"src/jetstream/streams.cr","line_number":92,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/streams.cr#L92"},"def":{"name":"delete","args":[{"name":"stream","external_name":"stream","restriction":"String"}],"visibility":"Public","body":"@nats.request(\"$JS.API.STREAM.DELETE.#{stream}\")"},"external_var":false},{"html_id":"direct_get(stream:String,*,last_by_subject:String):JetStream::StreamGetMsgResponse|Nil-instance-method","name":"direct_get","doc":"The `get_msg` API involves some administrative overhead and usually routes\nto the stream's primary node in the NATS cluster. The `direct_get` method\nuses the `DIRECT.GET` API which allows any server hosting the stream\n(including replicas) to respond with the message data. Specifying\n`last_by_subject` allows you to get the last message in a stream that was\npublished to a specific subject. This is used by `NATS::KV` internally to\nfetch values for a given key from replicas for the KV's backing stream.\n\nNOTE: In order to use this API, the stream _must_ have been created with\n[`allow_direct`](https://jgaskins.dev/nats/NATS/JetStream/StreamConfig.html#allow_direct%3F%3ABool%7CNil-instance-method)\nset to `true`. For performance reasons, the client does not perform this\ncheck.","summary":"<p>The <code><a href=\"../../NATS/JetStream/Streams.html#get_msg%28stream%3AString%2C%2A%2Clast_by_subject%3AString%29-instance-method\">#get_msg</a></code> API involves some administrative overhead and usually routes to the stream's primary node in the NATS cluster.</p>","abstract":false,"args":[{"name":"stream","external_name":"stream","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"last_by_subject","external_name":"last_by_subject","restriction":"String"}],"args_string":"(stream : String, *, last_by_subject : String) : JetStream::StreamGetMsgResponse | Nil","args_html":"(stream : String, *, last_by_subject : String) : <a href=\"../../NATS/JetStream/StreamGetMsgResponse.html\">JetStream::StreamGetMsgResponse</a> | Nil","location":{"filename":"src/jetstream/streams.cr","line_number":133,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/streams.cr#L133"},"def":{"name":"direct_get","args":[{"name":"stream","external_name":"stream","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"last_by_subject","external_name":"last_by_subject","restriction":"String"}],"splat_index":1,"return_type":"JetStream::StreamGetMsgResponse | ::Nil","visibility":"Public","body":"direct_get(stream, {last_by_subj: last_by_subject})"},"external_var":false},{"html_id":"direct_get(stream:String,*,sequence:Int,next_by_subject:String|Nil=nil)-instance-method","name":"direct_get","doc":"The `get_msg` API involves some administrative overhead and usually routes\nto the stream's primary node in the NATS cluster. The `direct_get` method\nuses the `DIRECT.GET` API which allows any server hosting the stream\n(including replicas) to respond with the message data. Specifying\n`last_by_subject` allows you to get the last message in a stream that was\npublished to a specific subject. This is used by `NATS::KV` internally to\nfetch values for a given key from replicas for the KV's backing stream.\n\nNOTE: In order to use this API, the stream _must_ have been created with\n[`allow_direct`](https://jgaskins.dev/nats/NATS/JetStream/StreamConfig.html#allow_direct%3F%3ABool%7CNil-instance-method)\nset to `true`. For performance reasons, the client does not perform this\ncheck.","summary":"<p>The <code><a href=\"../../NATS/JetStream/Streams.html#get_msg%28stream%3AString%2C%2A%2Clast_by_subject%3AString%29-instance-method\">#get_msg</a></code> API involves some administrative overhead and usually routes to the stream's primary node in the NATS cluster.</p>","abstract":false,"args":[{"name":"stream","external_name":"stream","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"sequence","external_name":"sequence","restriction":"Int"},{"name":"next_by_subject","default_value":"nil","external_name":"next_by_subject","restriction":"String | ::Nil"}],"args_string":"(stream : String, *, sequence : Int, next_by_subject : String | Nil = nil)","args_html":"(stream : String, *, sequence : Int, next_by_subject : String | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/jetstream/streams.cr","line_number":149,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/streams.cr#L149"},"def":{"name":"direct_get","args":[{"name":"stream","external_name":"stream","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"sequence","external_name":"sequence","restriction":"Int"},{"name":"next_by_subject","default_value":"nil","external_name":"next_by_subject","restriction":"String | ::Nil"}],"splat_index":1,"visibility":"Public","body":"direct_get(stream, {seq: sequence, next_by_subj: next_by_subject})"},"external_var":false},{"html_id":"get_msg(stream:String,*,last_by_subject:String)-instance-method","name":"get_msg","abstract":false,"args":[{"name":"stream","external_name":"stream","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"last_by_subject","external_name":"last_by_subject","restriction":"String"}],"args_string":"(stream : String, *, last_by_subject : String)","args_html":"(stream : String, *, last_by_subject : String)","location":{"filename":"src/jetstream/streams.cr","line_number":96,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/streams.cr#L96"},"def":{"name":"get_msg","args":[{"name":"stream","external_name":"stream","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"last_by_subject","external_name":"last_by_subject","restriction":"String"}],"splat_index":1,"visibility":"Public","body":"get_msg(stream, {last_by_subj: last_by_subject})"},"external_var":false},{"html_id":"get_msg(stream:String,*,sequence:Int,next_by_subject:String|Nil=nil)-instance-method","name":"get_msg","abstract":false,"args":[{"name":"stream","external_name":"stream","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"sequence","external_name":"sequence","restriction":"Int"},{"name":"next_by_subject","default_value":"nil","external_name":"next_by_subject","restriction":"String | ::Nil"}],"args_string":"(stream : String, *, sequence : Int, next_by_subject : String | Nil = nil)","args_html":"(stream : String, *, sequence : Int, next_by_subject : String | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/jetstream/streams.cr","line_number":100,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/streams.cr#L100"},"def":{"name":"get_msg","args":[{"name":"stream","external_name":"stream","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"sequence","external_name":"sequence","restriction":"Int"},{"name":"next_by_subject","default_value":"nil","external_name":"next_by_subject","restriction":"String | ::Nil"}],"splat_index":1,"visibility":"Public","body":"get_msg(stream, {seq: sequence, next_by_subj: next_by_subject})"},"external_var":false},{"html_id":"info(name:String):Stream|Nil-instance-method","name":"info","doc":"Get the current state of the stream with the given `name`","summary":"<p>Get the current state of the stream with the given <code>name</code></p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"}],"args_string":"(name : String) : Stream | Nil","args_html":"(name : String) : <a href=\"../../NATS/JetStream/Stream.html\">Stream</a> | Nil","location":{"filename":"src/jetstream/streams.cr","line_number":69,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/streams.cr#L69"},"def":{"name":"info","args":[{"name":"name","external_name":"name","restriction":"String"}],"return_type":"Stream | ::Nil","visibility":"Public","body":"if response = @nats.request(\"$JS.API.STREAM.INFO.#{name}\")\n  case parsed = (Stream | ErrorResponse).from_json(String.new(response.body))\n  in Stream\n    parsed\n  in ErrorResponse\n    if parsed.error.err_code.stream_not_found?\n      nil\n    else\n      raise(Error.new(parsed.error.description))\n    end\n  end\nelse\n  raise(Error.new(\"Response timed out while fetching stream #{name.inspect}\"))\nend"},"external_var":false},{"html_id":"list(subject:String|Nil=nil,offset:Int|Nil=nil,limit:Int|Nil=nil)-instance-method","name":"list","doc":"List all available streams","summary":"<p>List all available streams</p>","abstract":false,"args":[{"name":"subject","default_value":"nil","external_name":"subject","restriction":"String | ::Nil"},{"name":"offset","default_value":"nil","external_name":"offset","restriction":"Int | ::Nil"},{"name":"limit","default_value":"nil","external_name":"limit","restriction":"Int | ::Nil"}],"args_string":"(subject : String | Nil = nil, offset : Int | Nil = nil, limit : Int | Nil = nil)","args_html":"(subject : String | Nil = <span class=\"n\">nil</span>, offset : Int | Nil = <span class=\"n\">nil</span>, limit : Int | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/jetstream/streams.cr","line_number":56,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/streams.cr#L56"},"def":{"name":"list","args":[{"name":"subject","default_value":"nil","external_name":"subject","restriction":"String | ::Nil"},{"name":"offset","default_value":"nil","external_name":"offset","restriction":"Int | ::Nil"},{"name":"limit","default_value":"nil","external_name":"limit","restriction":"Int | ::Nil"}],"visibility":"Public","body":"body = {subject: subject, offset: offset, limit: limit}.to_json\n\nif response = @nats.request(\"$JS.API.STREAM.LIST\", body)\n  StreamListResponse.new(@nats.jetstream, json: JSON::PullParser.new(String.new(response.body)), subject: subject)\nelse\n  raise(Error.new(\"Did not receive a response from NATS JetStream\"))\nend\n"},"external_var":false},{"html_id":"purge(stream:String,subject:String):Int64-instance-method","name":"purge","abstract":false,"args":[{"name":"stream","external_name":"stream","restriction":"String"},{"name":"subject","external_name":"subject","restriction":"String"}],"args_string":"(stream : String, subject : String) : Int64","args_html":"(stream : String, subject : String) : Int64","location":{"filename":"src/jetstream/streams.cr","line_number":185,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/streams.cr#L185"},"def":{"name":"purge","args":[{"name":"stream","external_name":"stream","restriction":"String"},{"name":"subject","external_name":"subject","restriction":"String"}],"return_type":"Int64","visibility":"Public","body":"if response = @nats.request(\"$JS.API.STREAM.PURGE.#{stream}\", {filter: subject}.to_json)\n  case parsed = (PurgeStreamResponse | ErrorResponse).from_json(String.new(response.body))\n  in PurgeStreamResponse\n    parsed.purged\n  in ErrorResponse\n    raise(Error.new(parsed.error.description))\n  end\nelse\n  raise(Error.new(\"Did not receive a response when purging stream #{stream.inspect} of subject #{subject.inspect}\"))\nend"},"external_var":false}],"types":[{"html_id":"nats/NATS/JetStream/Streams/PurgeStreamResponse","path":"NATS/JetStream/Streams/PurgeStreamResponse.html","kind":"struct","full_name":"NATS::JetStream::Streams::PurgeStreamResponse","name":"PurgeStreamResponse","abstract":false,"superclass":{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},"ancestors":[{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/streams.cr","line_number":198,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/streams.cr#L198"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"included_modules":[{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"}],"namespace":{"html_id":"nats/NATS/JetStream/Streams","kind":"struct","full_name":"NATS::JetStream::Streams","name":"Streams"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/jetstream/streams.cr","line_number":199,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/streams.cr#L199"},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"},"external_var":false}],"instance_methods":[{"html_id":"purged:Int64-instance-method","name":"purged","abstract":false,"location":{"filename":"src/jetstream/streams.cr","line_number":201,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/streams.cr#L201"},"def":{"name":"purged","return_type":"Int64","visibility":"Public","body":"@purged"},"external_var":false}]}]},{"html_id":"nats/NATS/JetStream/StreamSource","path":"NATS/JetStream/StreamSource.html","kind":"struct","full_name":"NATS::JetStream::StreamSource","name":"StreamSource","abstract":false,"superclass":{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},"ancestors":[{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/stream_source.cr","line_number":5,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_source.cr#L5"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/jetstream/stream_source.cr","line_number":5,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_source.cr#L5"},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"},"external_var":false},{"html_id":"new(name:String,opt_start_seq:UInt64|Nil=nil,opt_start_time:Time|Nil=nil,filter_subject:Nil|String=nil,external:NATS::JetStream::ExternalStream|Nil=nil)-class-method","name":"new","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"::String"},{"name":"opt_start_seq","default_value":"nil","external_name":"opt_start_seq","restriction":"::UInt64 | ::Nil"},{"name":"opt_start_time","default_value":"nil","external_name":"opt_start_time","restriction":"::Time | ::Nil"},{"name":"filter_subject","default_value":"nil","external_name":"filter_subject","restriction":"::Nil | ::String"},{"name":"external","default_value":"nil","external_name":"external","restriction":"::NATS::JetStream::ExternalStream | ::Nil"}],"args_string":"(name : String, opt_start_seq : UInt64 | Nil = nil, opt_start_time : Time | Nil = nil, filter_subject : Nil | String = nil, external : NATS::JetStream::ExternalStream | Nil = nil)","args_html":"(name : String, opt_start_seq : UInt64 | Nil = <span class=\"n\">nil</span>, opt_start_time : Time | Nil = <span class=\"n\">nil</span>, filter_subject : Nil | String = <span class=\"n\">nil</span>, external : <a href=\"../../NATS/JetStream/ExternalStream.html\">NATS::JetStream::ExternalStream</a> | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/jetstream/stream_source.cr","line_number":12,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_source.cr#L12"},"def":{"name":"new","args":[{"name":"name","external_name":"name","restriction":"::String"},{"name":"opt_start_seq","default_value":"nil","external_name":"opt_start_seq","restriction":"::UInt64 | ::Nil"},{"name":"opt_start_time","default_value":"nil","external_name":"opt_start_time","restriction":"::Time | ::Nil"},{"name":"filter_subject","default_value":"nil","external_name":"filter_subject","restriction":"::Nil | ::String"},{"name":"external","default_value":"nil","external_name":"external","restriction":"::NATS::JetStream::ExternalStream | ::Nil"}],"visibility":"Public","body":"_ = allocate\n_.initialize(name, opt_start_seq, opt_start_time, filter_subject, external)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"external:ExternalStream|Nil-instance-method","name":"external","abstract":false,"location":{"filename":"src/jetstream/stream_source.cr","line_number":10,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_source.cr#L10"},"def":{"name":"external","return_type":"ExternalStream | ::Nil","visibility":"Public","body":"@external"},"external_var":false},{"html_id":"filter_subject:String|Nil-instance-method","name":"filter_subject","abstract":false,"location":{"filename":"src/jetstream/stream_source.cr","line_number":9,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_source.cr#L9"},"def":{"name":"filter_subject","return_type":"String | ::Nil","visibility":"Public","body":"@filter_subject"},"external_var":false},{"html_id":"name:String-instance-method","name":"name","abstract":false,"location":{"filename":"src/jetstream/stream_source.cr","line_number":6,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_source.cr#L6"},"def":{"name":"name","return_type":"String","visibility":"Public","body":"@name"},"external_var":false},{"html_id":"opt_start_seq:UInt64|Nil-instance-method","name":"opt_start_seq","abstract":false,"location":{"filename":"src/jetstream/stream_source.cr","line_number":7,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_source.cr#L7"},"def":{"name":"opt_start_seq","return_type":"UInt64 | ::Nil","visibility":"Public","body":"@opt_start_seq"},"external_var":false},{"html_id":"opt_start_time:Time|Nil-instance-method","name":"opt_start_time","abstract":false,"location":{"filename":"src/jetstream/stream_source.cr","line_number":8,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_source.cr#L8"},"def":{"name":"opt_start_time","return_type":"Time | ::Nil","visibility":"Public","body":"@opt_start_time"},"external_var":false}]},{"html_id":"nats/NATS/JetStream/StreamSourceInfo","path":"NATS/JetStream/StreamSourceInfo.html","kind":"struct","full_name":"NATS::JetStream::StreamSourceInfo","name":"StreamSourceInfo","abstract":false,"superclass":{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},"ancestors":[{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/stream_source_info.cr","line_number":7,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_source_info.cr#L7"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/jetstream/stream_source_info.cr","line_number":7,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_source_info.cr#L7"},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"},"external_var":false},{"html_id":"new(name:String,external:NATS::JetStream::ExternalStream|Nil=nil,lag:Time::Span=0.seconds,active:Time::Span=0.seconds,error:NATS::JetStream::APIError|Nil=nil)-class-method","name":"new","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"::String"},{"name":"external","default_value":"nil","external_name":"external","restriction":"::NATS::JetStream::ExternalStream | ::Nil"},{"name":"lag","default_value":"0.seconds","external_name":"lag","restriction":"::Time::Span"},{"name":"active","default_value":"0.seconds","external_name":"active","restriction":"::Time::Span"},{"name":"error","default_value":"nil","external_name":"error","restriction":"::NATS::JetStream::APIError | ::Nil"}],"args_string":"(name : String, external : NATS::JetStream::ExternalStream | Nil = nil, lag : Time::Span = 0.seconds, active : Time::Span = 0.seconds, error : NATS::JetStream::APIError | Nil = nil)","args_html":"(name : String, external : <a href=\"../../NATS/JetStream/ExternalStream.html\">NATS::JetStream::ExternalStream</a> | Nil = <span class=\"n\">nil</span>, lag : Time::Span = <span class=\"n\">0</span>.seconds, active : Time::Span = <span class=\"n\">0</span>.seconds, error : <a href=\"../../NATS/JetStream/APIError.html\">NATS::JetStream::APIError</a> | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/jetstream/stream_source_info.cr","line_number":16,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_source_info.cr#L16"},"def":{"name":"new","args":[{"name":"name","external_name":"name","restriction":"::String"},{"name":"external","default_value":"nil","external_name":"external","restriction":"::NATS::JetStream::ExternalStream | ::Nil"},{"name":"lag","default_value":"0.seconds","external_name":"lag","restriction":"::Time::Span"},{"name":"active","default_value":"0.seconds","external_name":"active","restriction":"::Time::Span"},{"name":"error","default_value":"nil","external_name":"error","restriction":"::NATS::JetStream::APIError | ::Nil"}],"visibility":"Public","body":"_ = allocate\n_.initialize(name, external, lag, active, error)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"active:Time::Span-instance-method","name":"active","abstract":false,"location":{"filename":"src/jetstream/stream_source_info.cr","line_number":13,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_source_info.cr#L13"},"def":{"name":"active","return_type":"Time::Span","visibility":"Public","body":"@active"},"external_var":false},{"html_id":"error:APIError|Nil-instance-method","name":"error","abstract":false,"location":{"filename":"src/jetstream/stream_source_info.cr","line_number":14,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_source_info.cr#L14"},"def":{"name":"error","return_type":"APIError | ::Nil","visibility":"Public","body":"@error"},"external_var":false},{"html_id":"external:ExternalStream|Nil-instance-method","name":"external","abstract":false,"location":{"filename":"src/jetstream/stream_source_info.cr","line_number":9,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_source_info.cr#L9"},"def":{"name":"external","return_type":"ExternalStream | ::Nil","visibility":"Public","body":"@external"},"external_var":false},{"html_id":"lag:Time::Span-instance-method","name":"lag","abstract":false,"location":{"filename":"src/jetstream/stream_source_info.cr","line_number":11,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_source_info.cr#L11"},"def":{"name":"lag","return_type":"Time::Span","visibility":"Public","body":"@lag"},"external_var":false},{"html_id":"name:String-instance-method","name":"name","abstract":false,"location":{"filename":"src/jetstream/stream_source_info.cr","line_number":8,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_source_info.cr#L8"},"def":{"name":"name","return_type":"String","visibility":"Public","body":"@name"},"external_var":false}]},{"html_id":"nats/NATS/JetStream/StreamState","path":"NATS/JetStream/StreamState.html","kind":"struct","full_name":"NATS::JetStream::StreamState","name":"StreamState","abstract":false,"superclass":{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},"ancestors":[{"html_id":"nats/NATS/JetStream/Entity","kind":"struct","full_name":"NATS::JetStream::Entity","name":"Entity"},{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/jetstream/stream_state.cr","line_number":4,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_state.cr#L4"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/JetStream","kind":"module","full_name":"NATS::JetStream","name":"JetStream"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/jetstream/stream_state.cr","line_number":4,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_state.cr#L4"},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"},"external_var":false}],"instance_methods":[{"html_id":"bytes:Int64-instance-method","name":"bytes","abstract":false,"location":{"filename":"src/jetstream/stream_state.cr","line_number":6,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_state.cr#L6"},"def":{"name":"bytes","return_type":"Int64","visibility":"Public","body":"@bytes"},"external_var":false},{"html_id":"consumer_count:Int32-instance-method","name":"consumer_count","abstract":false,"location":{"filename":"src/jetstream/stream_state.cr","line_number":11,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_state.cr#L11"},"def":{"name":"consumer_count","return_type":"Int32","visibility":"Public","body":"@consumer_count"},"external_var":false},{"html_id":"first_seq:Int64-instance-method","name":"first_seq","abstract":false,"location":{"filename":"src/jetstream/stream_state.cr","line_number":7,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_state.cr#L7"},"def":{"name":"first_seq","return_type":"Int64","visibility":"Public","body":"@first_seq"},"external_var":false},{"html_id":"first_ts:Time-instance-method","name":"first_ts","abstract":false,"location":{"filename":"src/jetstream/stream_state.cr","line_number":8,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_state.cr#L8"},"def":{"name":"first_ts","return_type":"Time","visibility":"Public","body":"@first_ts"},"external_var":false},{"html_id":"last_seq:Int64-instance-method","name":"last_seq","abstract":false,"location":{"filename":"src/jetstream/stream_state.cr","line_number":9,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_state.cr#L9"},"def":{"name":"last_seq","return_type":"Int64","visibility":"Public","body":"@last_seq"},"external_var":false},{"html_id":"last_ts:Time-instance-method","name":"last_ts","abstract":false,"location":{"filename":"src/jetstream/stream_state.cr","line_number":10,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_state.cr#L10"},"def":{"name":"last_ts","return_type":"Time","visibility":"Public","body":"@last_ts"},"external_var":false},{"html_id":"messages:Int64-instance-method","name":"messages","abstract":false,"location":{"filename":"src/jetstream/stream_state.cr","line_number":5,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/jetstream/stream_state.cr#L5"},"def":{"name":"messages","return_type":"Int64","visibility":"Public","body":"@messages"},"external_var":false}]}]},{"html_id":"nats/NATS/KV","path":"NATS/KV.html","kind":"module","full_name":"NATS::KV","name":"KV","abstract":false,"locations":[{"filename":"src/kv.cr","line_number":28,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L28"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS","kind":"module","full_name":"NATS","name":"NATS"},"doc":"`NATS::KV` is an experimental interface to the NATS server's experimental KV\nfeature.\n\nTo use KV:\n\n```\nrequire \"nats/kv\"\n\nnats = NATS::Client.new\nkv = nats.kv\n\nbucket = \"my-bucket\"\nkv.create_bucket(bucket)\nkv.put bucket, \"key\", \"value\"\n\nmsg = kv.get(bucket, \"key\").try(&.value)\nString.new(msg.data) # => \"value\"\nmsg.seq              # => 1\n```","summary":"<p><code><a href=\"../NATS/KV.html\">NATS::KV</a></code> is an experimental interface to the NATS server's experimental KV feature.</p>\n<p><span class=\"flag lime\">EXPERIMENTAL</span>  NATS KV support is experimental and subject to change as NATS support for it changes</p>","types":[{"html_id":"nats/NATS/KV/Bucket","path":"NATS/KV/Bucket.html","kind":"struct","full_name":"NATS::KV::Bucket","name":"Bucket","abstract":false,"superclass":{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},"ancestors":[{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/kv.cr","line_number":41,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L41"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/KV","kind":"module","full_name":"NATS::KV","name":"KV"},"instance_methods":[{"html_id":"[]=(key:String,value:Data)-instance-method","name":"[]=","doc":"Set the value of a key","summary":"<p>Set the value of a key</p>","abstract":false,"args":[{"name":"key","external_name":"key","restriction":"String"},{"name":"value","external_name":"value","restriction":"Data"}],"args_string":"(key : String, value : Data)","args_html":"(key : String, value : <a href=\"../../NATS/Data.html\">Data</a>)","location":{"filename":"src/kv.cr","line_number":151,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L151"},"def":{"name":"[]=","args":[{"name":"key","external_name":"key","restriction":"String"},{"name":"value","external_name":"value","restriction":"Data"}],"visibility":"Public","body":"put(key, value)"},"external_var":false},{"html_id":"[]?(key:String):Bytes|Nil-instance-method","name":"[]?","doc":"Get the value of a key, if it exists (not counting `Delete` operations),\nstripping away all metadata to return only the value. If you need\nmetadata such as `revision`, `timestamp`, or `operation`, or if you need\nto be able to get deleted keys, you should use `Bucket#get` instead.","summary":"<p>Get the value of a key, if it exists (not counting <code>Delete</code> operations), stripping away all metadata to return only the value.</p>","abstract":false,"args":[{"name":"key","external_name":"key","restriction":"String"}],"args_string":"(key : String) : Bytes | Nil","args_html":"(key : String) : Bytes | Nil","location":{"filename":"src/kv.cr","line_number":172,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L172"},"def":{"name":"[]?","args":[{"name":"key","external_name":"key","restriction":"String"}],"return_type":"Bytes | ::Nil","visibility":"Public","body":"if entry = get(key, ignore_deletes: true)\n  entry.value\nend"},"external_var":false},{"html_id":"create(key:String,value:String)-instance-method","name":"create","doc":"Creates the given `key` with the given `value` if and only if the key\ndoes not yet exist.","summary":"<p>Creates the given <code>key</code> with the given <code>value</code> if and only if the key does not yet exist.</p>","abstract":false,"args":[{"name":"key","external_name":"key","restriction":"String"},{"name":"value","external_name":"value","restriction":"String"}],"args_string":"(key : String, value : String)","args_html":"(key : String, value : String)","location":{"filename":"src/kv.cr","line_number":191,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L191"},"def":{"name":"create","args":[{"name":"key","external_name":"key","restriction":"String"},{"name":"value","external_name":"value","restriction":"String"}],"visibility":"Public","body":"@kv.create(name, key, value)"},"external_var":false},{"html_id":"created:Time-instance-method","name":"created","abstract":false,"location":{"filename":"src/kv.cr","line_number":77,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L77"},"def":{"name":"created","return_type":"Time","visibility":"Public","body":"@created"},"external_var":false},{"html_id":"delete(key:String)-instance-method","name":"delete","doc":"Deletes the given `key` from the KV store. Inside the NATS server, this\nis implemented as adding another message to the stream that signifies\ndeletion.","summary":"<p>Deletes the given <code>key</code> from the KV store.</p>","abstract":false,"args":[{"name":"key","external_name":"key","restriction":"String"}],"args_string":"(key : String)","args_html":"(key : String)","location":{"filename":"src/kv.cr","line_number":207,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L207"},"def":{"name":"delete","args":[{"name":"key","external_name":"key","restriction":"String"}],"visibility":"Public","body":"@kv.delete(name, key)"},"external_var":false},{"html_id":"description:String|Nil-instance-method","name":"description","doc":"An optional description of the purpose of this bucket","summary":"<p>An optional description of the purpose of this bucket</p>","abstract":false,"location":{"filename":"src/kv.cr","line_number":49,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L49"},"def":{"name":"description","return_type":"String | ::Nil","visibility":"Public","body":"@description"},"external_var":false},{"html_id":"each_key(&)-instance-method","name":"each_key","abstract":false,"location":{"filename":"src/kv.cr","line_number":224,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L224"},"def":{"name":"each_key","yields":1,"block_arity":1,"visibility":"Public","body":"@kv.each_key(name) do |key|\n  yield key\nend"},"external_var":false},{"html_id":"get(key:String,*,revision:Int|Nil=nil,ignore_deletes=false):Entry|Nil-instance-method","name":"get","doc":"Get the entry for a key as a `KV::Entry` - returns `nil` if the key does\nnot exist or if it's been deleted with `ignore_deletes` set to `true`.\n\n*Important*: If you do not set `ignore_deletes`, you may get a deleted\nkey. This is because the keys are stored in a stream and deleting the\nkey sets an `operation` flag (implemented in the NATS server as a\n`KV-Operation` message header) and this method retrieves the last entry\nin the stream for this key. `ignore_deletes` simply tells the client to\nignore deleted messages.","summary":"<p>Get the entry for a key as a <code><a href=\"../../NATS/KV/Entry.html\">KV::Entry</a></code> - returns <code>nil</code> if the key does not exist or if it's been deleted with <code>ignore_deletes</code> set to <code>true</code>.</p>","abstract":false,"args":[{"name":"key","external_name":"key","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"revision","default_value":"nil","external_name":"revision","restriction":"Int | ::Nil"},{"name":"ignore_deletes","default_value":"false","external_name":"ignore_deletes","restriction":""}],"args_string":"(key : String, *, revision : Int | Nil = nil, ignore_deletes = false) : Entry | Nil","args_html":"(key : String, *, revision : Int | Nil = <span class=\"n\">nil</span>, ignore_deletes = <span class=\"n\">false</span>) : <a href=\"../../NATS/KV/Entry.html\">Entry</a> | Nil","location":{"filename":"src/kv.cr","line_number":164,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L164"},"def":{"name":"get","args":[{"name":"key","external_name":"key","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"revision","default_value":"nil","external_name":"revision","restriction":"Int | ::Nil"},{"name":"ignore_deletes","default_value":"false","external_name":"ignore_deletes","restriction":""}],"splat_index":1,"return_type":"Entry | ::Nil","visibility":"Public","body":"@kv.get(name, key, revision: revision, ignore_deletes: ignore_deletes)"},"external_var":false},{"html_id":"get!(key:String,*,revision:Int|Nil=nil,ignore_deletes=false):Entry-instance-method","name":"get!","doc":"Get the value of a key as a `KV::Entry` - raises `KeyError` if the key\ndoes not exist or if it's been deleted with `ignore_deletes` set to\n`true`.","summary":"<p>Get the value of a key as a <code><a href=\"../../NATS/KV/Entry.html\">KV::Entry</a></code> - raises <code><a href=\"../../NATS/KV/KeyError.html\">KeyError</a></code> if the key does not exist or if it's been deleted with <code>ignore_deletes</code> set to <code>true</code>.</p>","abstract":false,"args":[{"name":"key","external_name":"key","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"revision","default_value":"nil","external_name":"revision","restriction":"Int | ::Nil"},{"name":"ignore_deletes","default_value":"false","external_name":"ignore_deletes","restriction":""}],"args_string":"(key : String, *, revision : Int | Nil = nil, ignore_deletes = false) : Entry","args_html":"(key : String, *, revision : Int | Nil = <span class=\"n\">nil</span>, ignore_deletes = <span class=\"n\">false</span>) : <a href=\"../../NATS/KV/Entry.html\">Entry</a>","location":{"filename":"src/kv.cr","line_number":181,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L181"},"def":{"name":"get!","args":[{"name":"key","external_name":"key","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"revision","default_value":"nil","external_name":"revision","restriction":"Int | ::Nil"},{"name":"ignore_deletes","default_value":"false","external_name":"ignore_deletes","restriction":""}],"splat_index":1,"return_type":"Entry","visibility":"Public","body":"if value = get(key, revision: revision, ignore_deletes: ignore_deletes)\n  value\nelse\n  raise(KeyError.new(\"Key #{key.inspect} expected, but not found\"))\nend"},"external_var":false},{"html_id":"history(key:String)-instance-method","name":"history","doc":"Get the history","summary":"<p>Get the history</p>","abstract":false,"args":[{"name":"key","external_name":"key","restriction":"String"}],"args_string":"(key : String)","args_html":"(key : String)","location":{"filename":"src/kv.cr","line_number":229,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L229"},"def":{"name":"history","args":[{"name":"key","external_name":"key","restriction":"String"}],"visibility":"Public","body":"@kv.history(name, key)"},"external_var":false},{"html_id":"history:Int64|Nil-instance-method","name":"history","doc":"The number of revisions NATS will retain for this key","summary":"<p>The number of revisions NATS will retain for this key</p>","abstract":false,"location":{"filename":"src/kv.cr","line_number":55,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L55"},"def":{"name":"history","return_type":"Int64 | ::Nil","visibility":"Public","body":"@history"},"external_var":false},{"html_id":"keys(pattern:String=\">\")-instance-method","name":"keys","doc":"List all known keys for this bucket, returned as a `Set(String)`.","summary":"<p>List all known keys for this bucket, returned as a <code>Set(String)</code>.</p>","abstract":false,"args":[{"name":"pattern","default_value":"\">\"","external_name":"pattern","restriction":"String"}],"args_string":"(pattern : String = \">\")","args_html":"(pattern : String = <span class=\"s\">&quot;&gt;&quot;</span>)","location":{"filename":"src/kv.cr","line_number":220,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L220"},"def":{"name":"keys","args":[{"name":"pattern","default_value":"\">\"","external_name":"pattern","restriction":"String"}],"visibility":"Public","body":"@kv.keys(name, pattern)"},"external_var":false},{"html_id":"last_update:Time-instance-method","name":"last_update","abstract":false,"location":{"filename":"src/kv.cr","line_number":75,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L75"},"def":{"name":"last_update","return_type":"Time","visibility":"Public","body":"@last_update"},"external_var":false},{"html_id":"max_bytes:Int64|Nil-instance-method","name":"max_bytes","doc":"The maximum size in bytes of this bucket in memory or on disk","summary":"<p>The maximum size in bytes of this bucket in memory or on disk</p>","abstract":false,"location":{"filename":"src/kv.cr","line_number":61,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L61"},"def":{"name":"max_bytes","return_type":"Int64 | ::Nil","visibility":"Public","body":"@max_bytes"},"external_var":false},{"html_id":"max_value_size:Int32|Nil-instance-method","name":"max_value_size","doc":"The maximum number of bytes in a value","summary":"<p>The maximum number of bytes in a value</p>","abstract":false,"location":{"filename":"src/kv.cr","line_number":52,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L52"},"def":{"name":"max_value_size","return_type":"Int32 | ::Nil","visibility":"Public","body":"@max_value_size"},"external_var":false},{"html_id":"name:String-instance-method","name":"name","doc":"The name of this bucket","summary":"<p>The name of this bucket</p>","abstract":false,"location":{"filename":"src/kv.cr","line_number":43,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L43"},"def":{"name":"name","return_type":"String","visibility":"Public","body":"@name"},"external_var":false},{"html_id":"placement:JetStream::StreamConfig::Placement|Nil-instance-method","name":"placement","abstract":false,"location":{"filename":"src/kv.cr","line_number":69,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L69"},"def":{"name":"placement","return_type":"JetStream::StreamConfig::Placement | ::Nil","visibility":"Public","body":"@placement"},"external_var":false},{"html_id":"purge(key:String)-instance-method","name":"purge","doc":"Purges the given `key` from the KV store. Inside the NATS server, this\nis implemented as rolling up all versions of this key into a single\nmessage with its `KV::Entry#operation` value (`KV-Operation` header)\nset to `KV::Entry::Operation::Purge`.","summary":"<p>Purges the given <code>key</code> from the KV store.</p>","abstract":false,"args":[{"name":"key","external_name":"key","restriction":"String"}],"args_string":"(key : String)","args_html":"(key : String)","location":{"filename":"src/kv.cr","line_number":215,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L215"},"def":{"name":"purge","args":[{"name":"key","external_name":"key","restriction":"String"}],"visibility":"Public","body":"@kv.purge(name, key)"},"external_var":false},{"html_id":"put(key:String,value:Data,ttl:Time::Span|Nil=nil)-instance-method","name":"put","doc":"Set the value of a key","summary":"<p>Set the value of a key</p>","abstract":false,"args":[{"name":"key","external_name":"key","restriction":"String"},{"name":"value","external_name":"value","restriction":"Data"},{"name":"ttl","default_value":"nil","external_name":"ttl","restriction":"Time::Span | ::Nil"}],"args_string":"(key : String, value : Data, ttl : Time::Span | Nil = nil)","args_html":"(key : String, value : <a href=\"../../NATS/Data.html\">Data</a>, ttl : Time::Span | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/kv.cr","line_number":137,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L137"},"def":{"name":"put","args":[{"name":"key","external_name":"key","restriction":"String"},{"name":"value","external_name":"value","restriction":"Data"},{"name":"ttl","default_value":"nil","external_name":"ttl","restriction":"Time::Span | ::Nil"}],"visibility":"Public","body":"@kv.put(name, key, value, ttl: ttl)"},"external_var":false},{"html_id":"replicas:Int32-instance-method","name":"replicas","doc":"The number of NATS nodes to which this KV bucket will be replicated","summary":"<p>The number of NATS nodes to which this KV bucket will be replicated</p>","abstract":false,"location":{"filename":"src/kv.cr","line_number":67,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L67"},"def":{"name":"replicas","return_type":"Int32","visibility":"Public","body":"@replicas"},"external_var":false},{"html_id":"set(key:String,value:Data,ttl:Time::Span|Nil=nil)-instance-method","name":"set","doc":"Assign `value` to `key` in `bucket` asynchronously, not waiting for\nacknowledgement from the NATS server.\n\nWARNING: Without acknowledgement, there is no guarantee the server\nreceived the value. Use with caution.","summary":"<p>Assign <code>value</code> to <code>key</code> in <code>bucket</code> asynchronously, not waiting for acknowledgement from the NATS server.</p>","abstract":false,"args":[{"name":"key","external_name":"key","restriction":"String"},{"name":"value","external_name":"value","restriction":"Data"},{"name":"ttl","default_value":"nil","external_name":"ttl","restriction":"Time::Span | ::Nil"}],"args_string":"(key : String, value : Data, ttl : Time::Span | Nil = nil)","args_html":"(key : String, value : <a href=\"../../NATS/Data.html\">Data</a>, ttl : Time::Span | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/kv.cr","line_number":146,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L146"},"def":{"name":"set","args":[{"name":"key","external_name":"key","restriction":"String"},{"name":"value","external_name":"value","restriction":"Data"},{"name":"ttl","default_value":"nil","external_name":"ttl","restriction":"Time::Span | ::Nil"}],"visibility":"Public","body":"@kv.set(name, key, value, ttl: ttl)"},"external_var":false},{"html_id":"size:Size-instance-method","name":"size","abstract":false,"location":{"filename":"src/kv.cr","line_number":71,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L71"},"def":{"name":"size","return_type":"Size","visibility":"Public","body":"@size"},"external_var":false},{"html_id":"storage:JetStream::StreamConfig::Storage-instance-method","name":"storage","doc":"Where NATS stores the data for this bucket","summary":"<p>Where NATS stores the data for this bucket</p>","abstract":false,"location":{"filename":"src/kv.cr","line_number":64,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L64"},"def":{"name":"storage","return_type":"JetStream::StreamConfig::Storage","visibility":"Public","body":"@storage"},"external_var":false},{"html_id":"stream_name:String-instance-method","name":"stream_name","doc":"The name of the underlying `JetStream` stream.","summary":"<p>The name of the underlying <code><a href=\"../../NATS/JetStream.html\">JetStream</a></code> stream.</p>","abstract":false,"location":{"filename":"src/kv.cr","line_number":46,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L46"},"def":{"name":"stream_name","return_type":"String","visibility":"Public","body":"@stream_name"},"external_var":false},{"html_id":"ttl:Time::Span|Nil-instance-method","name":"ttl","doc":"The maximum length of time NATS will retain a value or revision for a key","summary":"<p>The maximum length of time NATS will retain a value or revision for a key</p>","abstract":false,"location":{"filename":"src/kv.cr","line_number":58,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L58"},"def":{"name":"ttl","return_type":"Time::Span | ::Nil","visibility":"Public","body":"@ttl"},"external_var":false},{"html_id":"update(key:String,value:String,revision:Int64)-instance-method","name":"update","doc":"Updates the given `key` with the given `value` if and only if it exists\nand is currently at the given `revision`. If you do not have the latest\nrevision, this method returns `nil` so you can perform domain-specific\nconflict resolution. If you need to set the key regardless of revision,\nuse `Bucket#put` instead.","summary":"<p>Updates the given <code>key</code> with the given <code>value</code> if and only if it exists and is currently at the given <code>revision</code>.</p>","abstract":false,"args":[{"name":"key","external_name":"key","restriction":"String"},{"name":"value","external_name":"value","restriction":"String"},{"name":"revision","external_name":"revision","restriction":"Int64"}],"args_string":"(key : String, value : String, revision : Int64)","args_html":"(key : String, value : String, revision : Int64)","location":{"filename":"src/kv.cr","line_number":200,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L200"},"def":{"name":"update","args":[{"name":"key","external_name":"key","restriction":"String"},{"name":"value","external_name":"value","restriction":"String"},{"name":"revision","external_name":"revision","restriction":"Int64"}],"visibility":"Public","body":"@kv.update(name, key, value, revision)"},"external_var":false},{"html_id":"values:Int64-instance-method","name":"values","abstract":false,"location":{"filename":"src/kv.cr","line_number":73,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L73"},"def":{"name":"values","return_type":"Int64","visibility":"Public","body":"@values"},"external_var":false},{"html_id":"watch(key:String,*,ignore_deletes=false,include_history=true)-instance-method","name":"watch","doc":"Watch the given key (or wildcard) for changes and yielding them to the\nblock. By default, this will also yield deleted messages. To avoid that,\npass `ignore_deletes: true`.\n\n```\nbucket.watch(\"session.*\") do |entry|\n  _prefix, session_id = entry.subject.split('.', 2)\n  if entry.operation.deleted?\n    # do deleted things\n  else\n    # the session was updated\n  end\nend\n```\n\nThis method blocks until the yielded `Watch` is stopped (use\n`watch.stop`), so if you want to run it in the background, you will need\nto run this method inside a `spawn` block.\n\nYou can also use this method to wait for a specific key to change once:\n\n```\nwatch = bucket.watch(my_key)\nwatch.each do |entry|\n  # react to the key change\n\n  watch.stop if entry.latest? # exit the block\nend\n```","summary":"<p>Watch the given key (or wildcard) for changes and yielding them to the block.</p>","abstract":false,"args":[{"name":"key","external_name":"key","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"ignore_deletes","default_value":"false","external_name":"ignore_deletes","restriction":""},{"name":"include_history","default_value":"true","external_name":"include_history","restriction":""}],"args_string":"(key : String, *, ignore_deletes = false, include_history = true)","args_html":"(key : String, *, ignore_deletes = <span class=\"n\">false</span>, include_history = <span class=\"n\">true</span>)","location":{"filename":"src/kv.cr","line_number":262,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L262"},"def":{"name":"watch","args":[{"name":"key","external_name":"key","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"ignore_deletes","default_value":"false","external_name":"ignore_deletes","restriction":""},{"name":"include_history","default_value":"true","external_name":"include_history","restriction":""}],"splat_index":1,"visibility":"Public","body":"@kv.watch(name, key, ignore_deletes: ignore_deletes, include_history: include_history)"},"external_var":false}],"types":[{"html_id":"nats/NATS/KV/Bucket/Size","path":"NATS/KV/Bucket/Size.html","kind":"struct","full_name":"NATS::KV::Bucket::Size","name":"Size","abstract":false,"superclass":{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},"ancestors":[{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/kv.cr","line_number":100,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L100"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/KV/Bucket","kind":"struct","full_name":"NATS::KV::Bucket","name":"Bucket"},"constructors":[{"html_id":"new(size:Int64)-class-method","name":"new","abstract":false,"args":[{"name":"size","external_name":"size","restriction":"Int64"}],"args_string":"(size : Int64)","args_html":"(size : Int64)","location":{"filename":"src/kv.cr","line_number":101,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L101"},"def":{"name":"new","args":[{"name":"size","external_name":"size","restriction":"Int64"}],"visibility":"Public","body":"_ = allocate\n_.initialize(size)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"inspect(io)-instance-method","name":"inspect","abstract":false,"args":[{"name":"io","external_name":"io","restriction":""}],"args_string":"(io)","args_html":"(io)","location":{"filename":"src/kv.cr","line_number":104,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L104"},"def":{"name":"inspect","args":[{"name":"io","external_name":"io","restriction":""}],"visibility":"Public","body":"to_i64.humanize_bytes(io, format: :jedec)"},"external_var":false},{"html_id":"to_i-instance-method","name":"to_i","abstract":false,"location":{"filename":"src/kv.cr","line_number":108,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L108"},"def":{"name":"to_i","visibility":"Public","body":"to_i64"},"external_var":false},{"html_id":"to_i64:Int64-instance-method","name":"to_i64","abstract":false,"location":{"filename":"src/kv.cr","line_number":112,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L112"},"def":{"name":"to_i64","visibility":"Public","body":"@size"},"external_var":false}]}]},{"html_id":"nats/NATS/KV/Client","path":"NATS/KV/Client.html","kind":"class","full_name":"NATS::KV::Client","name":"Client","abstract":false,"superclass":{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/kv.cr","line_number":267,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L267"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/KV","kind":"module","full_name":"NATS::KV","name":"KV"},"constructors":[{"html_id":"new(nats:NATS::Client)-class-method","name":"new","abstract":false,"args":[{"name":"nats","external_name":"nats","restriction":"::NATS::Client"}],"args_string":"(nats : NATS::Client)","args_html":"(nats : <a href=\"../../NATS/Client.html\">NATS::Client</a>)","location":{"filename":"src/kv.cr","line_number":268,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L268"},"def":{"name":"new","args":[{"name":"nats","external_name":"nats","restriction":"::NATS::Client"}],"visibility":"Public","body":"_ = allocate\n_.initialize(nats)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"create(bucket:String,key:String,value:String|Bytes):Int64|Nil-instance-method","name":"create","doc":"Create a key in the given `bucket` with the specified `value`. On\nsuccess, `create` returns the new revision number for the key. If the\nkey already exists, the value will not be set and `nil` is returned.\n\n```\nif revision = kv.create(\"my-bucket\", \"my-key\", \"my-value\")\n  # created\nelse\n  # key already existed and value was not set\nend\n```","summary":"<p>Create a key in the given <code>bucket</code> with the specified <code>value</code>.</p>","abstract":false,"args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"},{"name":"value","external_name":"value","restriction":"String | Bytes"}],"args_string":"(bucket : String, key : String, value : String | Bytes) : Int64 | Nil","args_html":"(bucket : String, key : String, value : String | Bytes) : Int64 | Nil","location":{"filename":"src/kv.cr","line_number":408,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L408"},"def":{"name":"create","args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"},{"name":"value","external_name":"value","restriction":"String | Bytes"}],"return_type":"Int64 | ::Nil","visibility":"Public","body":"validate_bucket!(bucket)\nvalidate_key!(key)\n\nrevision = update(bucket, key, value, revision: 0)\nif revision\n  revision\nelse\n  if (entry = get(bucket, key)) && !entry.operation.put?\n    update(bucket, key, value, revision: entry.revision)\n  end\nend\n"},"external_var":false},{"html_id":"create_bucket(name:String,description:String=\"\",*,max_value_size:Int32|Nil=nil,history:Int=1,ttl:Time::Span|Nil=nil,max_bytes:Int64|Nil=nil,storage:JetStream::StreamConfig::Storage=:file,replicas:Int32=1,discard_new_per_key:Bool=false,placement:JetStream::StreamConfig::Placement|Nil=nil,allow_msg_ttl:Bool|Nil=nil):Bucket-instance-method","name":"create_bucket","doc":"Create a `NATS::KV::Bucket` to store key/value mappings in with the\nspecified `name`. Options are:\n\n- `storage`: where to store the data for this bucket, either `:file` or `:memory`\n- `max_value_size`: the largest number of bytes a key/value entry can hold\n- `history`: how many revisions of a key to retain\n- `ttl`: how long until a value or revision expires\n- `max_bytes`: maximum size of this bucket on disk or in memory\n- `replicas`: how many NATS nodes to store this bucket's data on","summary":"<p>Create a <code><a href=\"../../NATS/KV/Bucket.html\">NATS::KV::Bucket</a></code> to store key/value mappings in with the specified <code>name</code>.</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"description","default_value":"\"\"","external_name":"description","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"max_value_size","default_value":"nil","external_name":"max_value_size","restriction":"Int32 | ::Nil"},{"name":"history","default_value":"1","external_name":"history","restriction":"Int"},{"name":"ttl","default_value":"nil","external_name":"ttl","restriction":"Time::Span | ::Nil"},{"name":"max_bytes","default_value":"nil","external_name":"max_bytes","restriction":"Int64 | ::Nil"},{"name":"storage","default_value":":file","external_name":"storage","restriction":"JetStream::StreamConfig::Storage"},{"name":"replicas","default_value":"1","external_name":"replicas","restriction":"Int32"},{"name":"discard_new_per_key","default_value":"false","external_name":"discard_new_per_key","restriction":"Bool"},{"name":"placement","default_value":"nil","external_name":"placement","restriction":"JetStream::StreamConfig::Placement | ::Nil"},{"name":"allow_msg_ttl","default_value":"nil","external_name":"allow_msg_ttl","restriction":"Bool | ::Nil"}],"args_string":"(name : String, description : String = \"\", *, max_value_size : Int32 | Nil = nil, history : Int = 1, ttl : Time::Span | Nil = nil, max_bytes : Int64 | Nil = nil, storage : JetStream::StreamConfig::Storage = :file, replicas : Int32 = 1, discard_new_per_key : Bool = false, placement : JetStream::StreamConfig::Placement | Nil = nil, allow_msg_ttl : Bool | Nil = nil) : Bucket","args_html":"(name : String, description : String = <span class=\"s\">&quot;&quot;</span>, *, max_value_size : Int32 | Nil = <span class=\"n\">nil</span>, history : Int = <span class=\"n\">1</span>, ttl : Time::Span | Nil = <span class=\"n\">nil</span>, max_bytes : Int64 | Nil = <span class=\"n\">nil</span>, storage : <a href=\"../../NATS/JetStream/StreamConfig/Storage.html\">JetStream::StreamConfig::Storage</a> = <span class=\"n\">:file</span>, replicas : Int32 = <span class=\"n\">1</span>, discard_new_per_key : Bool = <span class=\"n\">false</span>, placement : <a href=\"../../NATS/JetStream/StreamConfig/Placement.html\">JetStream::StreamConfig::Placement</a> | Nil = <span class=\"n\">nil</span>, allow_msg_ttl : Bool | Nil = <span class=\"n\">nil</span>) : <a href=\"../../NATS/KV/Bucket.html\">Bucket</a>","location":{"filename":"src/kv.cr","line_number":280,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L280"},"def":{"name":"create_bucket","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"description","default_value":"\"\"","external_name":"description","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"max_value_size","default_value":"nil","external_name":"max_value_size","restriction":"Int32 | ::Nil"},{"name":"history","default_value":"1","external_name":"history","restriction":"Int"},{"name":"ttl","default_value":"nil","external_name":"ttl","restriction":"Time::Span | ::Nil"},{"name":"max_bytes","default_value":"nil","external_name":"max_bytes","restriction":"Int64 | ::Nil"},{"name":"storage","default_value":":file","external_name":"storage","restriction":"JetStream::StreamConfig::Storage"},{"name":"replicas","default_value":"1","external_name":"replicas","restriction":"Int32"},{"name":"discard_new_per_key","default_value":"false","external_name":"discard_new_per_key","restriction":"Bool"},{"name":"placement","default_value":"nil","external_name":"placement","restriction":"JetStream::StreamConfig::Placement | ::Nil"},{"name":"allow_msg_ttl","default_value":"nil","external_name":"allow_msg_ttl","restriction":"Bool | ::Nil"}],"splat_index":2,"return_type":"Bucket","visibility":"Public","body":"if name =~ (/\\A[a-zA-Z0-9_-]+\\z/)\nelse\n  raise(ArgumentError.new(\"NATS KV bucket names can only contain alphanumeric characters, underscores, and dashes\"))\nend\n\n\nstream = @nats.jetstream.stream.create(name: \"KV_#{name}\", description: description, subjects: [\"$KV.#{name}.>\"], max_msgs_per_subject: history.try(&.to_i64), max_bytes: max_bytes, max_age: ttl, max_msg_size: max_value_size, storage: storage, replicas: {replicas, 1}.max, discard: :new, discard_new_per_subject: discard_new_per_key, allow_rollup_headers: true, allow_direct: true, deny_delete: true, placement: placement, allow_msg_ttl: allow_msg_ttl)\n\nBucket.new(stream, self)\n"},"external_var":false},{"html_id":"delete(bucket:String,key:String)-instance-method","name":"delete","abstract":false,"args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"}],"args_string":"(bucket : String, key : String)","args_html":"(bucket : String, key : String)","location":{"filename":"src/kv.cr","line_number":548,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L548"},"def":{"name":"delete","args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"}],"visibility":"Public","body":"validate_bucket!(bucket)\nvalidate_key!(key)\n\nheaders = Headers {\"KV-Operation\" => \"DEL\"}\ncase response = @nats.jetstream.publish(\"$KV.#{bucket}.#{key}\", \"\", headers: headers)\nin JetStream::PubAck\n  response\nin JetStream::ErrorResponse\n  raise(Error.new(response.error.description))\nin Nil\n  raise(Error.new(\"No response received from the NATS server when deleting #{key.inspect} on KV #{bucket.inspect}\"))\nend\n"},"external_var":false},{"html_id":"delete(bucket:Bucket)-instance-method","name":"delete","abstract":false,"args":[{"name":"bucket","external_name":"bucket","restriction":"Bucket"}],"args_string":"(bucket : Bucket)","args_html":"(bucket : <a href=\"../../NATS/KV/Bucket.html\">Bucket</a>)","location":{"filename":"src/kv.cr","line_number":581,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L581"},"def":{"name":"delete","args":[{"name":"bucket","external_name":"bucket","restriction":"Bucket"}],"visibility":"Public","body":"delete_bucket(bucket.name)"},"external_var":false},{"html_id":"delete_bucket(bucket:String)-instance-method","name":"delete_bucket","abstract":false,"args":[{"name":"bucket","external_name":"bucket","restriction":"String"}],"args_string":"(bucket : String)","args_html":"(bucket : String)","location":{"filename":"src/kv.cr","line_number":585,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L585"},"def":{"name":"delete_bucket","args":[{"name":"bucket","external_name":"bucket","restriction":"String"}],"visibility":"Public","body":"validate_bucket!(bucket)\n\n@nats.jetstream.stream.delete(\"KV_#{bucket}\")\n"},"external_var":false},{"html_id":"each_key(bucket:String,pattern:String=\">\",&):Nil-instance-method","name":"each_key","abstract":false,"args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"pattern","default_value":"\">\"","external_name":"pattern","restriction":"String"}],"args_string":"(bucket : String, pattern : String = \">\", &) : Nil","args_html":"(bucket : String, pattern : String = <span class=\"s\">&quot;&gt;&quot;</span>, &) : Nil","location":{"filename":"src/kv.cr","line_number":478,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L478"},"def":{"name":"each_key","args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"pattern","default_value":"\">\"","external_name":"pattern","restriction":"String"}],"yields":1,"block_arity":1,"return_type":"Nil","visibility":"Public","body":"validate_bucket!(bucket)\nvalidate_pattern!(pattern)\n\nwatch = watch(bucket, pattern, include_history: false)\nwatch.each do |entry|\n  if entry.operation.put?\n    yield entry.key\n  end\n  if entry.latest?\n    watch.stop\n  end\nend\n"},"external_var":false},{"html_id":"get(bucket:String,key:String,*,revision:Int|Nil=nil,ignore_deletes:Bool=false):Entry|Nil-instance-method","name":"get","doc":"Get the `KV::Entry` for the given `key` in `bucket`, or `nil` if the key\ndoes not exist.","summary":"<p>Get the <code><a href=\"../../NATS/KV/Entry.html\">KV::Entry</a></code> for the given <code>key</code> in <code>bucket</code>, or <code>nil</code> if the key does not exist.</p>","abstract":false,"args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"revision","default_value":"nil","external_name":"revision","restriction":"Int | ::Nil"},{"name":"ignore_deletes","default_value":"false","external_name":"ignore_deletes","restriction":"Bool"}],"args_string":"(bucket : String, key : String, *, revision : Int | Nil = nil, ignore_deletes : Bool = false) : Entry | Nil","args_html":"(bucket : String, key : String, *, revision : Int | Nil = <span class=\"n\">nil</span>, ignore_deletes : Bool = <span class=\"n\">false</span>) : <a href=\"../../NATS/KV/Entry.html\">Entry</a> | Nil","location":{"filename":"src/kv.cr","line_number":363,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L363"},"def":{"name":"get","args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"revision","default_value":"nil","external_name":"revision","restriction":"Int | ::Nil"},{"name":"ignore_deletes","default_value":"false","external_name":"ignore_deletes","restriction":"Bool"}],"splat_index":2,"return_type":"Entry | ::Nil","visibility":"Public","body":"validate_bucket!(bucket)\nvalidate_pattern!(key)\n\nsubject = \"$KV.#{bucket}.#{key}\"\nif revision\n  response = @nats.jetstream.stream.direct_get(\"KV_#{bucket}\", sequence: revision, next_by_subject: subject)\nelse\n  response = @nats.jetstream.stream.direct_get(\"KV_#{bucket}\", last_by_subject: subject)\nend\n\nif response\n  operation = Entry::Operation::Put\n\n  case response.message.headers.try(&.[]?(\"KV-Operation\"))\n  when \"DEL\"\n    operation = Entry::Operation::Delete\n  when \"PURGE\"\n    operation = Entry::Operation::Purge\n  end\n  if ignore_deletes && !operation.put?\n    return nil\n  end\n\n  _, bucket_name, key_name = response.message.subject.split('.', 3)\n  Entry.new(bucket: bucket_name, key: key_name, value: response.message.data, revision: response.message.seq, created_at: response.message.time, operation: operation)\nend\n"},"external_var":false},{"html_id":"get_bucket(name:String):Bucket|Nil-instance-method","name":"get_bucket","doc":"Get the `Bucket` with the given name, or `nil` if that bucket does not exist.","summary":"<p>Get the <code><a href=\"../../NATS/KV/Bucket.html\">Bucket</a></code> with the given name, or <code>nil</code> if that bucket does not exist.</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"}],"args_string":"(name : String) : Bucket | Nil","args_html":"(name : String) : <a href=\"../../NATS/KV/Bucket.html\">Bucket</a> | Nil","location":{"filename":"src/kv.cr","line_number":322,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L322"},"def":{"name":"get_bucket","args":[{"name":"name","external_name":"name","restriction":"String"}],"return_type":"Bucket | ::Nil","visibility":"Public","body":"validate_bucket!(name)\n\nif stream = @nats.jetstream.stream.info(\"KV_#{name}\")\n  Bucket.new(stream, self)\nend\n"},"external_var":false},{"html_id":"history(bucket:String,key:String):Array(Entry)-instance-method","name":"history","doc":"Get all of the currently retained history for the given `key` in the given `bucket` name. Note that some of the history could have expired due to `Bucket#ttl` or `Bucket#history`.\n\n```\nkv.set \"config\", \"name\", \"1\"\nkv.history(\"config\", \"name\")\n```","summary":"<p>Get all of the currently retained history for the given <code>key</code> in the given <code>bucket</code> name.</p>","abstract":false,"args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"}],"args_string":"(bucket : String, key : String) : Array(Entry)","args_html":"(bucket : String, key : String) : Array(<a href=\"../../NATS/KV/Entry.html\">Entry</a>)","location":{"filename":"src/kv.cr","line_number":495,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L495"},"def":{"name":"history","args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"}],"return_type":"Array(Entry)","visibility":"Public","body":"validate_bucket!(bucket)\nvalidate_pattern!(key)\n\nhistory = [] of Entry\n\nif get(bucket, key).nil?\n  return history\nend\n\nwatch = watch(bucket, key, include_history: true)\nwatch.each do |msg|\n  history << msg\n  if msg.delta == 0\n    watch.stop\n  end\nend\n\nhistory\n"},"external_var":false},{"html_id":"keys(bucket:String,pattern:String=\">\"):Set(String)-instance-method","name":"keys","doc":"Get all of the keys matching `pattern` for the given `bucket` name.","summary":"<p>Get all of the keys matching <code>pattern</code> for the given <code>bucket</code> name.</p>","abstract":false,"args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"pattern","default_value":"\">\"","external_name":"pattern","restriction":"String"}],"args_string":"(bucket : String, pattern : String = \">\") : Set(String)","args_html":"(bucket : String, pattern : String = <span class=\"s\">&quot;&gt;&quot;</span>) : Set(String)","location":{"filename":"src/kv.cr","line_number":452,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L452"},"def":{"name":"keys","args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"pattern","default_value":"\">\"","external_name":"pattern","restriction":"String"}],"return_type":"Set(String)","visibility":"Public","body":"validate_bucket!(bucket)\nvalidate_pattern!(pattern)\n\nkeys = Set(String).new\n\n\n\n\nif get(bucket, pattern).nil?\n  return keys\nend\n\n\nwatch = watch(bucket, pattern)\nwatch.each do |entry|\n  case entry.operation\n  when .delete?, .purge?\n    keys.delete(entry.key)\n  else\n    keys << entry.key\n  end\n  if entry.delta == 0\n    watch.stop\n  end\nend\n\nkeys\n"},"external_var":false},{"html_id":"purge(bucket:String,key:String)-instance-method","name":"purge","abstract":false,"args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"}],"args_string":"(bucket : String, key : String)","args_html":"(bucket : String, key : String)","location":{"filename":"src/kv.cr","line_number":563,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L563"},"def":{"name":"purge","args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"}],"visibility":"Public","body":"validate_bucket!(bucket)\nvalidate_key!(key)\n\nheaders = Headers {\"KV-Operation\" => \"PURGE\", \"Nats-Rollup\" => \"sub\"}\ncase response = @nats.jetstream.publish(\"$KV.#{bucket}.#{key}\", \"\", headers: headers)\nin JetStream::PubAck\n  response\nin JetStream::ErrorResponse\n  raise(Error.new(response.error.description))\nin Nil\n  raise(Error.new(\"No response received from the NATS server when purging #{key.inspect} on KV #{bucket.inspect}\"))\nend\n"},"external_var":false},{"html_id":"put(bucket:String,key:String,value:String|Bytes,ttl:Time::Span|Nil=nil):Int64-instance-method","name":"put","doc":"Assign `value` to `key` in `bucket`, returning an acknowledgement or\nerror if the key could not be set. The key will expire after `ttl` if\nit is provided.","summary":"<p>Assign <code>value</code> to <code>key</code> in <code>bucket</code>, returning an acknowledgement or error if the key could not be set.</p>","abstract":false,"args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"},{"name":"value","external_name":"value","restriction":"String | Bytes"},{"name":"ttl","default_value":"nil","external_name":"ttl","restriction":"Time::Span | ::Nil"}],"args_string":"(bucket : String, key : String, value : String | Bytes, ttl : Time::Span | Nil = nil) : Int64","args_html":"(bucket : String, key : String, value : String | Bytes, ttl : Time::Span | Nil = <span class=\"n\">nil</span>) : Int64","location":{"filename":"src/kv.cr","line_number":333,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L333"},"def":{"name":"put","args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"},{"name":"value","external_name":"value","restriction":"String | Bytes"},{"name":"ttl","default_value":"nil","external_name":"ttl","restriction":"Time::Span | ::Nil"}],"return_type":"Int64","visibility":"Public","body":"validate_bucket!(bucket)\nvalidate_key!(key)\nheaders = Headers.new\nif ttl\n  headers[\"Nats-TTL\"] = ttl.total_seconds.to_i64.to_s\nend\n\ncase response = @nats.jetstream.publish(\"$KV.#{bucket}.#{key}\", value, headers: headers)\nin JetStream::PubAck\n  response.sequence\nin JetStream::ErrorResponse\n  raise(Error.new(response.error.description))\nin Nil\n  raise(Error.new(\"No response received from the NATS server when setting #{key.inspect} on KV #{bucket.inspect}\"))\nend\n"},"external_var":false},{"html_id":"set(bucket:String,key:String,value:Data,ttl:Time::Span|Nil=nil)-instance-method","name":"set","doc":"Assign `value` to `key` in `bucket` without waiting for acknowledgement\nfrom the NATS server. The key will expire after `ttl` if it is provided.","summary":"<p>Assign <code>value</code> to <code>key</code> in <code>bucket</code> without waiting for acknowledgement from the NATS server.</p>","abstract":false,"args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"},{"name":"value","external_name":"value","restriction":"Data"},{"name":"ttl","default_value":"nil","external_name":"ttl","restriction":"Time::Span | ::Nil"}],"args_string":"(bucket : String, key : String, value : Data, ttl : Time::Span | Nil = nil)","args_html":"(bucket : String, key : String, value : <a href=\"../../NATS/Data.html\">Data</a>, ttl : Time::Span | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/kv.cr","line_number":351,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L351"},"def":{"name":"set","args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"},{"name":"value","external_name":"value","restriction":"Data"},{"name":"ttl","default_value":"nil","external_name":"ttl","restriction":"Time::Span | ::Nil"}],"visibility":"Public","body":"validate_bucket!(bucket)\nvalidate_key!(key)\nif ttl\n  if ttl\n    headers = Headers {\"Nats-TTL\" => ttl.total_seconds.to_i64.to_s}\n  end\nend\n\n@nats.publish(\"$KV.#{bucket}.#{key}\", value, headers: headers)\n"},"external_var":false},{"html_id":"update(bucket:String,key:String,value:String|Bytes,revision:Int):Int64|Nil-instance-method","name":"update","doc":"Update a bucket's key with the specified value only if the current value\nis the specified revision. If this revision is the latest, the update is\nnot performed and this method returns `nil`.\n\n```\nif revision = kv.update(bucket, key, value, revision)\n  # updated\nelse\n  # outdated revision\nend\n```","summary":"<p>Update a bucket's key with the specified value only if the current value is the specified revision.</p>","abstract":false,"args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"},{"name":"value","external_name":"value","restriction":"String | Bytes"},{"name":"revision","external_name":"revision","restriction":"Int"}],"args_string":"(bucket : String, key : String, value : String | Bytes, revision : Int) : Int64 | Nil","args_html":"(bucket : String, key : String, value : String | Bytes, revision : Int) : Int64 | Nil","location":{"filename":"src/kv.cr","line_number":432,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L432"},"def":{"name":"update","args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"},{"name":"value","external_name":"value","restriction":"String | Bytes"},{"name":"revision","external_name":"revision","restriction":"Int"}],"return_type":"Int64 | ::Nil","visibility":"Public","body":"validate_bucket!(bucket)\nvalidate_key!(key)\n\ncase response = @nats.jetstream.publish(\"$KV.#{bucket}.#{key}\", value, expected_last_subject_sequence: revision)\nin JetStream::PubAck\n  response.sequence\nin JetStream::ErrorResponse\n  if response.error.err_code.stream_wrong_last_sequence?\n    nil\n  else\n    raise(Error.new(response.error.description))\n  end\nin Nil\n  raise(Error.new(\"No response received from the NATS server when updating #{key.inspect} on KV #{bucket.inspect}\"))\nend\n"},"external_var":false},{"html_id":"watch(bucket:String,key:String,*,ignore_deletes=false,include_history=false)-instance-method","name":"watch","abstract":false,"args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"ignore_deletes","default_value":"false","external_name":"ignore_deletes","restriction":""},{"name":"include_history","default_value":"false","external_name":"include_history","restriction":""}],"args_string":"(bucket : String, key : String, *, ignore_deletes = false, include_history = false)","args_html":"(bucket : String, key : String, *, ignore_deletes = <span class=\"n\">false</span>, include_history = <span class=\"n\">false</span>)","location":{"filename":"src/kv.cr","line_number":512,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L512"},"def":{"name":"watch","args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"ignore_deletes","default_value":"false","external_name":"ignore_deletes","restriction":""},{"name":"include_history","default_value":"false","external_name":"include_history","restriction":""}],"splat_index":2,"visibility":"Public","body":"validate_bucket!(bucket)\nvalidate_pattern!(key)\n\ninbox = \"$KV_WATCH_INBOX.#{NUID.next}\"\ndeliver_group = NUID.next\nif include_history\n  deliver_policy = JetStream::ConsumerConfig::DeliverPolicy::All\nelse\n  deliver_policy = JetStream::ConsumerConfig::DeliverPolicy::LastPerSubject\nend\n\nstream_name = \"KV_#{bucket}\"\nconsumer = @nats.jetstream.consumer.create(stream_name: stream_name, deliver_subject: inbox, deliver_group: deliver_group, deliver_policy: deliver_policy, filter_subject: \"$KV.#{bucket}.#{key}\", ack_policy: :none)\nWatch.new(bucket: bucket, key: key, nats: @nats, consumer: consumer, ignore_deletes: ignore_deletes)\n"},"external_var":false}]},{"html_id":"nats/NATS/KV/Entry","path":"NATS/KV/Entry.html","kind":"struct","full_name":"NATS::KV::Entry","name":"Entry","abstract":false,"superclass":{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},"ancestors":[{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/kv.cr","line_number":621,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L621"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/KV","kind":"module","full_name":"NATS::KV","name":"KV"},"constructors":[{"html_id":"new(bucket:String,key:String,value:Slice(UInt8),revision:Int64,created_at:Time,operation:NATS::KV::Entry::Operation,delta:Int64=0_i64)-class-method","name":"new","abstract":false,"args":[{"name":"bucket","external_name":"bucket","restriction":"::String"},{"name":"key","external_name":"key","restriction":"::String"},{"name":"value","external_name":"value","restriction":"::Slice(::UInt8)"},{"name":"revision","external_name":"revision","restriction":"::Int64"},{"name":"created_at","external_name":"created_at","restriction":"::Time"},{"name":"operation","external_name":"operation","restriction":"::NATS::KV::Entry::Operation"},{"name":"delta","default_value":"0_i64","external_name":"delta","restriction":"::Int64"}],"args_string":"(bucket : String, key : String, value : Slice(UInt8), revision : Int64, created_at : Time, operation : NATS::KV::Entry::Operation, delta : Int64 = 0_i64)","args_html":"(bucket : String, key : String, value : Slice(UInt8), revision : Int64, created_at : Time, operation : <a href=\"../../NATS/KV/Entry/Operation.html\">NATS::KV::Entry::Operation</a>, delta : Int64 = <span class=\"n\">0_i64</span>)","location":{"filename":"src/kv.cr","line_number":636,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L636"},"def":{"name":"new","args":[{"name":"bucket","external_name":"bucket","restriction":"::String"},{"name":"key","external_name":"key","restriction":"::String"},{"name":"value","external_name":"value","restriction":"::Slice(::UInt8)"},{"name":"revision","external_name":"revision","restriction":"::Int64"},{"name":"created_at","external_name":"created_at","restriction":"::Time"},{"name":"operation","external_name":"operation","restriction":"::NATS::KV::Entry::Operation"},{"name":"delta","default_value":"0_i64","external_name":"delta","restriction":"::Int64"}],"visibility":"Public","body":"_ = allocate\n_.initialize(bucket, key, value, revision, created_at, operation, delta)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"bucket:String-instance-method","name":"bucket","abstract":false,"location":{"filename":"src/kv.cr","line_number":622,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L622"},"def":{"name":"bucket","return_type":"String","visibility":"Public","body":"@bucket"},"external_var":false},{"html_id":"created_at:Time-instance-method","name":"created_at","abstract":false,"location":{"filename":"src/kv.cr","line_number":626,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L626"},"def":{"name":"created_at","return_type":"Time","visibility":"Public","body":"@created_at"},"external_var":false},{"html_id":"delta:Int64-instance-method","name":"delta","abstract":false,"location":{"filename":"src/kv.cr","line_number":627,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L627"},"def":{"name":"delta","return_type":"Int64","visibility":"Public","body":"@delta"},"external_var":false},{"html_id":"key:String-instance-method","name":"key","abstract":false,"location":{"filename":"src/kv.cr","line_number":623,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L623"},"def":{"name":"key","return_type":"String","visibility":"Public","body":"@key"},"external_var":false},{"html_id":"latest?-instance-method","name":"latest?","abstract":false,"location":{"filename":"src/kv.cr","line_number":643,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L643"},"def":{"name":"latest?","visibility":"Public","body":"delta == 0"},"external_var":false},{"html_id":"operation:Operation-instance-method","name":"operation","abstract":false,"location":{"filename":"src/kv.cr","line_number":628,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L628"},"def":{"name":"operation","return_type":"Operation","visibility":"Public","body":"@operation"},"external_var":false},{"html_id":"revision:Int64-instance-method","name":"revision","abstract":false,"location":{"filename":"src/kv.cr","line_number":625,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L625"},"def":{"name":"revision","return_type":"Int64","visibility":"Public","body":"@revision"},"external_var":false},{"html_id":"value:Bytes-instance-method","name":"value","abstract":false,"location":{"filename":"src/kv.cr","line_number":624,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L624"},"def":{"name":"value","return_type":"Bytes","visibility":"Public","body":"@value"},"external_var":false},{"html_id":"value_string-instance-method","name":"value_string","abstract":false,"location":{"filename":"src/kv.cr","line_number":639,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L639"},"def":{"name":"value_string","visibility":"Public","body":"String.new(value)"},"external_var":false}],"types":[{"html_id":"nats/NATS/KV/Entry/Operation","path":"NATS/KV/Entry/Operation.html","kind":"enum","full_name":"NATS::KV::Entry::Operation","name":"Operation","abstract":false,"ancestors":[{"html_id":"nats/Enum","kind":"struct","full_name":"Enum","name":"Enum"},{"html_id":"nats/Comparable","kind":"module","full_name":"Comparable","name":"Comparable"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/kv.cr","line_number":630,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L630"}],"repository_name":"nats","program":false,"enum":true,"alias":false,"const":false,"constants":[{"id":"Put","name":"Put","value":"0"},{"id":"Delete","name":"Delete","value":"1"},{"id":"Purge","name":"Purge","value":"2"}],"namespace":{"html_id":"nats/NATS/KV/Entry","kind":"struct","full_name":"NATS::KV::Entry","name":"Entry"},"instance_methods":[{"html_id":"delete?-instance-method","name":"delete?","doc":"Returns `true` if this enum value equals `Delete`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../../NATS/KV/Entry/Operation.html#Delete\">Delete</a></code></p>","abstract":false,"location":{"filename":"src/kv.cr","line_number":632,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L632"},"def":{"name":"delete?","visibility":"Public","body":"self == Delete"},"external_var":false},{"html_id":"purge?-instance-method","name":"purge?","doc":"Returns `true` if this enum value equals `Purge`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../../NATS/KV/Entry/Operation.html#Purge\">Purge</a></code></p>","abstract":false,"location":{"filename":"src/kv.cr","line_number":633,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L633"},"def":{"name":"purge?","visibility":"Public","body":"self == Purge"},"external_var":false},{"html_id":"put?-instance-method","name":"put?","doc":"Returns `true` if this enum value equals `Put`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../../NATS/KV/Entry/Operation.html#Put\">Put</a></code></p>","abstract":false,"location":{"filename":"src/kv.cr","line_number":631,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L631"},"def":{"name":"put?","visibility":"Public","body":"self == Put"},"external_var":false}]}]},{"html_id":"nats/NATS/KV/Error","path":"NATS/KV/Error.html","kind":"class","full_name":"NATS::KV::Error","name":"Error","abstract":false,"superclass":{"html_id":"nats/NATS/Error","kind":"class","full_name":"NATS::Error","name":"Error"},"ancestors":[{"html_id":"nats/NATS/Error","kind":"class","full_name":"NATS::Error","name":"Error"},{"html_id":"nats/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/kv.cr","line_number":29,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L29"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"subclasses":[{"html_id":"nats/NATS/KV/InvalidKeyname","kind":"class","full_name":"NATS::KV::InvalidKeyname","name":"InvalidKeyname"},{"html_id":"nats/NATS/KV/KeyEmptyError","kind":"class","full_name":"NATS::KV::KeyEmptyError","name":"KeyEmptyError"},{"html_id":"nats/NATS/KV/KeyError","kind":"class","full_name":"NATS::KV::KeyError","name":"KeyError"}],"namespace":{"html_id":"nats/NATS/KV","kind":"module","full_name":"NATS::KV","name":"KV"}},{"html_id":"nats/NATS/KV/InvalidKeyname","path":"NATS/KV/InvalidKeyname.html","kind":"class","full_name":"NATS::KV::InvalidKeyname","name":"InvalidKeyname","abstract":false,"superclass":{"html_id":"nats/NATS/KV/Error","kind":"class","full_name":"NATS::KV::Error","name":"Error"},"ancestors":[{"html_id":"nats/NATS/KV/Error","kind":"class","full_name":"NATS::KV::Error","name":"Error"},{"html_id":"nats/NATS/Error","kind":"class","full_name":"NATS::Error","name":"Error"},{"html_id":"nats/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/kv.cr","line_number":38,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L38"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/KV","kind":"module","full_name":"NATS::KV","name":"KV"}},{"html_id":"nats/NATS/KV/KeyEmptyError","path":"NATS/KV/KeyEmptyError.html","kind":"class","full_name":"NATS::KV::KeyEmptyError","name":"KeyEmptyError","abstract":false,"superclass":{"html_id":"nats/NATS/KV/Error","kind":"class","full_name":"NATS::KV::Error","name":"Error"},"ancestors":[{"html_id":"nats/NATS/KV/Error","kind":"class","full_name":"NATS::KV::Error","name":"Error"},{"html_id":"nats/NATS/Error","kind":"class","full_name":"NATS::Error","name":"Error"},{"html_id":"nats/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/kv.cr","line_number":32,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L32"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/KV","kind":"module","full_name":"NATS::KV","name":"KV"}},{"html_id":"nats/NATS/KV/KeyError","path":"NATS/KV/KeyError.html","kind":"class","full_name":"NATS::KV::KeyError","name":"KeyError","abstract":false,"superclass":{"html_id":"nats/NATS/KV/Error","kind":"class","full_name":"NATS::KV::Error","name":"Error"},"ancestors":[{"html_id":"nats/NATS/KV/Error","kind":"class","full_name":"NATS::KV::Error","name":"Error"},{"html_id":"nats/NATS/Error","kind":"class","full_name":"NATS::Error","name":"Error"},{"html_id":"nats/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/kv.cr","line_number":35,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L35"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/KV","kind":"module","full_name":"NATS::KV","name":"KV"}},{"html_id":"nats/NATS/KV/Watch","path":"NATS/KV/Watch.html","kind":"class","full_name":"NATS::KV::Watch","name":"Watch","abstract":false,"superclass":{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"nats/Enumerable","kind":"module","full_name":"Enumerable","name":"Enumerable"},{"html_id":"nats/Iterable","kind":"module","full_name":"Iterable","name":"Iterable"},{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/kv.cr","line_number":648,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L648"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"included_modules":[{"html_id":"nats/Enumerable","kind":"module","full_name":"Enumerable","name":"Enumerable"},{"html_id":"nats/Iterable","kind":"module","full_name":"Iterable","name":"Iterable"}],"namespace":{"html_id":"nats/NATS/KV","kind":"module","full_name":"NATS::KV","name":"KV"},"constructors":[{"html_id":"new(bucket:String,key:String,nats:NATS::Client,consumer:JetStream::Consumer,ignore_deletes:Bool)-class-method","name":"new","abstract":false,"args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"},{"name":"nats","external_name":"nats","restriction":"::NATS::Client"},{"name":"consumer","external_name":"consumer","restriction":"JetStream::Consumer"},{"name":"ignore_deletes","external_name":"ignore_deletes","restriction":"Bool"}],"args_string":"(bucket : String, key : String, nats : NATS::Client, consumer : JetStream::Consumer, ignore_deletes : Bool)","args_html":"(bucket : String, key : String, nats : <a href=\"../../NATS/Client.html\">NATS::Client</a>, consumer : <a href=\"../../NATS/JetStream/Consumer.html\">JetStream::Consumer</a>, ignore_deletes : Bool)","location":{"filename":"src/kv.cr","line_number":659,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L659"},"def":{"name":"new","args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"},{"name":"nats","external_name":"nats","restriction":"::NATS::Client"},{"name":"consumer","external_name":"consumer","restriction":"JetStream::Consumer"},{"name":"ignore_deletes","external_name":"ignore_deletes","restriction":"Bool"}],"visibility":"Public","body":"_ = allocate\n_.initialize(bucket, key, nats, consumer, ignore_deletes)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"each-instance-method","name":"each","doc":"Must return an `Iterator` over the elements in this collection.","summary":"<p>Must return an <code><a href=\"../../NATS/KV/Watch/Iterator.html\">Iterator</a></code> over the elements in this collection.</p>","abstract":false,"location":{"filename":"src/kv.cr","line_number":692,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L692"},"def":{"name":"each","visibility":"Public","body":"Iterator.new(@channel)"},"external_var":false},{"html_id":"each(&)-instance-method","name":"each","doc":"Must yield this collection's elements to the block.","summary":"<p>Must yield this collection's elements to the block.</p>","abstract":false,"location":{"filename":"src/kv.cr","line_number":696,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L696"},"def":{"name":"each","yields":1,"block_arity":1,"visibility":"Public","body":"each.each do |entry|\n  yield entry\nend"},"external_var":false},{"html_id":"stop-instance-method","name":"stop","abstract":false,"location":{"filename":"src/kv.cr","line_number":700,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L700"},"def":{"name":"stop","visibility":"Public","body":"@channel.close\n@nats.unsubscribe(@subscription)\n@nats.jetstream.consumer.delete(@consumer.stream_name, @consumer.name)\n"},"external_var":false}],"types":[{"html_id":"nats/NATS/KV/Watch/Iterator","path":"NATS/KV/Watch/Iterator.html","kind":"struct","full_name":"NATS::KV::Watch::Iterator","name":"Iterator","abstract":false,"superclass":{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},"ancestors":[{"html_id":"nats/Iterator","kind":"module","full_name":"Iterator","name":"Iterator"},{"html_id":"nats/Enumerable","kind":"module","full_name":"Enumerable","name":"Enumerable"},{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/kv.cr","line_number":706,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L706"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"included_modules":[{"html_id":"nats/Iterator","kind":"module","full_name":"Iterator","name":"Iterator"}],"namespace":{"html_id":"nats/NATS/KV/Watch","kind":"class","full_name":"NATS::KV::Watch","name":"Watch"},"constructors":[{"html_id":"new(channel:Channel(Entry))-class-method","name":"new","abstract":false,"args":[{"name":"channel","external_name":"channel","restriction":"Channel(Entry)"}],"args_string":"(channel : Channel(Entry))","args_html":"(channel : Channel(<a href=\"../../../NATS/KV/Entry.html\">Entry</a>))","location":{"filename":"src/kv.cr","line_number":709,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L709"},"def":{"name":"new","args":[{"name":"channel","external_name":"channel","restriction":"Channel(Entry)"}],"visibility":"Public","body":"_ = allocate\n_.initialize(channel)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"next-instance-method","name":"next","doc":"Returns the next element in this iterator, or `Iterator::Stop::INSTANCE` if there\nare no more elements.","summary":"<p>Returns the next element in this iterator, or <code>Iterator::Stop::INSTANCE</code> if there are no more elements.</p>","abstract":false,"location":{"filename":"src/kv.cr","line_number":712,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/kv.cr#L712"},"def":{"name":"next","visibility":"Public","body":"@channel.receive? || stop"},"external_var":false}]}]}]},{"html_id":"nats/NATS/Message","path":"NATS/Message.html","kind":"struct","full_name":"NATS::Message","name":"Message","abstract":false,"superclass":{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},"ancestors":[{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/message.cr","line_number":2,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/message.cr#L2"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS","kind":"module","full_name":"NATS","name":"NATS"},"constructors":[{"html_id":"new(subject:String,data:Slice(UInt8),reply_to:Nil|String=nil,headers:Nil|Hash(String,String)=nil)-class-method","name":"new","abstract":false,"args":[{"name":"subject","external_name":"subject","restriction":"::String"},{"name":"data","external_name":"data","restriction":"::Slice(::UInt8)"},{"name":"reply_to","default_value":"nil","external_name":"reply_to","restriction":"::Nil | ::String"},{"name":"headers","default_value":"nil","external_name":"headers","restriction":"::Nil | ::Hash(::String, ::String)"}],"args_string":"(subject : String, data : Slice(UInt8), reply_to : Nil | String = nil, headers : Nil | Hash(String, String) = nil)","args_html":"(subject : String, data : Slice(UInt8), reply_to : Nil | String = <span class=\"n\">nil</span>, headers : Nil | Hash(String, String) = <span class=\"n\">nil</span>)","location":{"filename":"src/message.cr","line_number":11,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/message.cr#L11"},"def":{"name":"new","args":[{"name":"subject","external_name":"subject","restriction":"::String"},{"name":"data","external_name":"data","restriction":"::Slice(::UInt8)"},{"name":"reply_to","default_value":"nil","external_name":"reply_to","restriction":"::Nil | ::String"},{"name":"headers","default_value":"nil","external_name":"headers","restriction":"::Nil | ::Hash(::String, ::String)"}],"visibility":"Public","body":"_ = allocate\n_.initialize(subject, data, reply_to, headers)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"body-instance-method","name":"body","abstract":false,"location":{"filename":"src/message.cr","line_number":19,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/message.cr#L19"},"def":{"name":"body","visibility":"Public","body":"data"},"external_var":false},{"html_id":"body_io-instance-method","name":"body_io","summary":"<p><span class=\"flag red\">DEPRECATED</span>  Instantiating a new IO::Memory for each message made them heavier than intended, so we're now recommending using <code>String.new(msg.body)</code></p>","abstract":false,"location":{"filename":"src/message.cr","line_number":15,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/message.cr#L15"},"def":{"name":"body_io","visibility":"Public","body":"@body_io || (@body_io = IO::Memory.new(@body))"},"external_var":false},{"html_id":"data:Bytes-instance-method","name":"data","abstract":false,"location":{"filename":"src/message.cr","line_number":4,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/message.cr#L4"},"def":{"name":"data","return_type":"Bytes","visibility":"Public","body":"@data"},"external_var":false},{"html_id":"data_string:String-instance-method","name":"data_string","abstract":false,"location":{"filename":"src/message.cr","line_number":7,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/message.cr#L7"},"def":{"name":"data_string","return_type":"String","visibility":"Public","body":"if (__temp_155 = @data_string).nil?\n  @data_string = (String.new(data))\nelse\n  __temp_155\nend"},"external_var":false},{"html_id":"headers:Headers-instance-method","name":"headers","abstract":false,"location":{"filename":"src/message.cr","line_number":6,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/message.cr#L6"},"def":{"name":"headers","return_type":"Headers","visibility":"Public","body":"if (__temp_154 = @headers).nil?\n  @headers = (Headers.new)\nelse\n  __temp_154\nend"},"external_var":false},{"html_id":"reply_to:String|Nil-instance-method","name":"reply_to","abstract":false,"location":{"filename":"src/message.cr","line_number":5,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/message.cr#L5"},"def":{"name":"reply_to","return_type":"String | ::Nil","visibility":"Public","body":"@reply_to"},"external_var":false},{"html_id":"subject:String-instance-method","name":"subject","abstract":false,"location":{"filename":"src/message.cr","line_number":3,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/message.cr#L3"},"def":{"name":"subject","return_type":"String","visibility":"Public","body":"@subject"},"external_var":false}],"types":[{"html_id":"nats/NATS/Message/Headers","path":"NATS/Message/Headers.html","kind":"alias","full_name":"NATS::Message::Headers","name":"Headers","abstract":false,"locations":[{"filename":"src/message.cr","line_number":9,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/message.cr#L9"}],"repository_name":"nats","program":false,"enum":false,"alias":true,"aliased":"Hash(String, String)","aliased_html":"Hash(String, String)","const":false,"namespace":{"html_id":"nats/NATS/Message","kind":"struct","full_name":"NATS::Message","name":"Message"}}]},{"html_id":"nats/NATS/NotAReply","path":"NATS/NotAReply.html","kind":"class","full_name":"NATS::NotAReply","name":"NotAReply","abstract":false,"superclass":{"html_id":"nats/NATS/Error","kind":"class","full_name":"NATS::Error","name":"Error"},"ancestors":[{"html_id":"nats/NATS/Error","kind":"class","full_name":"NATS::Error","name":"Error"},{"html_id":"nats/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/nats.cr","line_number":44,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L44"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS","kind":"module","full_name":"NATS","name":"NATS"},"doc":"Raised when trying to reply to a NATS message that is not a reply.","summary":"<p>Raised when trying to reply to a NATS message that is not a reply.</p>","constructors":[{"html_id":"new(error_message,nats_message:Message)-class-method","name":"new","abstract":false,"args":[{"name":"error_message","external_name":"error_message","restriction":""},{"name":"nats_message","external_name":"nats_message","restriction":"Message"}],"args_string":"(error_message, nats_message : Message)","args_html":"(error_message, nats_message : <a href=\"../NATS/Message.html\">Message</a>)","location":{"filename":"src/nats.cr","line_number":47,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L47"},"def":{"name":"new","args":[{"name":"error_message","external_name":"error_message","restriction":""},{"name":"nats_message","external_name":"nats_message","restriction":"Message"}],"visibility":"Public","body":"_ = allocate\n_.initialize(error_message, nats_message)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"nats_message:Message-instance-method","name":"nats_message","abstract":false,"location":{"filename":"src/nats.cr","line_number":45,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L45"},"def":{"name":"nats_message","return_type":"Message","visibility":"Public","body":"@nats_message"},"external_var":false}]},{"html_id":"nats/NATS/NUID","path":"NATS/NUID.html","kind":"class","full_name":"NATS::NUID","name":"NUID","abstract":false,"superclass":{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/nuid.cr","line_number":2,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nuid.cr#L2"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"constants":[{"id":"BASE","name":"BASE","value":"62"},{"id":"DIGITS","name":"DIGITS","value":"\"#{(\"0\"..\"9\").join}#{(\"A\"..\"Z\").join}#{(\"a\"..\"z\").join}\".to_slice"},{"id":"MAX_INCREMENT","name":"MAX_INCREMENT","value":"333_i64"},{"id":"MAX_SEQUENCE","name":"MAX_SEQUENCE","value":"839299365868340224_i64"},{"id":"MIN_INCREMENT","name":"MIN_INCREMENT","value":"33_i64"},{"id":"PREFIX_LENGTH","name":"PREFIX_LENGTH","value":"12"},{"id":"SEQUENCE_LENGTH","name":"SEQUENCE_LENGTH","value":"10"},{"id":"TOTAL_LENGTH","name":"TOTAL_LENGTH","value":"PREFIX_LENGTH + SEQUENCE_LENGTH"}],"namespace":{"html_id":"nats/NATS","kind":"module","full_name":"NATS","name":"NATS"},"class_methods":[{"html_id":"next-class-method","name":"next","abstract":false,"location":{"filename":"src/nuid.cr","line_number":24,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nuid.cr#L24"},"def":{"name":"next","visibility":"Public","body":"global.next"},"external_var":false}],"constructors":[{"html_id":"global:self-class-method","name":"global","abstract":false,"location":{"filename":"src/nuid.cr","line_number":12,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nuid.cr#L12"},"def":{"name":"global","return_type":"self","visibility":"Public","body":"if (__temp_156 = @@global).nil?\n  @@global = (new)\nelse\n  __temp_156\nend"},"external_var":false},{"html_id":"new(random=Random.new)-class-method","name":"new","abstract":false,"args":[{"name":"random","default_value":"Random.new","external_name":"random","restriction":""}],"args_string":"(random = Random.new)","args_html":"(random = <span class=\"t\">Random</span>.new)","location":{"filename":"src/nuid.cr","line_number":18,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nuid.cr#L18"},"def":{"name":"new","args":[{"name":"random","default_value":"Random.new","external_name":"random","restriction":""}],"visibility":"Public","body":"_ = allocate\n_.initialize(random)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"increment:Int64-instance-method","name":"increment","abstract":false,"location":{"filename":"src/nuid.cr","line_number":16,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nuid.cr#L16"},"def":{"name":"increment","return_type":"Int64","visibility":"Public","body":"@increment"},"external_var":false},{"html_id":"next-instance-method","name":"next","abstract":false,"location":{"filename":"src/nuid.cr","line_number":28,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nuid.cr#L28"},"def":{"name":"next","visibility":"Public","body":"seq = sequence.add(increment)\nif seq >= (MAX_SEQUENCE - increment)\n  initialize\nend\n\nstringify(seq)\n"},"external_var":false},{"html_id":"prefix:Bytes-instance-method","name":"prefix","abstract":false,"location":{"filename":"src/nuid.cr","line_number":14,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nuid.cr#L14"},"def":{"name":"prefix","return_type":"Bytes","visibility":"Public","body":"if (__temp_157 = @prefix).nil?\n  @prefix = (Bytes.new(PREFIX_LENGTH))\nelse\n  __temp_157\nend"},"external_var":false},{"html_id":"sequence:Atomic(Int64)-instance-method","name":"sequence","abstract":false,"location":{"filename":"src/nuid.cr","line_number":15,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nuid.cr#L15"},"def":{"name":"sequence","return_type":"Atomic(Int64)","visibility":"Public","body":"@sequence"},"external_var":false},{"html_id":"to_s-instance-method","name":"to_s","doc":"Returns a nicely readable and concise string representation of this object,\ntypically intended for users.\n\nThis method should usually **not** be overridden. It delegates to\n`#to_s(IO)` which can be overridden for custom implementations.\n\nAlso see `#inspect`.","summary":"<p>Returns a nicely readable and concise string representation of this object, typically intended for users.</p>","abstract":false,"location":{"filename":"src/nuid.cr","line_number":37,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nuid.cr#L37"},"def":{"name":"to_s","visibility":"Public","body":"stringify(sequence.get)"},"external_var":false}]},{"html_id":"nats/NATS/Objects","path":"NATS/Objects.html","kind":"module","full_name":"NATS::Objects","name":"Objects","abstract":false,"locations":[{"filename":"src/objects.cr","line_number":40,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L40"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"constants":[{"id":"DEFAULT_CHUNK_SIZE","name":"DEFAULT_CHUNK_SIZE","value":"128 * 1024"}],"namespace":{"html_id":"nats/NATS","kind":"module","full_name":"NATS","name":"NATS"},"doc":"The NATS object store is S3-style object storage backed by NATS JetStream.\n\nYou can access the object store API with `NATS::Client#objects`.\n\nCreate a bucket with `Objects::Client#create_bucket`:\n\n```\nbucket = nats.objects.create_bucket(\"my-bucket\")\n```\n\nAdd an object from a file on disk (for example, from a tempfile created from an HTTP file upload) with `Objects::Bucket#put`:\n\n```\nFile.open filename do |file|\n  bucket.put \"my-key\", file\nend\n```\n\nGet the metadata from an object in the store with `Objects::Bucket#get_info`:\n\n```\nbucket.get_info(\"my-key\")\n```\n\nGet the contents of an object in the store with `Objects::Bucket#get`, which returns an `IO` instance that you can read from gradually to avoid having to load the entire object into memory. For example, for storing large images or videos.\n\n```\nif io = bucket.get(\"my-key\")\n  io.gets_to_end\nend\n```","summary":"<p>The NATS object store is S3-style object storage backed by NATS JetStream.</p>\n<p><span class=\"flag lime\">EXPERIMENTAL</span>  NATS object store is experimental and the API could change</p>","types":[{"html_id":"nats/NATS/Objects/Bucket","path":"NATS/Objects/Bucket.html","kind":"struct","full_name":"NATS::Objects::Bucket","name":"Bucket","abstract":false,"superclass":{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},"ancestors":[{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/objects.cr","line_number":316,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L316"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/Objects","kind":"module","full_name":"NATS::Objects","name":"Objects"},"constructors":[{"html_id":"new(name:String,stream_name:String,client:NATS::Objects::Client)-class-method","name":"new","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"::String"},{"name":"stream_name","external_name":"stream_name","restriction":"::String"},{"name":"client","external_name":"client","restriction":"::NATS::Objects::Client"}],"args_string":"(name : String, stream_name : String, client : NATS::Objects::Client)","args_html":"(name : String, stream_name : String, client : <a href=\"../../NATS/Objects/Client.html\">NATS::Objects::Client</a>)","location":{"filename":"src/objects.cr","line_number":329,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L329"},"def":{"name":"new","args":[{"name":"name","external_name":"name","restriction":"::String"},{"name":"stream_name","external_name":"stream_name","restriction":"::String"},{"name":"client","external_name":"client","restriction":"::NATS::Objects::Client"}],"visibility":"Public","body":"_ = allocate\n_.initialize(name, stream_name, client)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false},{"html_id":"new(stream:JetStream::Stream,client:Objects::Client)-class-method","name":"new","abstract":false,"args":[{"name":"stream","external_name":"stream","restriction":"JetStream::Stream"},{"name":"client","external_name":"client","restriction":"Objects::Client"}],"args_string":"(stream : JetStream::Stream, client : Objects::Client)","args_html":"(stream : <a href=\"../../NATS/JetStream/Stream.html\">JetStream::Stream</a>, client : <a href=\"../../NATS/Objects/Client.html\">Objects::Client</a>)","location":{"filename":"src/objects.cr","line_number":321,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L321"},"def":{"name":"new","args":[{"name":"stream","external_name":"stream","restriction":"JetStream::Stream"},{"name":"client","external_name":"client","restriction":"Objects::Client"}],"visibility":"Public","body":"new(name: stream.config.name.lchop(\"OBJ_\"), stream_name: stream.config.name, client: client)"},"external_var":false}],"instance_methods":[{"html_id":"get(key:String)-instance-method","name":"get","abstract":false,"args":[{"name":"key","external_name":"key","restriction":"String"}],"args_string":"(key : String)","args_html":"(key : String)","location":{"filename":"src/objects.cr","line_number":360,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L360"},"def":{"name":"get","args":[{"name":"key","external_name":"key","restriction":"String"}],"visibility":"Public","body":"@client.get(name, key)"},"external_var":false},{"html_id":"get!(key:String)-instance-method","name":"get!","abstract":false,"args":[{"name":"key","external_name":"key","restriction":"String"}],"args_string":"(key : String)","args_html":"(key : String)","location":{"filename":"src/objects.cr","line_number":352,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L352"},"def":{"name":"get!","args":[{"name":"key","external_name":"key","restriction":"String"}],"visibility":"Public","body":"if result = get(key)\n  result\nelse\n  raise(KeyError.new(\"Key #{key.inspect} does not exist for object bucket #{name.inspect}\"))\nend"},"external_var":false},{"html_id":"get_info(key:String)-instance-method","name":"get_info","abstract":false,"args":[{"name":"key","external_name":"key","restriction":"String"}],"args_string":"(key : String)","args_html":"(key : String)","location":{"filename":"src/objects.cr","line_number":348,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L348"},"def":{"name":"get_info","args":[{"name":"key","external_name":"key","restriction":"String"}],"visibility":"Public","body":"@client.get_info(name, key)"},"external_var":false},{"html_id":"get_info!(key:String)-instance-method","name":"get_info!","abstract":false,"args":[{"name":"key","external_name":"key","restriction":"String"}],"args_string":"(key : String)","args_html":"(key : String)","location":{"filename":"src/objects.cr","line_number":340,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L340"},"def":{"name":"get_info!","args":[{"name":"key","external_name":"key","restriction":"String"}],"visibility":"Public","body":"if info = get_info(key)\n  info\nelse\n  raise(KeyError.new(\"Key #{key.inspect} does not exist for object bucket #{name.inspect}\"))\nend"},"external_var":false},{"html_id":"keys(pattern:String=\">\")-instance-method","name":"keys","abstract":false,"args":[{"name":"pattern","default_value":"\">\"","external_name":"pattern","restriction":"String"}],"args_string":"(pattern : String = \">\")","args_html":"(pattern : String = <span class=\"s\">&quot;&gt;&quot;</span>)","location":{"filename":"src/objects.cr","line_number":364,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L364"},"def":{"name":"keys","args":[{"name":"pattern","default_value":"\">\"","external_name":"pattern","restriction":"String"}],"visibility":"Public","body":"@client.keys(name, pattern)"},"external_var":false},{"html_id":"name:String-instance-method","name":"name","abstract":false,"location":{"filename":"src/objects.cr","line_number":317,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L317"},"def":{"name":"name","return_type":"String","visibility":"Public","body":"@name"},"external_var":false},{"html_id":"put(key:String,value:IO,*,description:String|Nil=nil,headers:Headers=Headers.new,chunk_size:Int=DEFAULT_CHUNK_SIZE)-instance-method","name":"put","abstract":false,"args":[{"name":"key","external_name":"key","restriction":"String"},{"name":"value","external_name":"value","restriction":"IO"},{"name":"","external_name":"","restriction":""},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"},{"name":"headers","default_value":"Headers.new","external_name":"headers","restriction":"Headers"},{"name":"chunk_size","default_value":"DEFAULT_CHUNK_SIZE","external_name":"chunk_size","restriction":"Int"}],"args_string":"(key : String, value : IO, *, description : String | Nil = nil, headers : Headers = Headers.new, chunk_size : Int = DEFAULT_CHUNK_SIZE)","args_html":"(key : String, value : IO, *, description : String | Nil = <span class=\"n\">nil</span>, headers : <a href=\"../../NATS/Headers.html\">Headers</a> = <span class=\"t\">Headers</span>.new, chunk_size : Int = <span class=\"t\">DEFAULT_CHUNK_SIZE</span>)","location":{"filename":"src/objects.cr","line_number":336,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L336"},"def":{"name":"put","args":[{"name":"key","external_name":"key","restriction":"String"},{"name":"value","external_name":"value","restriction":"IO"},{"name":"","external_name":"","restriction":""},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"},{"name":"headers","default_value":"Headers.new","external_name":"headers","restriction":"Headers"},{"name":"chunk_size","default_value":"DEFAULT_CHUNK_SIZE","external_name":"chunk_size","restriction":"Int"}],"splat_index":2,"visibility":"Public","body":"@client.put(name, key, value, description: description, headers: headers, chunk_size: chunk_size)"},"external_var":false},{"html_id":"put(key:String,value:String|Bytes,**kwargs)-instance-method","name":"put","abstract":false,"args":[{"name":"key","external_name":"key","restriction":"String"},{"name":"value","external_name":"value","restriction":"String | Bytes"}],"args_string":"(key : String, value : String | Bytes, **kwargs)","args_html":"(key : String, value : String | Bytes, **kwargs)","location":{"filename":"src/objects.cr","line_number":332,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L332"},"def":{"name":"put","args":[{"name":"key","external_name":"key","restriction":"String"},{"name":"value","external_name":"value","restriction":"String | Bytes"}],"double_splat":{"name":"kwargs","external_name":"kwargs","restriction":""},"visibility":"Public","body":"put(key, IO::Memory.new(value), **kwargs)"},"external_var":false},{"html_id":"stream_name:String-instance-method","name":"stream_name","abstract":false,"location":{"filename":"src/objects.cr","line_number":318,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L318"},"def":{"name":"stream_name","return_type":"String","visibility":"Public","body":"@stream_name"},"external_var":false}]},{"html_id":"nats/NATS/Objects/Client","path":"NATS/Objects/Client.html","kind":"class","full_name":"NATS::Objects::Client","name":"Client","abstract":false,"superclass":{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/objects.cr","line_number":49,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L49"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/Objects","kind":"module","full_name":"NATS::Objects","name":"Objects"},"constructors":[{"html_id":"new(nats:NATS::Client)-class-method","name":"new","abstract":false,"args":[{"name":"nats","external_name":"nats","restriction":"NATS::Client"}],"args_string":"(nats : NATS::Client)","args_html":"(nats : <a href=\"../../NATS/Client.html\">NATS::Client</a>)","location":{"filename":"src/objects.cr","line_number":50,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L50"},"def":{"name":"new","args":[{"name":"nats","external_name":"nats","restriction":"NATS::Client"}],"visibility":"Public","body":"_ = allocate\n_.initialize(nats)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"create_bucket(name:String,description:String=\"\",*,ttl:Time::Span|Nil=nil,storage:JetStream::StreamConfig::Storage=:file,replicas:Int|Nil=nil,max_bytes:Int|Nil=nil,placement:JetStream::StreamConfig::Placement|Nil=nil)-instance-method","name":"create_bucket","doc":"Create a bucket in the object store\n\n```\nbucket = nats.objects.create_bucket(\"my-bucket\")\n```\n\nGive the bucket a description that will show up when you get bucket metadata\n```\nbucket = nats.objects.create_bucket(\"uploads\", description: \"Storage for user uploads\")\n```\n\nSet a maximum lifetime for your objects, after which they are deleted:\n```\nbucket = nats.objects.create_bucket(\"snapchat-images\", ttl: 1.day)\n```\n\nReplicate your objects across multiple NATS servers in your cluster:\n```\nbucket = nats.objects.create_bucket(\"durable-storage\", replicas: 3)\n```","summary":"<p>Create a bucket in the object store</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"description","default_value":"\"\"","external_name":"description","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"ttl","default_value":"nil","external_name":"ttl","restriction":"Time::Span | ::Nil"},{"name":"storage","default_value":":file","external_name":"storage","restriction":"JetStream::StreamConfig::Storage"},{"name":"replicas","default_value":"nil","external_name":"replicas","restriction":"Int | ::Nil"},{"name":"max_bytes","default_value":"nil","external_name":"max_bytes","restriction":"Int | ::Nil"},{"name":"placement","default_value":"nil","external_name":"placement","restriction":"JetStream::StreamConfig::Placement | ::Nil"}],"args_string":"(name : String, description : String = \"\", *, ttl : Time::Span | Nil = nil, storage : JetStream::StreamConfig::Storage = :file, replicas : Int | Nil = nil, max_bytes : Int | Nil = nil, placement : JetStream::StreamConfig::Placement | Nil = nil)","args_html":"(name : String, description : String = <span class=\"s\">&quot;&quot;</span>, *, ttl : Time::Span | Nil = <span class=\"n\">nil</span>, storage : <a href=\"../../NATS/JetStream/StreamConfig/Storage.html\">JetStream::StreamConfig::Storage</a> = <span class=\"n\">:file</span>, replicas : Int | Nil = <span class=\"n\">nil</span>, max_bytes : Int | Nil = <span class=\"n\">nil</span>, placement : <a href=\"../../NATS/JetStream/StreamConfig/Placement.html\">JetStream::StreamConfig::Placement</a> | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/objects.cr","line_number":73,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L73"},"def":{"name":"create_bucket","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"description","default_value":"\"\"","external_name":"description","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"ttl","default_value":"nil","external_name":"ttl","restriction":"Time::Span | ::Nil"},{"name":"storage","default_value":":file","external_name":"storage","restriction":"JetStream::StreamConfig::Storage"},{"name":"replicas","default_value":"nil","external_name":"replicas","restriction":"Int | ::Nil"},{"name":"max_bytes","default_value":"nil","external_name":"max_bytes","restriction":"Int | ::Nil"},{"name":"placement","default_value":"nil","external_name":"placement","restriction":"JetStream::StreamConfig::Placement | ::Nil"}],"splat_index":2,"visibility":"Public","body":"stream = @nats.jetstream.stream.create(name: \"OBJ_#{name}\", description: description, subjects: [\"$O.#{name}.C.>\", \"$O.#{name}.M.>\"], max_age: ttl, max_bytes: max_bytes, storage: storage, discard: :new, allow_rollup_headers: true, placement: placement)\n\nBucket.new(stream, self)\n"},"external_var":false},{"html_id":"delete_bucket(name:String)-instance-method","name":"delete_bucket","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"}],"args_string":"(name : String)","args_html":"(name : String)","location":{"filename":"src/objects.cr","line_number":107,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L107"},"def":{"name":"delete_bucket","args":[{"name":"name","external_name":"name","restriction":"String"}],"visibility":"Public","body":"@nats.jetstream.stream.delete(\"OBJ_#{name}\")"},"external_var":false},{"html_id":"get(bucket:String,key:String):IO|Nil-instance-method","name":"get","abstract":false,"args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"}],"args_string":"(bucket : String, key : String) : IO | Nil","args_html":"(bucket : String, key : String) : IO | Nil","location":{"filename":"src/objects.cr","line_number":173,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L173"},"def":{"name":"get","args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"}],"return_type":"IO | ::Nil","visibility":"Public","body":"if info = get_info(bucket, key)\nelse\n  return\nend\nkey = sanitize_key(key)\n\nsubject = \"NATS.Objects.#{bucket}.data.#{key}.get.#{NUID.next}\"\nconsumer = @nats.jetstream.consumer.create(stream_name: \"OBJ_#{bucket}\", filter_subject: \"$O.#{bucket}.C.#{info.nuid}\", deliver_subject: subject, ack_policy: :none, max_deliver: 1, flow_control: true, idle_heartbeat: 5.seconds)\nread, write = IO.pipe\nchunks = 0\n@nats.subscribe(subject) do |msg, subscription|\n  begin\n    if (msg.body.empty? && (headers = msg.headers)) && (headers[\"Status\"]? == \"100 FlowControl Request\")\n      if msg.reply_to\n        @nats.reply(msg, \"\")\n      end\n    else\n      write.write(msg.body)\n      chunks = chunks + 1\n    end\n\n    if chunks >= info.chunks\n      write.close\n      @nats.jetstream.consumer.delete(consumer)\n      @nats.unsubscribe(subscription)\n    end\n  rescue ex : IO::Error\n    write.close\n    @nats.jetstream.consumer.delete(consumer)\n    @nats.unsubscribe(subscription)\n  end\nend\nread\n"},"external_var":false},{"html_id":"get_bucket(name:String)-instance-method","name":"get_bucket","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"}],"args_string":"(name : String)","args_html":"(name : String)","location":{"filename":"src/objects.cr","line_number":101,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L101"},"def":{"name":"get_bucket","args":[{"name":"name","external_name":"name","restriction":"String"}],"visibility":"Public","body":"if stream = @nats.jetstream.stream.info(\"OBJ_#{name}\")\n  Bucket.new(stream, self)\nend"},"external_var":false},{"html_id":"get_info(bucket:String,key:String)-instance-method","name":"get_info","abstract":false,"args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"}],"args_string":"(bucket : String, key : String)","args_html":"(bucket : String, key : String)","location":{"filename":"src/objects.cr","line_number":159,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L159"},"def":{"name":"get_info","args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"}],"visibility":"Public","body":"get_info(bucket, pattern: sanitize_key(key))"},"external_var":false},{"html_id":"get_info(bucket:String,*,pattern:String)-instance-method","name":"get_info","abstract":false,"args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"pattern","external_name":"pattern","restriction":"String"}],"args_string":"(bucket : String, *, pattern : String)","args_html":"(bucket : String, *, pattern : String)","location":{"filename":"src/objects.cr","line_number":163,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L163"},"def":{"name":"get_info","args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"pattern","external_name":"pattern","restriction":"String"}],"splat_index":1,"visibility":"Public","body":"meta = \"$O.#{bucket}.M.#{pattern}\"\nstream = \"OBJ_#{bucket}\"\nif response = @nats.jetstream.stream.get_msg(stream, last_by_subject: meta)\n  info = ObjectInfo.from_json(String.new(response.message.data))\n  info.mtime = response.message.time\n  info\nend\n"},"external_var":false},{"html_id":"keys(bucket:String,pattern:String=\">\"):Set(String)-instance-method","name":"keys","abstract":false,"args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"pattern","default_value":"\">\"","external_name":"pattern","restriction":"String"}],"args_string":"(bucket : String, pattern : String = \">\") : Set(String)","args_html":"(bucket : String, pattern : String = <span class=\"s\">&quot;&gt;&quot;</span>) : Set(String)","location":{"filename":"src/objects.cr","line_number":216,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L216"},"def":{"name":"keys","args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"pattern","default_value":"\">\"","external_name":"pattern","restriction":"String"}],"return_type":"Set(String)","visibility":"Public","body":"keys = Set(String).new\n\n\n\n\nif get_info(bucket, pattern: pattern).nil?\n  return keys\nend\n\n\nwatch(bucket, pattern: pattern) do |msg, watch|\n  keys << msg.name\n\n  if watch.pending == 0\n    watch.stop\n  end\nend\n\nkeys\n"},"external_var":false},{"html_id":"put(bucket:String,key:String,value:IO,description:String|Nil=nil,headers:Headers=Headers.new,chunk_size:Int=DEFAULT_CHUNK_SIZE)-instance-method","name":"put","abstract":false,"args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"},{"name":"value","external_name":"value","restriction":"IO"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"},{"name":"headers","default_value":"Headers.new","external_name":"headers","restriction":"Headers"},{"name":"chunk_size","default_value":"DEFAULT_CHUNK_SIZE","external_name":"chunk_size","restriction":"Int"}],"args_string":"(bucket : String, key : String, value : IO, description : String | Nil = nil, headers : Headers = Headers.new, chunk_size : Int = DEFAULT_CHUNK_SIZE)","args_html":"(bucket : String, key : String, value : IO, description : String | Nil = <span class=\"n\">nil</span>, headers : <a href=\"../../NATS/Headers.html\">Headers</a> = <span class=\"t\">Headers</span>.new, chunk_size : Int = <span class=\"t\">DEFAULT_CHUNK_SIZE</span>)","location":{"filename":"src/objects.cr","line_number":111,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L111"},"def":{"name":"put","args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"},{"name":"value","external_name":"value","restriction":"IO"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"},{"name":"headers","default_value":"Headers.new","external_name":"headers","restriction":"Headers"},{"name":"chunk_size","default_value":"DEFAULT_CHUNK_SIZE","external_name":"chunk_size","restriction":"Int"}],"visibility":"Public","body":"existing = get_info(bucket, key)\nid = NUID.next\nstream_name = \"OBJ_#{bucket}\"\nchunk_subject = \"$O.#{bucket}.C.#{id}\"\nmeta_subject = \"$O.#{bucket}.M.#{sanitize_key(key)}\"\nchunk = Bytes.new(chunk_size)\nsha = Digest::SHA256.new\nsent = 0\ntotal = 0_i64\n\nbegin\n  while (count = value.read(chunk)) != 0\n    body = chunk[0...count]\n    sha << body\n\n    @nats.publish(chunk_subject, body)\n    sent = sent + 1\n    total = total + count\n  end\n\n  msg = ObjectInfo.new(bucket: bucket, name: key, description: description, headers: headers, nuid: id, size: total, mtime: Time.utc, chunks: sent, digest: \"SHA-256=#{Base64.urlsafe_encode(sha.final)}\")\n  @nats.jetstream.publish(\"$O.#{bucket}.M.#{sanitize_key(key)}\", body: msg.to_json, headers: Headers {\"Nats-Rollup\" => \"sub\"})\nrescue ex\n  @nats.jetstream.stream.purge(stream_name, subject: chunk_subject)\n  raise(ex)\nend\n\nif existing\n  @nats.jetstream.stream.purge(stream_name, subject: \"$O.#{bucket}.C.#{existing.nuid}\")\nend\n\n@nats.flush\nmsg\n"},"external_var":false},{"html_id":"watch(bucket:String,key:String,&block:ObjectInfo,Watch->)-instance-method","name":"watch","abstract":false,"args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"}],"args_string":"(bucket : String, key : String, &block : ObjectInfo, Watch -> )","args_html":"(bucket : String, key : String, &block : <a href=\"../../NATS/Objects/Client/ObjectInfo.html\">ObjectInfo</a>, <a href=\"../../NATS/Objects/Client/Watch.html\">Watch</a> -> )","location":{"filename":"src/objects.cr","line_number":234,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L234"},"def":{"name":"watch","args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"key","external_name":"key","restriction":"String"}],"yields":2,"block_arity":2,"block_arg":{"name":"block","external_name":"block","restriction":"(ObjectInfo, Watch ->)"},"visibility":"Public","body":"watch(bucket, pattern: sanitize_key(key), &block)"},"external_var":false},{"html_id":"watch(bucket:String,*,pattern:String,&block:ObjectInfo,Watch->)-instance-method","name":"watch","abstract":false,"args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"pattern","external_name":"pattern","restriction":"String"}],"args_string":"(bucket : String, *, pattern : String, &block : ObjectInfo, Watch -> )","args_html":"(bucket : String, *, pattern : String, &block : <a href=\"../../NATS/Objects/Client/ObjectInfo.html\">ObjectInfo</a>, <a href=\"../../NATS/Objects/Client/Watch.html\">Watch</a> -> )","location":{"filename":"src/objects.cr","line_number":242,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L242"},"def":{"name":"watch","args":[{"name":"bucket","external_name":"bucket","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"pattern","external_name":"pattern","restriction":"String"}],"splat_index":1,"yields":2,"block_arity":2,"block_arg":{"name":"block","external_name":"block","restriction":"(ObjectInfo, Watch ->)"},"visibility":"Public","body":"begin\n  stop_channel = Channel(Nil).new\n  watch = Watch.new(stop_channel)\n  inbox = \"$WATCH_INBOX.#{NUID.next}\"\n  deliver_group = NUID.next\n\n  stream_name = \"OBJ_#{bucket}\"\n  consumer = @nats.jetstream.consumer.create(stream_name: stream_name, deliver_subject: inbox, deliver_group: deliver_group, deliver_policy: :last_per_subject, filter_subject: \"$O.#{bucket}.M.#{pattern}\", ack_policy: :none)\n  subscription = @nats.subscribe(inbox, queue_group: deliver_group) do |msg|\n    js_msg = JetStream::Message.new(msg)\n    watch.pending = js_msg.pending\n\n    _, bucket_name, _, key_name = msg.subject.split('.', 4)\n    info = ObjectInfo.from_json(String.new(msg.body))\n\n    block.call(info, watch)\n  end\n\n  stop_channel.receive\nensure\n  if subscription\n    @nats.unsubscribe(subscription)\n  end\n  if (stream_name && consumer) && (name = consumer.name)\n    @nats.jetstream.consumer.delete(stream_name, name)\n  end\nend"},"external_var":false}],"types":[{"html_id":"nats/NATS/Objects/Client/ObjectInfo","path":"NATS/Objects/Client/ObjectInfo.html","kind":"struct","full_name":"NATS::Objects::Client::ObjectInfo","name":"ObjectInfo","abstract":false,"superclass":{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},"ancestors":[{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/objects.cr","line_number":293,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L293"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"included_modules":[{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"}],"namespace":{"html_id":"nats/NATS/Objects/Client","kind":"class","full_name":"NATS::Objects::Client","name":"Client"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/objects.cr","line_number":294,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L294"},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"},"external_var":false},{"html_id":"new(*,bucket:String,name:String,description:Nil|String,headers:Nil|Hash(String,String),nuid:String,size:Int64,chunks:Int32,digest:String,mtime:Time=Time.new(0,0),deleted:Bool|Nil=nil)-class-method","name":"new","abstract":false,"args":[{"name":"","external_name":"","restriction":""},{"name":"bucket","external_name":"bucket","restriction":"::String"},{"name":"name","external_name":"name","restriction":"::String"},{"name":"description","external_name":"description","restriction":"::Nil | ::String"},{"name":"headers","external_name":"headers","restriction":"::Nil | ::Hash(::String, ::String)"},{"name":"nuid","external_name":"nuid","restriction":"::String"},{"name":"size","external_name":"size","restriction":"::Int64"},{"name":"chunks","external_name":"chunks","restriction":"::Int32"},{"name":"digest","external_name":"digest","restriction":"::String"},{"name":"mtime","default_value":"Time.new(0, 0)","external_name":"mtime","restriction":"::Time"},{"name":"deleted","default_value":"nil","external_name":"deleted","restriction":"::Bool | ::Nil"}],"args_string":"(*, bucket : String, name : String, description : Nil | String, headers : Nil | Hash(String, String), nuid : String, size : Int64, chunks : Int32, digest : String, mtime : Time = Time.new(0, 0), deleted : Bool | Nil = nil)","args_html":"(*, bucket : String, name : String, description : Nil | String, headers : Nil | Hash(String, String), nuid : String, size : Int64, chunks : Int32, digest : String, mtime : Time = <span class=\"t\">Time</span>.new(<span class=\"n\">0</span>, <span class=\"n\">0</span>), deleted : Bool | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/objects.cr","line_number":307,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L307"},"def":{"name":"new","args":[{"name":"","external_name":"","restriction":""},{"name":"bucket","external_name":"bucket","restriction":"::String"},{"name":"name","external_name":"name","restriction":"::String"},{"name":"description","external_name":"description","restriction":"::Nil | ::String"},{"name":"headers","external_name":"headers","restriction":"::Nil | ::Hash(::String, ::String)"},{"name":"nuid","external_name":"nuid","restriction":"::String"},{"name":"size","external_name":"size","restriction":"::Int64"},{"name":"chunks","external_name":"chunks","restriction":"::Int32"},{"name":"digest","external_name":"digest","restriction":"::String"},{"name":"mtime","default_value":"Time.new(0, 0)","external_name":"mtime","restriction":"::Time"},{"name":"deleted","default_value":"nil","external_name":"deleted","restriction":"::Bool | ::Nil"}],"splat_index":0,"visibility":"Public","body":"_ = allocate\n_.initialize(bucket: bucket, name: name, description: description, headers: headers, nuid: nuid, size: size, chunks: chunks, digest: digest, mtime: mtime, deleted: deleted)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"bucket:String-instance-method","name":"bucket","abstract":false,"location":{"filename":"src/objects.cr","line_number":296,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L296"},"def":{"name":"bucket","return_type":"String","visibility":"Public","body":"@bucket"},"external_var":false},{"html_id":"chunks:Int32-instance-method","name":"chunks","abstract":false,"location":{"filename":"src/objects.cr","line_number":303,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L303"},"def":{"name":"chunks","return_type":"Int32","visibility":"Public","body":"@chunks"},"external_var":false},{"html_id":"deleted:Bool|Nil-instance-method","name":"deleted","abstract":false,"location":{"filename":"src/objects.cr","line_number":305,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L305"},"def":{"name":"deleted","return_type":"Bool | ::Nil","visibility":"Public","body":"@deleted"},"external_var":false},{"html_id":"description:String|Nil-instance-method","name":"description","abstract":false,"location":{"filename":"src/objects.cr","line_number":298,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L298"},"def":{"name":"description","return_type":"String | ::Nil","visibility":"Public","body":"@description"},"external_var":false},{"html_id":"digest:String-instance-method","name":"digest","abstract":false,"location":{"filename":"src/objects.cr","line_number":304,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L304"},"def":{"name":"digest","return_type":"String","visibility":"Public","body":"@digest"},"external_var":false},{"html_id":"headers:Headers-instance-method","name":"headers","abstract":false,"location":{"filename":"src/objects.cr","line_number":299,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L299"},"def":{"name":"headers","return_type":"Headers","visibility":"Public","body":"if (__temp_171 = @headers).nil?\n  @headers = (Headers.new)\nelse\n  __temp_171\nend"},"external_var":false},{"html_id":"mtime:Time-instance-method","name":"mtime","abstract":false,"location":{"filename":"src/objects.cr","line_number":302,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L302"},"def":{"name":"mtime","return_type":"Time","visibility":"Public","body":"@mtime"},"external_var":false},{"html_id":"mtime=(mtime:Time)-instance-method","name":"mtime=","abstract":false,"args":[{"name":"mtime","external_name":"mtime","restriction":"Time"}],"args_string":"(mtime : Time)","args_html":"(mtime : Time)","location":{"filename":"src/objects.cr","line_number":302,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L302"},"def":{"name":"mtime=","args":[{"name":"mtime","external_name":"mtime","restriction":"Time"}],"visibility":"Public","body":"@mtime = mtime"},"external_var":false},{"html_id":"name:String-instance-method","name":"name","abstract":false,"location":{"filename":"src/objects.cr","line_number":297,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L297"},"def":{"name":"name","return_type":"String","visibility":"Public","body":"@name"},"external_var":false},{"html_id":"nuid:String-instance-method","name":"nuid","abstract":false,"location":{"filename":"src/objects.cr","line_number":300,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L300"},"def":{"name":"nuid","return_type":"String","visibility":"Public","body":"@nuid"},"external_var":false},{"html_id":"size:Int64-instance-method","name":"size","abstract":false,"location":{"filename":"src/objects.cr","line_number":301,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L301"},"def":{"name":"size","return_type":"Int64","visibility":"Public","body":"@size"},"external_var":false}]},{"html_id":"nats/NATS/Objects/Client/Watch","path":"NATS/Objects/Client/Watch.html","kind":"struct","full_name":"NATS::Objects::Client::Watch","name":"Watch","abstract":false,"superclass":{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},"ancestors":[{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/objects.cr","line_number":282,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L282"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/Objects/Client","kind":"class","full_name":"NATS::Objects::Client","name":"Client"},"constructors":[{"html_id":"new(stop_channel:Channel(Nil))-class-method","name":"new","abstract":false,"args":[{"name":"stop_channel","external_name":"stop_channel","restriction":"Channel(Nil)"}],"args_string":"(stop_channel : Channel(Nil))","args_html":"(stop_channel : Channel(Nil))","location":{"filename":"src/objects.cr","line_number":285,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L285"},"def":{"name":"new","args":[{"name":"stop_channel","external_name":"stop_channel","restriction":"Channel(Nil)"}],"visibility":"Public","body":"_ = allocate\n_.initialize(stop_channel)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"pending:Int64-instance-method","name":"pending","abstract":false,"location":{"filename":"src/objects.cr","line_number":283,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L283"},"def":{"name":"pending","return_type":"Int64","visibility":"Public","body":"@pending"},"external_var":false},{"html_id":"pending=(pending:Int64)-instance-method","name":"pending=","abstract":false,"args":[{"name":"pending","external_name":"pending","restriction":"Int64"}],"args_string":"(pending : Int64)","args_html":"(pending : Int64)","location":{"filename":"src/objects.cr","line_number":283,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L283"},"def":{"name":"pending=","args":[{"name":"pending","external_name":"pending","restriction":"Int64"}],"visibility":"Public","body":"@pending = pending"},"external_var":false},{"html_id":"stop-instance-method","name":"stop","abstract":false,"location":{"filename":"src/objects.cr","line_number":288,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L288"},"def":{"name":"stop","visibility":"Public","body":"@stop_channel.send(nil)"},"external_var":false}]}]},{"html_id":"nats/NATS/Objects/Error","path":"NATS/Objects/Error.html","kind":"class","full_name":"NATS::Objects::Error","name":"Error","abstract":false,"superclass":{"html_id":"nats/NATS/Error","kind":"class","full_name":"NATS::Error","name":"Error"},"ancestors":[{"html_id":"nats/NATS/Error","kind":"class","full_name":"NATS::Error","name":"Error"},{"html_id":"nats/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/objects.cr","line_number":41,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L41"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"subclasses":[{"html_id":"nats/NATS/Objects/KeyError","kind":"class","full_name":"NATS::Objects::KeyError","name":"KeyError"}],"namespace":{"html_id":"nats/NATS/Objects","kind":"module","full_name":"NATS::Objects","name":"Objects"}},{"html_id":"nats/NATS/Objects/KeyError","path":"NATS/Objects/KeyError.html","kind":"class","full_name":"NATS::Objects::KeyError","name":"KeyError","abstract":false,"superclass":{"html_id":"nats/NATS/Objects/Error","kind":"class","full_name":"NATS::Objects::Error","name":"Error"},"ancestors":[{"html_id":"nats/NATS/Objects/Error","kind":"class","full_name":"NATS::Objects::Error","name":"Error"},{"html_id":"nats/NATS/Error","kind":"class","full_name":"NATS::Error","name":"Error"},{"html_id":"nats/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/objects.cr","line_number":44,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/objects.cr#L44"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/Objects","kind":"module","full_name":"NATS::Objects","name":"Objects"}}]},{"html_id":"nats/NATS/ServerInfo","path":"NATS/ServerInfo.html","kind":"struct","full_name":"NATS::ServerInfo","name":"ServerInfo","abstract":false,"superclass":{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},"ancestors":[{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"nats/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"nats/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/nats.cr","line_number":58,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L58"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"included_modules":[{"html_id":"nats/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"}],"namespace":{"html_id":"nats/NATS","kind":"module","full_name":"NATS","name":"NATS"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/nats.cr","line_number":59,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L59"},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"},"external_var":false}],"instance_methods":[{"html_id":"auth_required?:Bool-instance-method","name":"auth_required?","abstract":false,"location":{"filename":"src/nats.cr","line_number":70,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L70"},"def":{"name":"auth_required?","return_type":"Bool","visibility":"Public","body":"@auth_required"},"external_var":false},{"html_id":"client_id:UInt64|Nil-instance-method","name":"client_id","abstract":false,"location":{"filename":"src/nats.cr","line_number":74,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L74"},"def":{"name":"client_id","return_type":"UInt64 | ::Nil","visibility":"Public","body":"@client_id"},"external_var":false},{"html_id":"client_ip:String|Nil-instance-method","name":"client_ip","abstract":false,"location":{"filename":"src/nats.cr","line_number":75,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L75"},"def":{"name":"client_ip","return_type":"String | ::Nil","visibility":"Public","body":"@client_ip"},"external_var":false},{"html_id":"cluster:String|Nil-instance-method","name":"cluster","abstract":false,"location":{"filename":"src/nats.cr","line_number":77,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L77"},"def":{"name":"cluster","return_type":"String | ::Nil","visibility":"Public","body":"@cluster"},"external_var":false},{"html_id":"connect_urls:Array(String)-instance-method","name":"connect_urls","abstract":false,"location":{"filename":"src/nats.cr","line_number":79,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L79"},"def":{"name":"connect_urls","return_type":"Array(String)","visibility":"Public","body":"if (__temp_158 = @connect_urls).nil?\n  @connect_urls = ([] of String)\nelse\n  __temp_158\nend"},"external_var":false},{"html_id":"domain:String|Nil-instance-method","name":"domain","abstract":false,"location":{"filename":"src/nats.cr","line_number":78,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L78"},"def":{"name":"domain","return_type":"String | ::Nil","visibility":"Public","body":"@domain"},"external_var":false},{"html_id":"go:String-instance-method","name":"go","abstract":false,"location":{"filename":"src/nats.cr","line_number":64,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L64"},"def":{"name":"go","return_type":"String","visibility":"Public","body":"@go"},"external_var":false},{"html_id":"headers?:Bool-instance-method","name":"headers?","abstract":false,"location":{"filename":"src/nats.cr","line_number":67,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L67"},"def":{"name":"headers?","return_type":"Bool","visibility":"Public","body":"@headers"},"external_var":false},{"html_id":"host:String-instance-method","name":"host","abstract":false,"location":{"filename":"src/nats.cr","line_number":65,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L65"},"def":{"name":"host","return_type":"String","visibility":"Public","body":"@host"},"external_var":false},{"html_id":"lame_duck_mode?:Bool-instance-method","name":"lame_duck_mode?","abstract":false,"location":{"filename":"src/nats.cr","line_number":81,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L81"},"def":{"name":"lame_duck_mode?","return_type":"Bool","visibility":"Public","body":"@lame_duck_mode"},"external_var":false},{"html_id":"max_payload:Int64-instance-method","name":"max_payload","abstract":false,"location":{"filename":"src/nats.cr","line_number":68,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L68"},"def":{"name":"max_payload","return_type":"Int64","visibility":"Public","body":"@max_payload"},"external_var":false},{"html_id":"nonce:String|Nil-instance-method","name":"nonce","abstract":false,"location":{"filename":"src/nats.cr","line_number":76,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L76"},"def":{"name":"nonce","return_type":"String | ::Nil","visibility":"Public","body":"@nonce"},"external_var":false},{"html_id":"port:Int32-instance-method","name":"port","abstract":false,"location":{"filename":"src/nats.cr","line_number":66,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L66"},"def":{"name":"port","return_type":"Int32","visibility":"Public","body":"@port"},"external_var":false},{"html_id":"proto:Int32-instance-method","name":"proto","abstract":false,"location":{"filename":"src/nats.cr","line_number":69,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L69"},"def":{"name":"proto","return_type":"Int32","visibility":"Public","body":"@proto"},"external_var":false},{"html_id":"server_id:String-instance-method","name":"server_id","abstract":false,"location":{"filename":"src/nats.cr","line_number":61,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L61"},"def":{"name":"server_id","return_type":"String","visibility":"Public","body":"@server_id"},"external_var":false},{"html_id":"server_name:String-instance-method","name":"server_name","abstract":false,"location":{"filename":"src/nats.cr","line_number":62,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L62"},"def":{"name":"server_name","return_type":"String","visibility":"Public","body":"@server_name"},"external_var":false},{"html_id":"tls_available?:Bool-instance-method","name":"tls_available?","abstract":false,"location":{"filename":"src/nats.cr","line_number":73,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L73"},"def":{"name":"tls_available?","return_type":"Bool","visibility":"Public","body":"@tls_available"},"external_var":false},{"html_id":"tls_required?:Bool-instance-method","name":"tls_required?","abstract":false,"location":{"filename":"src/nats.cr","line_number":71,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L71"},"def":{"name":"tls_required?","return_type":"Bool","visibility":"Public","body":"@tls_required"},"external_var":false},{"html_id":"tls_verify?:Bool-instance-method","name":"tls_verify?","abstract":false,"location":{"filename":"src/nats.cr","line_number":72,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L72"},"def":{"name":"tls_verify?","return_type":"Bool","visibility":"Public","body":"@tls_verify"},"external_var":false},{"html_id":"version:String-instance-method","name":"version","abstract":false,"location":{"filename":"src/nats.cr","line_number":63,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L63"},"def":{"name":"version","return_type":"String","visibility":"Public","body":"@version"},"external_var":false}]},{"html_id":"nats/NATS/ServerNotRespondingToPings","path":"NATS/ServerNotRespondingToPings.html","kind":"class","full_name":"NATS::ServerNotRespondingToPings","name":"ServerNotRespondingToPings","abstract":false,"superclass":{"html_id":"nats/NATS/Error","kind":"class","full_name":"NATS::Error","name":"Error"},"ancestors":[{"html_id":"nats/NATS/Error","kind":"class","full_name":"NATS::Error","name":"Error"},{"html_id":"nats/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/nats.cr","line_number":52,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L52"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS","kind":"module","full_name":"NATS","name":"NATS"}},{"html_id":"nats/NATS/Service","path":"NATS/Service.html","kind":"class","full_name":"NATS::Service","name":"Service","abstract":false,"superclass":{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/services.cr","line_number":145,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L145"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS","kind":"module","full_name":"NATS","name":"NATS"},"doc":"The `Service` represents a NATS service that was created by the `Services`\nAPI. It exists to hang your endpoints on:\n\n```\ninventory = nats.services.add \"inventory\",\n  version: \"0.1.0\",\n  description: \"Manage inventory\"\ninventory.add_endpoint \"inventory.products.get\", subject: \"inventory.products.get.*\" do |request|\n  _, _, _, id\n  nats.reply request, ProductQuery.new.find(id).to_json\nend\n```","summary":"<p>The <code><a href=\"../NATS/Service.html\">Service</a></code> represents a NATS service that was created by the <code><a href=\"../NATS/Services.html\">Services</a></code> API.</p>","instance_methods":[{"html_id":"add_endpoint(name:String,*,subject:String=name,queue_group:String=\"q\",concurrency:Int=1,&block:Message,Subscription->):Endpoint-instance-method","name":"add_endpoint","doc":"```\nservice.add_endpoint \"endpoint-name\", subject: \"endpoint.subject\" do |request|\n  nats.reply request, \"reply goes here\"\nend\n```","summary":"<p><code>service.add_endpoint &quot;endpoint-name&quot;, subject: &quot;endpoint.subject&quot; do |request|   nats.reply request, &quot;reply goes here&quot; end</code></p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"subject","default_value":"name","external_name":"subject","restriction":"String"},{"name":"queue_group","default_value":"\"q\"","external_name":"queue_group","restriction":"String"},{"name":"concurrency","default_value":"1","external_name":"concurrency","restriction":"Int"}],"args_string":"(name : String, *, subject : String = name, queue_group : String = \"q\", concurrency : Int = 1, &block : Message, Subscription -> ) : Endpoint","args_html":"(name : String, *, subject : String = name, queue_group : String = <span class=\"s\">&quot;q&quot;</span>, concurrency : Int = <span class=\"n\">1</span>, &block : <a href=\"../NATS/Message.html\">Message</a>, <a href=\"../NATS/Subscription.html\">Subscription</a> -> ) : <a href=\"../NATS/Service/Endpoint.html\">Endpoint</a>","location":{"filename":"src/services.cr","line_number":175,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L175"},"def":{"name":"add_endpoint","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"subject","default_value":"name","external_name":"subject","restriction":"String"},{"name":"queue_group","default_value":"\"q\"","external_name":"queue_group","restriction":"String"},{"name":"concurrency","default_value":"1","external_name":"concurrency","restriction":"Int"}],"splat_index":1,"yields":2,"block_arity":2,"block_arg":{"name":"block","external_name":"block","restriction":"(Message, Subscription ->)"},"return_type":"Endpoint","visibility":"Public","body":"if name =~ Services::NAME_PATTERN\nelse\n  raise(ArgumentError.new(\"Endpoint names can only contain letter, number, dash, and underscore characters\"))\nend\n\nendpoint = uninitialized Endpoint\nsubscription = @nats.subscribe(subject, queue_group: queue_group, concurrency: concurrency) do |msg, subscription|\n  endpoint.request(msg) do\n    block.call(msg, subscription)\n  end\nend\n\nendpoint = Endpoint.new(nats: @nats, service: self, name: name, subject: subject, queue_group: queue_group, subscription: subscription)\nendpoints << endpoint\n\nendpoint\n"},"external_var":false},{"html_id":"add_group(name:String,&)-instance-method","name":"add_group","doc":"Add a `Group` and yield it to the block.\n\n```\nservice.add_group \"products\" do |inventory|\n  inventory.add_endpoint \"create\" do |request|\n    nats.reply request, \"reply goes here\"\n  end\nend\n```","summary":"<p>Add a <code><a href=\"../NATS/Service/Group.html\">Group</a></code> and yield it to the block.</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"}],"args_string":"(name : String, &)","args_html":"(name : String, &)","location":{"filename":"src/services.cr","line_number":216,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L216"},"def":{"name":"add_group","args":[{"name":"name","external_name":"name","restriction":"String"}],"yields":1,"block_arity":1,"visibility":"Public","body":"yield add_group(name)"},"external_var":false},{"html_id":"add_group(name:String)-instance-method","name":"add_group","doc":"Add a `Group` of endpoints.","summary":"<p>Add a <code><a href=\"../NATS/Service/Group.html\">Group</a></code> of endpoints.</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"}],"args_string":"(name : String)","args_html":"(name : String)","location":{"filename":"src/services.cr","line_number":221,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L221"},"def":{"name":"add_group","args":[{"name":"name","external_name":"name","restriction":"String"}],"visibility":"Public","body":"group = Group.new(@nats, self, name)\n@groups << group\ngroup\n"},"external_var":false},{"html_id":"description:String-instance-method","name":"description","abstract":false,"location":{"filename":"src/services.cr","line_number":150,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L150"},"def":{"name":"description","return_type":"String","visibility":"Public","body":"@description"},"external_var":false},{"html_id":"endpoints:Array(Endpoint)-instance-method","name":"endpoints","abstract":false,"location":{"filename":"src/services.cr","line_number":153,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L153"},"def":{"name":"endpoints","return_type":"Array(Endpoint)","visibility":"Public","body":"@endpoints"},"external_var":false},{"html_id":"error_reply(request:Message,body:String|Bytes=\"\",*,error:String,error_code:String|Int):Nil-instance-method","name":"error_reply","abstract":false,"args":[{"name":"request","external_name":"request","restriction":"Message"},{"name":"body","default_value":"\"\"","external_name":"body","restriction":"String | Bytes"},{"name":"","external_name":"","restriction":""},{"name":"error","external_name":"error","restriction":"String"},{"name":"error_code","external_name":"error_code","restriction":"String | Int"}],"args_string":"(request : Message, body : String | Bytes = \"\", *, error : String, error_code : String | Int) : Nil","args_html":"(request : <a href=\"../NATS/Message.html\">Message</a>, body : String | Bytes = <span class=\"s\">&quot;&quot;</span>, *, error : String, error_code : String | Int) : Nil","location":{"filename":"src/services.cr","line_number":227,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L227"},"def":{"name":"error_reply","args":[{"name":"request","external_name":"request","restriction":"Message"},{"name":"body","default_value":"\"\"","external_name":"body","restriction":"String | Bytes"},{"name":"","external_name":"","restriction":""},{"name":"error","external_name":"error","restriction":"String"},{"name":"error_code","external_name":"error_code","restriction":"String | Int"}],"splat_index":2,"return_type":"Nil","visibility":"Public","body":"@nats.reply(request, body, headers: Headers {\"Nats-Service-Error\" => error, \"Nats-Service-Error-Code\" => error_code.to_s})"},"external_var":false},{"html_id":"id:String-instance-method","name":"id","abstract":false,"location":{"filename":"src/services.cr","line_number":147,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L147"},"def":{"name":"id","return_type":"String","visibility":"Public","body":"@id"},"external_var":false},{"html_id":"metadata:Hash(String,String)-instance-method","name":"metadata","abstract":false,"location":{"filename":"src/services.cr","line_number":151,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L151"},"def":{"name":"metadata","return_type":"Hash(String, String)","visibility":"Public","body":"@metadata"},"external_var":false},{"html_id":"name:String-instance-method","name":"name","abstract":false,"location":{"filename":"src/services.cr","line_number":148,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L148"},"def":{"name":"name","return_type":"String","visibility":"Public","body":"@name"},"external_var":false},{"html_id":"on_error(&error_handler:ErrorHandler)-instance-method","name":"on_error","doc":"Execute the given block for all exceptions raised in this service's\nendpoints. This is useful for returning a common error response.\n\n```\nservice.on_error do |exception, message|\n  nats.reply message, \"\", headers: NATS::Headers{\n    \"Nats-Service-Error-Code\" => \"500\",\n    \"Nats-Service-Error\"      => \"Unexpected error: #{exception.message}\",\n  }\nend\n```","summary":"<p>Execute the given block for all exceptions raised in this service's endpoints.</p>","abstract":false,"location":{"filename":"src/services.cr","line_number":251,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L251"},"def":{"name":"on_error","yields":0,"block_arity":0,"block_arg":{"name":"error_handler","external_name":"error_handler","restriction":"ErrorHandler"},"visibility":"Public","body":"@error_handler = error_handler\nself\n"},"external_var":false},{"html_id":"subscriptions:Array(Subscription)-instance-method","name":"subscriptions","abstract":false,"location":{"filename":"src/services.cr","line_number":152,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L152"},"def":{"name":"subscriptions","return_type":"Array(Subscription)","visibility":"Public","body":"@subscriptions"},"external_var":false},{"html_id":"version:String-instance-method","name":"version","abstract":false,"location":{"filename":"src/services.cr","line_number":149,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L149"},"def":{"name":"version","return_type":"String","visibility":"Public","body":"@version"},"external_var":false}],"types":[{"html_id":"nats/NATS/Service/Endpoint","path":"NATS/Service/Endpoint.html","kind":"class","full_name":"NATS::Service::Endpoint","name":"Endpoint","abstract":false,"superclass":{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/services.cr","line_number":319,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L319"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/Service","kind":"class","full_name":"NATS::Service","name":"Service"},"doc":"The `Endpoint` is the request handler. You generally won't interact with\nthis class directly.","summary":"<p>The <code><a href=\"../../NATS/Service/Endpoint.html\">Endpoint</a></code> is the request handler.</p>","instance_methods":[{"html_id":"average_processing_time-instance-method","name":"average_processing_time","abstract":false,"location":{"filename":"src/services.cr","line_number":349,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L349"},"def":{"name":"average_processing_time","visibility":"Public","body":"requests = total_requests\nif requests.zero?\n  return 0.seconds\nend\n\ntotal_processing_time / total_requests\n"},"external_var":false},{"html_id":"last_error:String|Nil-instance-method","name":"last_error","abstract":false,"location":{"filename":"src/services.cr","line_number":329,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L329"},"def":{"name":"last_error","return_type":"String | ::Nil","visibility":"Public","body":"@last_error"},"external_var":false},{"html_id":"name:String-instance-method","name":"name","abstract":false,"location":{"filename":"src/services.cr","line_number":322,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L322"},"def":{"name":"name","return_type":"String","visibility":"Public","body":"@name"},"external_var":false},{"html_id":"queue_group:String-instance-method","name":"queue_group","abstract":false,"location":{"filename":"src/services.cr","line_number":324,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L324"},"def":{"name":"queue_group","return_type":"String","visibility":"Public","body":"@queue_group"},"external_var":false},{"html_id":"service:Service-instance-method","name":"service","abstract":false,"location":{"filename":"src/services.cr","line_number":321,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L321"},"def":{"name":"service","return_type":"Service","visibility":"Public","body":"@service"},"external_var":false},{"html_id":"subject:String-instance-method","name":"subject","abstract":false,"location":{"filename":"src/services.cr","line_number":323,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L323"},"def":{"name":"subject","return_type":"String","visibility":"Public","body":"@subject"},"external_var":false},{"html_id":"subscription:Subscription-instance-method","name":"subscription","abstract":false,"location":{"filename":"src/services.cr","line_number":325,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L325"},"def":{"name":"subscription","return_type":"Subscription","visibility":"Public","body":"@subscription"},"external_var":false},{"html_id":"total_errors-instance-method","name":"total_errors","abstract":false,"location":{"filename":"src/services.cr","line_number":341,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L341"},"def":{"name":"total_errors","visibility":"Public","body":"@total_errors.get"},"external_var":false},{"html_id":"total_processing_time-instance-method","name":"total_processing_time","abstract":false,"location":{"filename":"src/services.cr","line_number":345,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L345"},"def":{"name":"total_processing_time","visibility":"Public","body":"@total_processing_nanoseconds.get.nanoseconds"},"external_var":false},{"html_id":"total_requests-instance-method","name":"total_requests","abstract":false,"location":{"filename":"src/services.cr","line_number":337,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L337"},"def":{"name":"total_requests","visibility":"Public","body":"@total_requests.get"},"external_var":false}]},{"html_id":"nats/NATS/Service/ErrorHandler","path":"NATS/Service/ErrorHandler.html","kind":"alias","full_name":"NATS::Service::ErrorHandler","name":"ErrorHandler","abstract":false,"locations":[{"filename":"src/services.cr","line_number":157,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L157"}],"repository_name":"nats","program":false,"enum":false,"alias":true,"aliased":"Proc(Exception, NATS::Message, Nil)","aliased_html":"Exception, <a href=\"../../NATS/Message.html\">NATS::Message</a> -> Nil","const":false,"namespace":{"html_id":"nats/NATS/Service","kind":"class","full_name":"NATS::Service","name":"Service"}},{"html_id":"nats/NATS/Service/Group","path":"NATS/Service/Group.html","kind":"class","full_name":"NATS::Service::Group","name":"Group","abstract":false,"superclass":{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/services.cr","line_number":286,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L286"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS/Service","kind":"class","full_name":"NATS::Service","name":"Service"},"doc":"The  `Group` represents a cohesive group of endpoints. Groups are useful\nfor applying a common prefix to subjects or setting a common queue group.","summary":"<p>The  <code><a href=\"../../NATS/Service/Group.html\">Group</a></code> represents a cohesive group of endpoints.</p>","instance_methods":[{"html_id":"add_endpoint(name:String,*,subject:String=name,queue_group:String=\"q\",&block:Message,Subscription->):Endpoint-instance-method","name":"add_endpoint","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"subject","default_value":"name","external_name":"subject","restriction":"String"},{"name":"queue_group","default_value":"\"q\"","external_name":"queue_group","restriction":"String"}],"args_string":"(name : String, *, subject : String = name, queue_group : String = \"q\", &block : Message, Subscription -> ) : Endpoint","args_html":"(name : String, *, subject : String = name, queue_group : String = <span class=\"s\">&quot;q&quot;</span>, &block : <a href=\"../../NATS/Message.html\">Message</a>, <a href=\"../../NATS/Subscription.html\">Subscription</a> -> ) : <a href=\"../../NATS/Service/Endpoint.html\">Endpoint</a>","location":{"filename":"src/services.cr","line_number":295,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L295"},"def":{"name":"add_endpoint","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"subject","default_value":"name","external_name":"subject","restriction":"String"},{"name":"queue_group","default_value":"\"q\"","external_name":"queue_group","restriction":"String"}],"splat_index":1,"yields":2,"block_arity":2,"block_arg":{"name":"block","external_name":"block","restriction":"(Message, Subscription ->)"},"return_type":"Endpoint","visibility":"Public","body":"service.add_endpoint(name, subject: \"#{@name}.#{subject}\", queue_group: queue_group, &block)"},"external_var":false},{"html_id":"add_group(name:String,&)-instance-method","name":"add_group","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"}],"args_string":"(name : String, &)","args_html":"(name : String, &)","location":{"filename":"src/services.cr","line_number":308,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L308"},"def":{"name":"add_group","args":[{"name":"name","external_name":"name","restriction":"String"}],"yields":1,"block_arity":1,"visibility":"Public","body":"yield add_group(name)"},"external_var":false},{"html_id":"add_group(name:String)-instance-method","name":"add_group","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"}],"args_string":"(name : String)","args_html":"(name : String)","location":{"filename":"src/services.cr","line_number":312,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L312"},"def":{"name":"add_group","args":[{"name":"name","external_name":"name","restriction":"String"}],"visibility":"Public","body":"Group.new(@nats, @service, \"#{@name}.#{name}\")"},"external_var":false},{"html_id":"name:String-instance-method","name":"name","abstract":false,"location":{"filename":"src/services.cr","line_number":289,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L289"},"def":{"name":"name","return_type":"String","visibility":"Public","body":"@name"},"external_var":false},{"html_id":"service:Service-instance-method","name":"service","abstract":false,"location":{"filename":"src/services.cr","line_number":288,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L288"},"def":{"name":"service","return_type":"Service","visibility":"Public","body":"@service"},"external_var":false}]}]},{"html_id":"nats/NATS/Services","path":"NATS/Services.html","kind":"class","full_name":"NATS::Services","name":"Services","abstract":false,"superclass":{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/services.cr","line_number":46,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L46"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"constants":[{"id":"NAME_PATTERN","name":"NAME_PATTERN","value":"/\\A[\\w\\-]+\\z/"}],"namespace":{"html_id":"nats/NATS","kind":"module","full_name":"NATS","name":"NATS"},"doc":"The [NATS Services API](https://docs.nats.io/using-nats/developer/services)\nallows you to build microservices using NATS instead of HTTP. Since NATS has\nthe concept of request/reply messages through a decentralized message broker,\nyou don't need to deal with domain names, load-balancing, service meshes, or\nother concepts that you might have to implement in HTTP-based microservices. NATS takes care of all of those for you.\n\n```\ninventory = nats.services.add \"inventory\",\n  version: \"0.1.0\",\n  description: \"Manage store inventory\"\n\n# Add the top-level subject namespace for the service\ninventory.add_group \"inventory\" do |inv|\n  # Add a namespace specifically for managing products\n  inv.add_group \"products\" do |products|\n    # Create a product. Receives a CreateProductRequest and returns a Product.\n    # Example using the NATS CLI:\n    #   nats req inventory.products.create '{\"name\":\"Computer\",\"description\":\"It is a computer\",\"price_cents\":200000}'\n    products.add_endpoint \"create\" do |request|\n      # Deserialize the request body and make a product out of it\n      product = CreateProductRequest.from_json(request.data_string).product\n      # Save the product to our KV store\n      products_kv[product.id.to_s] = product.to_json\n      # Reply with the serialized product\n      nats.reply request, product.to_json\n    end\n\n    # Return the product with the given id passed in the subject.\n    # Example: inventory.products.get.0197e31f-3ffa-7fd7-8512-a331a20e5ae3\n    # Equivalent to the following HTTP request:\n    #   GET /inventory/products/0197e31f-3ffa-7fd7-8512-a331a20e5ae3\n    products.add_endpoint \"show\", subject: \"get.*\" do |request|\n      # Split the subject to get the id\n      _, _, _, product_id = request.subject.split('.')\n\n      # Fetch the product from the `inventory-products` KV bucket\n      nats.reply request, products_kv[product_id]\n    end\n  end\nend\n```","summary":"<p>The <a href=\"https://docs.nats.io/using-nats/developer/services\">NATS Services API</a> allows you to build microservices using NATS instead of HTTP.</p>","instance_methods":[{"html_id":"add(name:String,*,version:String,description:String,metadata:Hash(String,String)={}ofString=>String)-instance-method","name":"add","doc":"Register a service with the NATS server.\n\n```\ninventory = nats.services.add \"inventory\",\n  version: \"0.1.0\",\n  description: \"Manage inventory\"\n```","summary":"<p>Register a service with the NATS server.</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"version","external_name":"version","restriction":"String"},{"name":"description","external_name":"description","restriction":"String"},{"name":"metadata","default_value":"{} of String => String","external_name":"metadata","restriction":"Hash(String, String)"}],"args_string":"(name : String, *, version : String, description : String, metadata : Hash(String, String) = {} of String => String)","args_html":"(name : String, *, version : String, description : String, metadata : Hash(String, String) = {} <span class=\"k\">of</span> <span class=\"t\">String</span> <span class=\"o\">=&gt;</span> <span class=\"t\">String</span>)","location":{"filename":"src/services.cr","line_number":62,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/services.cr#L62"},"def":{"name":"add","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"","external_name":"","restriction":""},{"name":"version","external_name":"version","restriction":"String"},{"name":"description","external_name":"description","restriction":"String"},{"name":"metadata","default_value":"{} of String => String","external_name":"metadata","restriction":"Hash(String, String)"}],"splat_index":1,"visibility":"Public","body":"if name =~ NAME_PATTERN\nelse\n  raise(ArgumentError.new(\"NATS service names may only contain A-Z, a-z, 0-9, dash, and underscore characters.\"))\nend\nstarted = Time.utc.to_rfc3339\nid = NUID.next\nservice = Service.new(nats: @nats, id: id, name: name, version: version, description: description, metadata: metadata)\n\n[\"$SRV.PING\", \"$SRV.PING.#{name}\", \"$SRV.PING.#{name}.#{id}\"].each do |subject|\n  service.subscriptions << (@nats.subscribe(subject) do |msg|\n    @nats.reply(msg, {type: \"io.nats.micro.v1.ping_response\", name: name, id: id, version: version, metadata: metadata}.to_json)\n  end)\nend\n\n[\"$SRV.STATS\", \"$SRV.STATS.#{name}\", \"$SRV.STATS.#{name}.#{id}\"].each do |subject|\n  service.subscriptions << (@nats.subscribe(subject) do |msg|\n    @nats.reply(msg, {type: \"io.nats.micro.v1.stats_response\", name: name, id: id, version: version, metadata: metadata, endpoints: service.endpoint_stats, started: started}.to_json)\n  end)\nend\n\n[\"$SRV.INFO\", \"$SRV.INFO.#{name}\", \"$SRV.INFO.#{name}.#{id}\"].each do |subject|\n  service.subscriptions << (@nats.subscribe(subject) do |msg|\n    @nats.reply(msg, {type: \"io.nats.micro.v1.info_response\", name: name, id: id, version: version, description: description, metadata: metadata, endpoints: service.endpoint_info}.to_json)\n  end)\nend\n\nservice\n"},"external_var":false}]},{"html_id":"nats/NATS/Subscription","path":"NATS/Subscription.html","kind":"class","full_name":"NATS::Subscription","name":"Subscription","abstract":false,"superclass":{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/nats.cr","line_number":923,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L923"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS","kind":"module","full_name":"NATS","name":"NATS"},"constructors":[{"html_id":"new(subject:String,sid:Int64,queue_group:Nil|String,nats:NATS::Client,max_in_flight:Int32,*,concurrency:Int32,&block:Message,Subscription->)-class-method","name":"new","abstract":false,"args":[{"name":"subject","external_name":"subject","restriction":"::String"},{"name":"sid","external_name":"sid","restriction":"::Int64"},{"name":"queue_group","external_name":"queue_group","restriction":"::Nil | ::String"},{"name":"nats","external_name":"nats","restriction":"::NATS::Client"},{"name":"max_in_flight","external_name":"max_in_flight","restriction":"::Int32"},{"name":"","external_name":"","restriction":""},{"name":"concurrency","external_name":"concurrency","restriction":"::Int32"}],"args_string":"(subject : String, sid : Int64, queue_group : Nil | String, nats : NATS::Client, max_in_flight : Int32, *, concurrency : Int32, &block : Message, Subscription -> )","args_html":"(subject : String, sid : Int64, queue_group : Nil | String, nats : <a href=\"../NATS/Client.html\">NATS::Client</a>, max_in_flight : Int32, *, concurrency : Int32, &block : <a href=\"../NATS/Message.html\">Message</a>, <a href=\"../NATS/Subscription.html\">Subscription</a> -> )","location":{"filename":"src/nats.cr","line_number":936,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L936"},"def":{"name":"new","args":[{"name":"subject","external_name":"subject","restriction":"::String"},{"name":"sid","external_name":"sid","restriction":"::Int64"},{"name":"queue_group","external_name":"queue_group","restriction":"::Nil | ::String"},{"name":"nats","external_name":"nats","restriction":"::NATS::Client"},{"name":"max_in_flight","external_name":"max_in_flight","restriction":"::Int32"},{"name":"","external_name":"","restriction":""},{"name":"concurrency","external_name":"concurrency","restriction":"::Int32"}],"splat_index":5,"yields":2,"block_arity":2,"block_arg":{"name":"block","external_name":"block","restriction":"(Message, Subscription ->)"},"visibility":"Public","body":"_ = allocate\n_.initialize(subject, sid, queue_group, nats, max_in_flight, concurrency: concurrency, &block) do |_arg0, _arg1|\n  yield _arg0, _arg1\nend\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"close-instance-method","name":"close","abstract":false,"location":{"filename":"src/nats.cr","line_number":996,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L996"},"def":{"name":"close","visibility":"Public","body":"@nats.unsubscribe(self)\n@message_channel.close\n"},"external_var":false},{"html_id":"concurrency:Int32-instance-method","name":"concurrency","abstract":false,"location":{"filename":"src/nats.cr","line_number":930,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L930"},"def":{"name":"concurrency","return_type":"Int32","visibility":"Public","body":"@concurrency"},"external_var":false},{"html_id":"drain:Nil-instance-method","name":"drain","abstract":false,"location":{"filename":"src/nats.cr","line_number":990,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L990"},"def":{"name":"drain","return_type":"Nil","visibility":"Public","body":"while !(@message_channel.queue.empty? && !processing?)\n  sleep(1.millisecond)\nend"},"external_var":false},{"html_id":"max_in_flight:Int32-instance-method","name":"max_in_flight","abstract":false,"location":{"filename":"src/nats.cr","line_number":931,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L931"},"def":{"name":"max_in_flight","return_type":"Int32","visibility":"Public","body":"@max_in_flight"},"external_var":false},{"html_id":"messages_remaining:Int32|Nil-instance-method","name":"messages_remaining","abstract":false,"location":{"filename":"src/nats.cr","line_number":929,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L929"},"def":{"name":"messages_remaining","return_type":"Int32 | ::Nil","visibility":"Public","body":"@messages_remaining"},"external_var":false},{"html_id":"queue_group:String|Nil-instance-method","name":"queue_group","abstract":false,"location":{"filename":"src/nats.cr","line_number":928,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L928"},"def":{"name":"queue_group","return_type":"String | ::Nil","visibility":"Public","body":"@queue_group"},"external_var":false},{"html_id":"send(message,&on_error:Exception->):Nil-instance-method","name":"send","abstract":false,"args":[{"name":"message","external_name":"message","restriction":""}],"args_string":"(message, &on_error : Exception -> ) : Nil","args_html":"(message, &on_error : Exception -> ) : Nil","location":{"filename":"src/nats.cr","line_number":1001,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L1001"},"def":{"name":"send","args":[{"name":"message","external_name":"message","restriction":""}],"yields":1,"block_arity":1,"block_arg":{"name":"on_error","external_name":"on_error","restriction":"(Exception ->)"},"return_type":"Nil","visibility":"Public","body":"message_channel.send({message, on_error})"},"external_var":false},{"html_id":"sid:Int64-instance-method","name":"sid","abstract":false,"location":{"filename":"src/nats.cr","line_number":927,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L927"},"def":{"name":"sid","return_type":"Int64","visibility":"Public","body":"@sid"},"external_var":false},{"html_id":"start:self-instance-method","name":"start","abstract":false,"location":{"filename":"src/nats.cr","line_number":962,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L962"},"def":{"name":"start","return_type":"self","visibility":"Public","body":"concurrency.times do\n  spawn do\n    begin\n      remaining = @messages_remaining\n      while remaining.nil? || remaining > 0\n        if result = message_channel.receive?\n          message, on_error = result\n          @processing = true\n\n          LOG.trace do\n            \"Calling subscription handler for sid #{sid} (subscription to #{subject.inspect}, message subject #{message.subject.inspect})\"\n          end\n          begin\n            call(message, on_error)\n          ensure\n            @processing = false\n          end\n\n          remaining = @messages_remaining\n        else\n          break\n        end\n      end\n    rescue ex\n    end\n  end\nend\n\nself\n"},"external_var":false},{"html_id":"subject:String-instance-method","name":"subject","abstract":false,"location":{"filename":"src/nats.cr","line_number":926,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L926"},"def":{"name":"subject","return_type":"String","visibility":"Public","body":"@subject"},"external_var":false},{"html_id":"unsubscribe_after(messagesmessages_remaining:Int32)-instance-method","name":"unsubscribe_after","abstract":false,"args":[{"name":"messages_remaining","external_name":"messages","restriction":"Int32"}],"args_string":"(messages messages_remaining : Int32)","args_html":"(messages messages_remaining : Int32)","location":{"filename":"src/nats.cr","line_number":959,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L959"},"def":{"name":"unsubscribe_after","args":[{"name":"messages_remaining","external_name":"messages","restriction":"Int32"}],"visibility":"Public","body":"@messages_remaining = messages_remaining"},"external_var":false}],"types":[{"html_id":"nats/NATS/Subscription/MessageChannel","path":"NATS/Subscription/MessageChannel.html","kind":"alias","full_name":"NATS::Subscription::MessageChannel","name":"MessageChannel","abstract":false,"locations":[{"filename":"src/nats.cr","line_number":924,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L924"}],"repository_name":"nats","program":false,"enum":false,"alias":true,"aliased":"NATS::Subscription::Channel(Tuple(NATS::Message, Proc(Exception, Nil)))","aliased_html":"NATS::Subscription::Channel({<a href=\"../../NATS/Message.html\">NATS::Message</a>, Exception -> Nil})","const":false,"namespace":{"html_id":"nats/NATS/Subscription","kind":"class","full_name":"NATS::Subscription","name":"Subscription"}}]},{"html_id":"nats/NATS/UnknownCommand","path":"NATS/UnknownCommand.html","kind":"class","full_name":"NATS::UnknownCommand","name":"UnknownCommand","abstract":false,"superclass":{"html_id":"nats/NATS/Error","kind":"class","full_name":"NATS::Error","name":"Error"},"ancestors":[{"html_id":"nats/NATS/Error","kind":"class","full_name":"NATS::Error","name":"Error"},{"html_id":"nats/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"nats/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"nats/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/nats.cr","line_number":55,"url":"https://github.com/jgaskins/nats/blob/v1.4.1/src/nats.cr#L55"}],"repository_name":"nats","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"nats/NATS","kind":"module","full_name":"NATS","name":"NATS"}}]}]}}